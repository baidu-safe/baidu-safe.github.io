_.Module.define({path:"comforum/widget/attentionCategoryGame",sub:{initial:function(t,e,n){this.reason=t,this.is_reply=e,this.likeData=n,this._requestData()},_requestData:function(){var t=this,e="/game/adtask/getFollowList?&forum_id="+PageData.forum.id;$.get(e).done(function(e){if(0===e.no){var n=e.data.game_list;if(""!=n)t._bindEvent(n);else{var a=[{id:"752",name:"\u5927\u5929\u4F7F\u4E4B\u5251",link:"http://wanba.baidu.com/login_game_by_zone.xhtml?type=lastloginserver&id=842&pid=10400200842_879148",srcimg:{type_230_170:"http://tb1.bdstatic.com/tb/zt/tengfei/dts27-_130.jpg"},online:"13\u4E07"},{id:"123",name:"SD\u9AD8\u8FBE",link:"http://wanba.baidu.com/login_game_by_zone.xhtml?type=lastloginserver&id=752&pid=10400200752_879148",srcimg:{type_200_200:"http://tb1.bdstatic.com/tb/zt/tengfei/wd2.jpg"},online:"12\u4E07"},{id:"123",name:"\u821E\u52A8",link:"http://wanba.baidu.com/login_game_by_zone.xhtml?type=lastloginserver&id=530&pid=10400200530_879148",srcimg:{type_200_200:"http://tb1.bdstatic.com/tb/zt/tengfei/wd.jpg"},online:"10\u4E07"}];t._bindEvent(a)}}}).fail(function(){})},_bindEvent:function(t){var e=this;e._trackData();var n=this._renderAttentionContent(e.reason,e.is_reply,e.likeData,t),a={title:"\u672C\u5427\u63A8\u8350",width:515,height:320},i=$.dialog.open(n,a);$(i.element[0]).find(".dialogJcontent").tbattr("id","attention-game-wraper_dialog"),$(i.element[0]).find(".userlike_tip_span a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=entryimallinpop")}),$(i.element[0]).find(".attention_category_game_btn").eq(0).bind("click",function(){e._reloadAndGotop()}),i.bind("onclose",function(){e._reloadAndGotop()})},_renderAttentionContent:function(t,e,n,a){var i=['<div class="attention-game-wraper">','<div class="attention-game-header">',"<p>\u5BA2\u5B98\uFF0C\u4E0B\u9762\u662F\u5C0F\u8D34\u8D34\u4E3A\u60A8\u5949\u4E0A\u672C\u5427\u4E13\u5C5E\u6E38\u620F\uFF0C\u8BF7\u7B11\u7EB3\uFF01</p>","</div>",'<div class="attention-game-content">','<div class="primary-attention-game">','<div class="primary-attention-game-inner">',"<h3>"+a[0].name+"\uFF0C\u8D34\u5427\u4E13\u5C5E\u798F\u5229</h3>",'<div class="primary-attention-game-content">','<img class="primary-attention-game-img" src="'+a[0].srcimg.type_230_170+'">','<div class="over-layer">','<a href="/game/adtask/link?tbjump='+encodeURIComponent(a[0].jump_url)+'&gfr=attention" target="_blank" class="button">\u7ACB\u5373\u53BB\u73A9</a>',"</div>","</div>","</div>","</div>",'<div class="secondary-attention-game">','<div class="secondary-attention-game-inner">','<h3>\u5176\u4ED6\u5427\u53CB\u8FD8\u73A9<span class="attention-more-game"><a href="http://tieba.baidu.com/game/index" target="_blank">\u67E5\u770B\u66F4\u591A\u6E38\u620F</a></span></h3>','<div class="secondary-attention-game-content">','<div class="attention-game-item clearfix">','<img class="attention-game-item-img" src="'+a[1].srcimg.type_200_200+'">','<div class="attention-game-info">',"<p>"+a[1].name+"</p>","<p>"+a[1].online+"\u4E07\u5427\u53CB\u5728\u73A9</p>",'<p><a  class="j_item1 button" href="/game/adtask/link?tbjump='+encodeURIComponent(a[1].jump_url)+'&gfr=attention" target="_blank">\u53BB\u770B\u770B</a></p>',"</div>","</div>",'<div class="attention-game-item clearfix">','<img class="attention-game-item-img" src="'+a[2].srcimg.type_200_200+'">','<div class="attention-game-info">',"<p>"+a[2].name+"</p>","<p>"+a[2].online+"\u4E07\u5427\u53CB\u5728\u73A9</p>",'<p><a href="/game/adtask/link?tbjump='+encodeURIComponent(a[2].jump_url)+'&gfr=attention" target="_blank"  class="j_item2 button">\u53BB\u770B\u770B</a></p>',"</div>","</div>","</div>","</div>","</div>","</div>","</div>"];return i.join("")},_trackData:function(){$.stats.track("\u6E38\u620F\u7C7B\u76EE\u5427\u5173\u6CE8","\u6E38\u620F\u6D6E\u5C42",null,"view",{obj_type:"\u6E38\u620F"}),$("body").on("click",".primary-attention-game-content a",function(){$.stats.track("\u6E38\u620F\u6D6E\u5C42\u5DE6\u4E00","\u6E38\u620F\u6D6E\u5C42",null,"click",{obj_type:"\u6E38\u620F"})}),$("body").on("click",".j_item1",function(){$.stats.track("\u6E38\u620F\u6D6E\u5C42\u53F3\u4E00","\u6E38\u620F\u6D6E\u5C42",null,"click",{obj_type:"\u6E38\u620F"})}),$("body").on("click",".j_item2",function(){$.stats.track("\u6E38\u620F\u6D6E\u5C42\u53F3\u4E8C","\u6E38\u620F\u6D6E\u5C42",null,"click",{obj_type:"\u6E38\u620F"})})},_reloadAndGotop:function(){$.tb.location.setHref($.tb.location.getHref().split("#")[0])}}});_.Module.define({path:"tbmall/component/util",sub:{_propCategoryMap:{101:"\u53D1\u8D34\u6C14\u6CE1",102:"",103:"\u4E2A\u6027\u6C34\u5370",104:"\u70AB\u5F69\u5B57\u4F53",105:"",106:"",107:"\u9B54\u6CD5\u5F39",108:"\u8865\u7B7E\u795E\u5668",109:"\u52A8\u6001\u5934\u50CF",110:"\u5934\u50CF\u8FB9\u6846",111:"",112:"\u4E2A\u6027\u94ED\u724C",113:"\u540D\u7247\u80CC\u666F",114:"\u94ED\u724C\u91CD\u94F8\u5361",115:"",116:"\u8D34\u6761\u5361",117:"\u633D\u5C0A\u5361"},_freeUseMap:{1070001:12,1070002:12,1080001:8},_badgeMap:{1:"\u8D34\u5427\u4F1A\u5458",2:"\u8D34\u5427\u8D85\u7EA7\u4F1A\u5458"},initial:function(){},badgeNameMap:function(e){var a=parseInt(e);return a>105e4&&(a-=105e4),this._badgeMap[a]},getFreeUseCount:function(e){return this._freeUseMap[e]},getMaxLevel:function(e){var a=0,t=(new Date).getTime(),n=e||PageData.user.Parr_props;if(!n||!n.level)return 0;var r=n.level;return 1e3*r.end_time>t&&parseInt(r.props_id,10)>a&&(a=parseInt(r.props_id,10)),a},convertNumber:function(e){return e>99999999?Math.round(e/1e8,2)+"\u4EBF":e>99999?Math.round(e/1e4,2)+"\u4E07":e},formatDate:function(e){function a(e){return e>9?e:"0"+e.toString()}var t=new Date(1e3*e);return t.getFullYear()+"\u5E74"+(t.getMonth()+1)+"\u6708"+t.getDate()+"\u65E5 "+a(t.getHours())+":"+a(t.getMinutes())},hasOwnProp:function(e,a){return PageData.props[e]&&PageData.props[e][a]&&1e3*PageData.props[e][a].end_time>Env.server_time},convertToDay:function(e){return Math.ceil(e/86400)+"\u5929"},getCategoryName:function(e){return this._propCategoryMap[e]},getFreeInfo:function(e){var a=this,t='<div class="free_info">';return"1080002"==e.props_id?(t+='<span  title="'+a.badgeNameMap(2)+'" >',t+='<a class="j_tbmall_join_vip_btn strong_txt level2"><span class="icon"></span>\u4E00\u6B21\u5145\u503C12\u4E2A\u6708\uFF0C</a>\u9001\u4E09\u5F20</span>'):1==e.props_type&&a.getFreeUseCount(e.props_id)?(t+='<span  title="'+a.badgeNameMap(2)+'" >',t+='<a class="j_tbmall_join_vip_btn strong_txt level2"><span class="icon"></span>\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458</a>\u514D\u8D39\u4F7F\u7528',t+='<span class="free_use_count">'+a.getFreeUseCount(e.props_id)+"</span>\u4E2A</span>"):1!=e.props_type&&(t+='<span  title="'+a.badgeNameMap(e.free_user_level)+'" >',t+='<a class="j_tbmall_join_vip_btn strong_txt level'+e.free_user_level+'"><span class="icon"></span>\u5F00\u901A'+(2==e.free_user_level?"\u8D85\u7EA7":"")+"\u4F1A\u5458</a>\u514D\u8D39\u4F7F\u7528</span>"),t+="</div>"},hasUsedProp:function(e,a){return PageData.props[e]&&!!PageData.props[e][a]&&!!parseInt(PageData.props[e][a].open_status,10)},hasBadge:function(){return PageData.props.level&&PageData.props.level.prop_id&&1e3*PageData.props.level.end_time>Env.server_time},shouldHaveProp:function(e){return e>0&&this.hasBadge()&&PageData.props.level.prop_id>=e},getBuyInfo:function(e){var a,t,n=this,r="",s=e.props_category,p=e.props_id,o=e.free_user_level,_=n.hasOwnProp(s,p),i=n.hasUsedProp(s,p),u=n.shouldHaveProp(o);return _?"1"===e.is_default_used&&(i?(t="\u53D6\u6D88\u4F7F\u7528",a="j_cancle_use"):(t="\u4F7F\u7528",a="j_use"),r+=['<a href="#" class="ui_btn ui_btn_sub_s '+a+'">',"<span><em>"+t+"</em></span>","</a>"].join("")):(u?(a="j_get_button1",t="\u9886\u53D6"):(a="j_buy_button1",t="\u5151&nbsp;&nbsp;\u6362"),r+=['<a class="ui_btn ui_btn_sub_s '+a+'">',"<span><em>"+t+"</em></span>","</a>"].join("")),r}}});_.Module.define({path:"tbmall/component/Dialog",sub:{initial:function(){},dialog:function(n){var t=this;t.customDialog=new $.dialog({html:'<div class="dialog_ctn_wrapper"> '+n+"</div>",title:"\u63D0\u793A",width:430}),t.customDialog.bind("onclose",function(){t.trigger("onInfoClose")}),$(".charge_bean_interaction_j_charge_btn").click(function(){t.customDialog.close()}),$(".charge_bean_interaction_j_close_dialog").click(function(n){n.preventDefault(),t.customDialog.close()})},info:function(n,t){var i=this;t=t||{};var o=t.button||"\u786E \u5B9A";i.infoDialog=new $.dialog({html:'<div class="dialog_ctn_wrapper"> '+n+'<div class="confirm_wrapper theme_info"><a class="ui_btn ui_btn_m yes"><span><em>'+o+"</em></span></a></div></div>",title:t.title||"\u63D0\u793A",width:t.width||430}),i.infoDialog.element.one("click",".yes",function(n){n.preventDefault(),i.infoDialog.close(),i.trigger("onInfoYes")}),i.infoDialog.bind("onclose",function(){i.trigger("onInfoClose")})},confirm:function(n,t){var i=this,o={button:[{txt:"\u786E \u5B9A",extraclass:""},{txt:"\u53D6 \u6D88"}]};t=$.extend(o,t);var e='<a class="ui_btn ui_btn_m yes '+t.button[0].extraclass+'"><span><em>'+t.button[0].txt+'</em></span></a><a class="ui_btn ui_btn_sub_m no"><span><em>'+t.button[1].txt+"</em></span></a>";i.confirmDialog=new $.dialog({html:'<div class="dialog_ctn_wrapper"> '+n+'<div class="confirm_wrapper">'+e+"</div></div>",title:"\u63D0\u793A",width:t.width||430}),$(i.confirmDialog.getElement()).one("click",".yes",function(n){n.preventDefault(),"function"==typeof t.button[0].callback?t.button[0].callback():i.trigger("yes")}).one("click",".no",function(n){n.preventDefault(),"function"==typeof t.button[1].callback?t.button[1].callback():i.trigger("no")})},getConfirmDialog:function(){return this.confirmDialog},enableYesBtn:function(){this.confirmDialog.element.find(".yes").data("clicked",!1)},close:function(){this.confirmDialog&&this.confirmDialog.close()}}});_.Module.define({requires:["common/widget/payMember"],path:"common/widget/JoinVipDialog",sub:{initial:function(){},getMemberDialog:function(e){return PageData.user.is_login?(this._gotoCashier(e),!1):(_.Module.use("common/widget/LoginDialog"),!1)},_gotoCashier:function(e){var i=this.requireInstance("common/widget/payMember"),o={fr:e||"\u8D2D\u4E70\u4F1A\u5458"};i.showCashier(o)}}});_.Module.define({path:"tbmall/widget/ContSignCard",requires:["tbmall/component/util","tbmall/component/Dialog","common/widget/JoinVipDialog"],sub:{_card_count:0,_tpl:'<div class="header">\u70B9\u51FB\u6211\u5173\u6CE8\u7684\u5427\u4F7F\u7528\u8FDE\u7EED\u7B7E\u5230\u5361\uFF08<span class="condition">\u6CE8\uFF1A\u4F7F\u7528\u6761\u4EF6\u4E3A\u7D2F\u8BA1\u7B7E\u5230\u5929\u6570\u2265100\u5929\uFF0C\u4EC5\u4F1A\u5458\u53EF\u4EE5\u4F7F\u7528</span>\uFF09\uFF1A</div><div id="j_signable_list" class="signable_list"><img class="loading" src="http://tb1.bdstatic.com/tb/static-tbmall/img/loading.gif"></div><div class="bottom_info"><div class="my_cont_card">\u6211\u6709<span class="j_card_count orange_txt">0</span>\u5F20<span class="orange_txt">\u8FDE\u7EED\u7B7E\u5230\u5361</span></div><p class="">\u8FDE\u7EED\u7B7E\u5230\u5361\u5C06\u628A\u9009\u4E2D\u5427\u6240\u6709\u7684\u7B7E\u5230\u5929\u6570\u8FDE\u7EED\u5728\u4E00\u8D77\uFF01</p> </div> <div class="free_info"><span title="\u8D85\u7EA7\u8D34\u5427\u4F1A\u5458"><a class="j_tbmall_join_vip_btn strong_txt level2"><span class="icon"></span>\u4E00\u6B21\u5145\u503C12\u4E2A\u6708\uFF0C</a>\u9001\u4E09\u5F20</span> </div>',initial:function(){var t=this;return t.util=t.use("tbmall/component/util"),t.mdialog=t.use("tbmall/component/Dialog"),t.vip=t.use("common/widget/JoinVipDialog"),PageData.user.is_login?(t.build(),t.loadSignableList(),t.bindEvent(),void 0):(_.Module.use("common/widget/LoginDialog"),void 0)},showMemberOnly:function(){var t=this,e=['<div id="sign_tip_forNoMember" class="sign_tip_forNoMember">',"<p><span>\u8FDE\u7EED\u7B7E\u5230\u5361</span>\u662F\u4F1A\u5458\u4E13\u5C5E\u9053\u5177,\u6210\u4E3A\u4F1A\u5458\u5373\u53EF\u4F7F\u7528!</p>",'<a class="ui_btn ui_btn_m j_openMember" href="#"><span><em>\u9A6C\u4E0A\u5F00\u901A</em></span></a>','<p><a class="j_tbmall_join_vip_btn level2_icon" href="#">\u5145\u6EE112\u4E2A\u6708\u8D85\u7EA7\u4F1A\u5458</a>\u9001\u4E09\u5F20</p>',"</div>"].join(""),i=new $.dialog({html:e,title:"\u63D0\u793A",width:430,height:100});$("#sign_tip_forNoMember").delegate(".j_openMember","click",function(e){e.preventDefault(),i.close(),t.vip.getMemberDialog()}),$("#sign_tip_forNoMember").delegate(".j_tbmall_join_vip_btn","click",function(e){e.preventDefault(),i.close(),t.vip.getMemberDialog()})},build:function(){var t=this;this._dialog=new $.dialog({title:"\u4F7F\u7528\u8FDE\u7EED\u7B7E\u5230\u5361",html:t._tpl,width:662,holderClassName:"cont_sign_dialog",fixed:!1}),this._listdom=this._dialog.element.find("#j_signable_list")},loadSignableList:function(){var t=this,e="";$.tb.get("/tbmall/get/getContSignableList",function(i){if(i&&0==i.no){var a=i.data.list;if(a.length){for(var n=0,l=a.length;l>n;n++)e+='<a href="/f?kw='+encodeURIComponent(a[n].forum_name)+'&ie=utf-8" target="_blank" data-fid="'+a[n].forum_id+'" class="signable_ba j_signable_ba">'+$.tb.subByte(a[n].forum_name,11)+'<span class="forum_level lv'+a[n].level_id+'"></span></a> ';t._listdom.html(""),_.Module.use("common/widget/ScrollPanel",[{content:e,container:t._listdom,height:210}])}else e='<div class="no_signable_tip gray_txt">\u6CA1\u6709\u68C0\u6D4B\u5230\u4F60\u6709\u7D2F\u8BA1\u7B7E\u5230\u2265100\u5929\uFF0C\u6216\u8005\u65AD\u7B7E\u7684\u5427\uFF0C\u8BF7\u6838\u5B9E\u540E\u5237\u65B0\u9875\u9762\u3002</div>',t._dialog.element.find("#j_signable_list").height(280).html(e);t._card_count=i.data.card_count,t._dialog.element.find(".j_card_count").text(i.data.card_count)}else e="\u54CE\u5440\uFF0C\u670D\u52A1\u5668\u62BD\u98CE\u4E86\uFF0C\u8BF7\u5173\u95ED\u7A97\u53E3\u91CD\u65B0\u52A0\u8F7D",t._dialog.element.find("#j_signable_list").html(e)})},bindEvent:function(){var t=this;this._dialog.element.on("click",".j_signable_ba",function(e){return t.util.getMaxLevel()?($(this).hasClass("signed")||(e.preventDefault(),t.showBubble($(this))),void 0):(e.preventDefault(),t._dialog.close(),t.showMemberOnly(),void 0)}),this._dialog.bind("onclose",function(){t._bubble&&t._bubble.closeBubble()})},showBubble:function(t){var e=this;if(!e._isAjaxing){var i=t.data("fid"),a=t.offset(),n={arrow_dir:"up",bubble_css:{top:a.top+37,left:a.left-39,width:172,height:69,zIndex:6e4},arrow_pos:{left:87},wrap:$("body"),closeBtn:!0},l='<div class="card_bubble_content"><span>\u6CA1\u6709<span class="blue_txt">\u8FDE\u7EED\u7B7E\u5230\u5361</span></span><div><a href="/tbmall/propslist?category=108" target="_blank" class="ui_btn ui_btn_sub_s j_buy_card"><span><em>\u7ACB\u5373\u8D2D\u4E70</em></span></a> </div></div>',s='<div class="card_bubble_content"><span>\u9700\u8981\u6D88\u8017<span class="blue_txt">1\u5F20\u8FDE\u7EED\u7B7E\u5230\u5361</span></span><div><a class="ui_btn ui_btn_sub_s j_use_card"><span><em>\u786E \u5B9A</em></span></a> </div></div>',o='<div class="card_bubble_content"><span class="blue_txt">\u5DF2\u7ECF\u6210\u529F\u4F7F\u7528\u8FDE\u7EED\u7B7E\u5230\u5361,\u70B9\u51FB\u5427\u540D\u67E5\u770B</span></div>',_='<div class="card_bubble_content"><span>\u8FDE\u7EED\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5~</span></div>';e._bubble&&e._bubble.closeBubble(),n.content=e._card_count<1?l:s,e._bubble=new UiBubbleTipBase(n),e._bubble.j_bubble.one("click",".j_buy_card",function(){e._bubble.closeBubble()}).one("click",".j_use_card",function(a){a.preventDefault(),e._isAjaxing=!0,e._bubble.setContent('<div class="card_bubble_content"><img src="http://tb1.bdstatic.com/tb/static-tbmall/img/loading.gif">\u6B63\u5728\u8FDE\u7EED\u7B7E\u5230...</div>'),$.tb.post("/tbmall/post/useContSignCard",{forum_id:i,tbs:PageData.tbs},function(i){e._isAjaxing=!1,i&&0==i.no?(e._card_count--,e._card_count=Math.max(0,e._card_count),e._dialog.element.find(".j_card_count").text(e._card_count),e._bubble.setContent(o),t.addClass("signed")):e._bubble.setContent(_)})}),e._bubble.showBubble()}}}});_.Module.define({path:"ucenter/widget/sign_mod",sub:{_jq_wrap:null,_options:{},initial:function(n,i){this._jq_wrap=n,this._options=$.extend(this._options,i),this.signRank.options=i,this.signRank.sign_init(n,this._options),this.signRank.pvLog()},signRank:{sign_url:"/sign/add",sign_forum:"/sign/info",get_url:"/sign/loadmonth",month_url:"/sign/month",sign_card:null,sign_year:null,sign_month:null,orign_year:null,orign_month:null,rights_tips:[null,null,null,null,null],mouseEventTimer:null,rightsTipsTimer:null,isReplenishing:!1,rplnBubble:null,resign_card_num:0,rpln_available_time:13858272e5,jq_wrap:null,_resignMap:{2280001:"\u60A8\u5C1A\u5728\u9ED1\u540D\u5355\u4E2D\uFF0C\u4E0D\u80FD\u64CD\u4F5C",2280002:"\u4EB2\uFF0C\u60A8\u5DF2\u88AB\u5C01\u7981\uFF0C\u7B7E\u5230\u6210\u529F\uFF0C\u4F46\u65E0\u6CD5\u6DA8\u7ECF\u9A8C\u54E6~",2280003:"\u7B7E\u5230\u592A\u9891\u7E41\u4E86\u70B9\uFF0C\u4F11\u606F\u7247\u523B\u518D\u6765\u5427:)",2280004:"\u5F53\u524D\u7B7E\u5230\u4EBA\u6570\u592A\u591A\uFF0C\u8BF7\u7A0D\u540E\u518D\u7B7E",2280005:"\u7B7E\u5230\u592A\u9891\u7E41\u4E86\u70B9\uFF0C\u4F11\u606F\u7247\u523B\u518D\u6765\u5427:)",2280006:"\u60A8\u5DF2\u7ECF\u7B7E\u8FC7\u5230\u4E86\uFF0C\u8BF7\u660E\u5929\u7EE7\u7EED\u7B7E\u5230^_^",2280007:"\u7B7E\u5230\u670D\u52A1\u5FD9\uFF0C\u8BF7\u91CD\u65B0\u7B7E\u5230",2280008:"\u670D\u52A1\u5668\u6253\u76F9\u4E86\uFF0C\u518D\u7B7E\u4E00\u6B21\u53EB\u9192\u5B83",2280009:"\u8BE5\u7528\u6237\u6CA1\u6709\u7B7E\u5230",2280010:"\u670D\u52A1\u5668\u6253\u76F9\u4E86\uFF0C\u518D\u7B7E\u4E00\u6B21\u53EB\u9192\u5B83",2280011:"\u670D\u52A1\u5668\u6253\u76F9\u4E86\uFF0C\u518D\u7B7E\u4E00\u6B21\u53EB\u9192\u5B83",2280012:"\u8865\u7B7E\u5361\u4E0D\u8DB3\uFF0C\u8BF7\u5148\u8D2D\u4E70\u8865\u7B7E\u5361",2280013:"\u6570\u636E\u5E93\u8BBF\u95EE\u6210\u529F\uFF0C\u4F46\u6570\u636E\u4E0D\u5B58\u5728",2280014:"\u8865\u7B7E\u5361\u4F7F\u7528\u6570\u636E\u91CF\u8D85\u8FC7\u9650\u5236\uFF0C\u8BF7\u660E\u65E5\u7EE7\u7EED"},_client_html:['<div class="sign_card">','<h2 class="sign_card_title">'+PageUnit.load("sign_mod_card_title")+"</h2>",'<div class="sign_card_detail">'+PageUnit.load("sign_mod_card_detail")+"</div>",'<a href="http://c.tieba.baidu.com/c/s/download/pc?src=webtb&t=2&tab=5#img5" target="_blank" class="sign_card_positive_btn">',PageUnit.load("sign_mod_card_positive_btn")+"</a>",'<a href="/home/main?id='+PageData.user.portrait+'#scardsign" target="_blank" class="sign_card_sign_btn">'+PageUnit.load("sign_mod_card_no_txt")+"</a>","</div>"].join(""),sign_init:function(n,i){var e=this,s=this.jq_wrap=n;if("sign_rank"==$.cookie("add_sign")&&(PageData.is_sign_in||e.showCardBeforeSign(),$.cookie("add_sign",null)),"true"==$.cookie("sign_not_now")&&(s.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing"),setTimeout(function(){s.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")},1e4)),PageData.is_sign_in)e.sign_resetdate(),e.sign_load_month(0),e.cal_mouseEnterOut(),setInterval(function(){e.refresh_sign_rank()},3e5);else{{var t=new Date(Env.server_time);t.getDay()}s.find(".j_signbtn").addClass("j_cansign")}s.on("click",".j_cont_sign_card",function(n){n.preventDefault();var i=$(".j_sign_succ_keep").text(),s=$(".j_sign_succ_count").text();$(this).hasClass("j_need_judge")&&i==s?e.showAlreadyUsed($(this)):_.Module.use("tbmall/widget/ContSignCard")}),s.on("click",".j_onekey_btn",function(n){PageData.user.is_login||(n.preventDefault(),_.Module.use("common/widget/LoginDialog"))}),s.find(".j_btn_getmember").on("click",function(){return _.Module.use("common/widget/JoinVipDialog",[],function(n){n.getMemberDialog()}),!1}),s.on("click",".j_cansign",function(){PageData.user.is_login?PageData.user.is_black?e.show_block_sign_dialog():e.showCardBeforeSign():_.Module.use("common/widget/LoginDialog",["","",function(){$.cookie("add_sign","sign_rank",{expires:14}),$.tb.location.reload()}])}),s.find(".j_calendar_month_prev").click(function(){var n=new Date(e.sign_year,e.sign_month-1,1),i=new Date(e.orign_year-2,e.orign_month-1,1),s=new Date(2012,6,1);n.getTime()<=i.getTime()||n.getTime()<=s.getTime()||e.set_sign_calendar("",e.sign_year,e.sign_month,-1)}),s.find(".j_calendar_month_next").click(function(){e.sign_year>e.orign_year||e.sign_year==e.orign_year&&e.sign_month>=e.orign_month||e.set_sign_calendar("",e.sign_year,e.sign_month,1)}),PageData.user.is_login&&(s.find(".j_sign_rights").show(),s.find(".j_sign_rights_icon").each(function(n,i){$(i).mouseover(function(){e.rightsTipsTimer=setTimeout(function(){e.sign_right_tips(n)},400)}).mouseout(function(){window.clearInterval(e.rightsTipsTimer),e.rightsTipsTimer=window.setTimeout(function(){null!=e.rights_tips[n]&&e.rights_tips[n].hideBubble()},10)})}));var a=PageData.user,r=a.mPaar_props&&a.mParr_props.level&&a.mParr_props.level.props_id>0&&a.mParr_props.level.end_time>Env.server_time/1e3,o="sign_box_bright_hover";o=i.hasClass?r?"sign_box_member_bright_hover":"sign_box_bright_hover":r?"sign_box_member_bright_noclass_hover":"sign_box_bright_noclass_hover";var l=s.find(".j_sign_box");l.hover(function(){$(this).addClass(o)},function(){$(this).removeClass(o)});var g=s.find(".j_sign_dir_tip"),d=g.html();g.html("");var c={content:d,arrow_dir:"up",bubble_css:{top:-12,left:i.hasClass?4:50,width:i.hasClass?"pb"==i.page?192:200:120,"text-align":"left"},arrow_pos:{right:i.hasClass?30:-9},attr:" id='tb_message_tip_n' ",wrap:g,closeBtn:!1},u=new UiBubbleTipBase(c),m=l.find(".j_signdir");m.bind("mouseenter",function(){g.show(),u.showBubble()}).bind("mouseleave",function(){u.hideBubble()});var p=$(".lack_sign_monthly_tip_card");s.find(".j_lack_sign_monthly_help").on("click",function(n){n.preventDefault(),p.fadeIn("fast")}).on("mouseleave",function(){p.timeout=setTimeout(function(){p.fadeOut("fast")},1e3)}),p.on("mouseenter",function(){clearTimeout(p.timeout),p.fadeIn("fast")}).on("mouseleave",function(){p.fadeOut("fast")}),s.find(".j_sign_tip_1key_icon").on("click",function(){$.stats.track("\u7B7E\u5230_\u4E00\u952E\u7B7E\u5230icon","\u7B7E\u5230\u6539\u9020",{obj_type:"\u7B7E\u5230",obj_url:$(this).tbattr("href")})})},showAlreadyUsed:function(n){this._alreadyUsedBb&&this._alreadyUsedBb.closeBubble();var i={content:"\u672C\u5427\u6240\u6709\u7B7E\u5230\u5DF2\u7ECF\u8FDE\u7EED\uFF0C\u8BF7\u53BB\u522B\u7684\u5427\u770B\u770B",arrow_dir:"down",bubble_css:{top:-40,left:8,width:143,height:53},arrow_pos:{left:70},wrap:n.parent(),closeBtn:!0};this._alreadyUsedBb=new UiBubbleTipBase(i),this._alreadyUsedBb.showBubble()},showCardBeforeSign:function(){var n=this,i=$(".j_signbtn");"1"==$.cookie("showCardBeforeSign")||n.sign_card?n.sign_add():_.Module.use("common/widget/Card",[{content:n._client_html,arrow_dir:"up",card_css:{width:197,top:i.offset().top+i.height()+11,left:i.offset().left},card_leave_hide:!0}],function(i){n.sign_card=i,n.bindCardEvent(),i.showCard(),$.cookie("showCardBeforeSign","1",{expires:1})})},bindCardEvent:function(){var n=this;$(".sign_card_negative_btn").on("click",function(i){i.preventDefault(),n.sign_card&&n.sign_card._j_card.hide(),n.sign_add()})},sign_resetdate:function(){var n=new Date(Env.server_time);this.sign_year=this.orign_year=n.getFullYear(),this.sign_month=this.orign_month=n.getMonth()+1},cal_mouseEnterOut:function(){var n=this,i=this.jq_wrap;i.find(".j_sign_replenish_button").off().on("click",function(e){e.preventDefault(),"none"==i.find(".j_succ_info").css("display")&&(n.orign_year!=n.sign_year||n.orign_month!=n.sign_month)&&(n.sign_resetdate(),n.sign_load_month(0)),window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=setTimeout(function(){i.find(".j_succ_info").stop(!0,!0).show()},400)}),i.find(".j_signbtn,.j_succ_info").die().live({mouseout:function(){window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=window.setTimeout(function(){i.find(".j_succ_info").fadeOut("slow")},200)},mouseover:function(){"none"==i.find(".j_succ_info").css("display")&&(n.orign_year!=n.sign_year||n.orign_month!=n.sign_month)&&(n.sign_resetdate(),n.sign_load_month(0)),window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=setTimeout(function(){i.find(".j_succ_info").stop(!0,!0).show()},400)}})},cal_mouseEventRemove:function(){window.clearInterval(self.mouseEventTimer),this.jq_wrap.find(".j_signbtn,.j_succ_info").die()},sign_add:function(n){var i=this,e={kw:$.tb.escapeHTML(PageData.forum.forum_name),tbs:PageData.tbs,ie:"utf-8"};$.extend(e,n),this.jq_wrap.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing"),$.tb.post(i.sign_url,e,function(n){if(!n||0!=n.no&&1104!=n.no)if(n&&2150040==n.no)_.Module.use("common/component/CaptchaDialog",{message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\u5B8C\u6210\u7B7E\u5230",vCode:n.data.captcha_vcode_str,vCodeType:n.data.captcha_code_type,title:"\u7B7E\u5230",forumName:"",forumId:"",checkUrl:"/sign/checkVcode",vCodeUrl:"/sign/getVcode",paramsCallback:function(){return{tbs:PageData.tbs}}},function(n){n.bind("onaccept",function(){i.sign_add({captcha_input_str:n.getInputValue(),captcha_vcode_str:n.getVCode()})}),n.bind("onclose",function(){i.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}),n.show()});else{setTimeout(function(){i.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")},1e4);var e=new Date;if(e.setTime(e.getTime()+1e4),$.cookie("sign_not_now",!0,{expires:e}),1007==n.no){var s=i.jq_wrap.find(".j_signbtn");s.removeClass().addClass("j_signbtn signstar_full")}else new $.dialog({html:"<div class='signmod_likeandsign_dialog'>"+i._resignMap[n.no]||n.error+"</div>",holderClassName:"passportDialog",title:"\u7B7E\u5230\u5931\u8D25",draggable:!1,width:338,height:87})}else{var t=n.data.uinfo,a=new Date(t.sign_time);i.sign_year=i.orign_year=a.getFullYear(),i.sign_month=i.orign_month=a.getMonth()+1,i.sign_load_month(1),PageData.is_activity_sign&&$.tb.location.reload()}},"json")},sign_load_month:function(n,i,e){var s=this;$.tb.get(s.get_url,{kw:$.tb.escapeHTML(PageData.forum.forum_name),ie:"utf-8",sign_y:i,sign_m:e,t:Math.random()},function(t){if(t&&0==t.no){s.jq_wrap.find(".j_signin_index").html(t.data.sign_user_info.rank),s.jq_wrap.find(".j_succ_text").html(s.succ_text(PageData.sign_forum_info&&PageData.sign_forum_info.current_rank_info.sign_rank,t.data.sign_user_info.rank,PageData.sign_forum_info.forum_info&&PageData.sign_forum_info.forum_info.level_1_dir_name,t.data.sign_user_info.sign_keep)),s.jq_wrap.find(".j_sign_succ_keep").html(t.data.sign_user_info.sign_keep),s.jq_wrap.find(".j_sign_succ_count").html(t.data.sign_user_info.sign_total),s.setReplenishInfo(t),$(".j_sign_month_lack_days").text(t.data.resign_info.mon_miss_sign_num),i&&e||(s.sign_resetdate(),s.set_sign_calendar(t)),s.signShai(t),s.check_rights_status(t.data.sign_user_info.sign_keep);var a=s.jq_wrap.find(".j_signbtn"),_=s.jq_wrap.find(".j_sign_box");if(_[0]&&_.addClass("sign_box_bright_signed"),a.removeClass().addClass("j_signbtn signstar_signed"),n){var r=t.data.sign_user_info.sign_keep;s.jq_wrap.find(".j_succ_info").show(),a.append('<span class="sign_keep_span">\u8FDE\u7EED'+r+"\u5929</span>"),(30==r||100==r)&&s.sign_100({username:PageData.user.user_name,forumname:PageData.forum.forum_name,memberCount:PageData.memberNumber,memberTitle:PageData.memberTitle,continueSign:r});var o={normal:[2,4],baidubrowser:[3,5],member:[8,10],seniormember:[12,14]},l=r>1?1:0,g="normal";try{g="baidubrowser.tieba"==window.external.GetVersion("version")?"baidubrowser":"normal"}catch(d){}if(PageData.user.mParr_props&&PageData.user.mParr_props.level){var c=PageData.user.mParr_props.level;1e3*c.end_time>+new Date&&(g=2==c.props_id?"seniormember":1==c.props_id?"member":"normal")}var u='<div style="position:absolute;"><div class="sign_plus_two">+'+o[g][l]+" \u7ECF\u9A8C</div></div>";PageData.user.is_like&&!PageData.user.is_block&&(s.jq_wrap.find(".signed_day:last").append(u),setTimeout(function(){$(".sign_plus_two").show().animate({opacity:0,top:"-=20"},2500,function(){$(this).parent().remove()})},1e3)),"member"==g||"seniormember"==g?s.jq_wrap.find(".signed_day:last").removeClass("signed_day").addClass("signed_member_anime"):s.jq_wrap.find(".signed_day:last").removeClass("signed_day").addClass("signed_anime_day")}else s.jq_wrap.find(".j_sign_btn_keep").text(r);s.cal_mouseEnterOut()}},"json")},setReplenishInfo:function(n){var i=this.jq_wrap.find(".j_succ_info"),e=this.jq_wrap.find(".sign_keep_span"),s=0;e.length>0&&e.text("\u8FDE\u7EED"+n.data.sign_user_info.sign_keep+"\u5929");var t=n.data.resign_info;s=this.resign_card_num=t.resign_card_num,$(".rpln_card_wrap").removeClass("rpln_card_wrap_2 rpln_card_wrap_3"),t.resign_card_num<=9||(t.resign_card_num>9&&t.resign_card_num<100?$(".rpln_card_wrap").addClass("rpln_card_wrap_2"):(s="99+",$(".rpln_card_wrap").addClass("rpln_card_wrap_3"))),i.find(".j_rpln_card_count").text(s),0==t.mon_miss_sign_num?this.jq_wrap.find(".j_need_rpln_wrap").text("\u672C\u6708\u5B8C\u7F8E\u7B7E\u5230"):this.jq_wrap.find(".j_need_rpln_wrap").html('\u672C\u6708\u6F0F\u7B7E<span class="j_lack_sign_monthly_count sign_num">'+t.mon_miss_sign_num+"</span>\u6B21")},refresh_sign_rank:function(){var n={kw:$.tb.escapeHTML(PageData.forum.forum_name),ie:"utf-8",tbs:PageData.tbs};$.tb.get(this.sign_forum,n,function(n){var i=!1;try{var e=n}catch(s){i=!0}i||e&&0==e.no&&($(".j_today_signnum").html(e.data.forum_info.current_rank_info.sign_count),$(".j_signrank_index").html(e.data.forum_info.current_rank_info.sign_rank))})},show_block_sign_dialog:function(){var n=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672C\u5427\u7B7E\u5230\u9700\u8981\u5148\u6210\u4E3A\u4F1A\u5458\u54E6~\u52A0\u5165\u6211\u4EEC\u5427\uFF01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_confirm_btn j_sign_confirm' type='button' value='\u77E5\u9053\u4E86' /></div>",holderClassName:"passportDialog",title:"\u672C\u5427\u7B7E\u5230",draggable:!1,width:338,height:87});$(n.element[0]).find(".j_sign_confirm").click(function(){n.close()})},succ_text:function(n,i,e,s){if(s){if(9==s)return"\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u5373\u53EF\u83B7\u5F97\u53D1\u8D34\u5B57\u4F53\u52A0\u7C97\u529F\u80FD\uFF0C\u660E\u5929\u4E0D\u8981\u5FD8\u4E86\u6765\u7B7E\u5230\u54E6\u3002";if(10==s)return"\u606D\u559C\u83B7\u5F97\u53D1\u8D34\u5B57\u4F53\u52A0\u7C97\u529F\u80FD\uFF0C\u53D1\u8D34\u70AB\u8000\u5427\uFF01\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u54E6~";if(19==s)return"\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u5373\u53EF\u83B7\u5F97\u53D1\u8D34\u5B57\u4F53\u53D8\u7EA2\u529F\u80FD\uFF0C\u660E\u5929\u4E0D\u8981\u5FD8\u4E86\u6765\u7B7E\u5230\u54E6\u3002";if(20==s)return"\u606D\u559C\u83B7\u5F97\u53D1\u8D34\u5B57\u4F53\u53D8\u7EA2\u529F\u80FD\uFF0C\u53D1\u8D34\u70AB\u8000\u5427\uFF01\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u54E6~";if(29==s)return"\u5DF2\u8FDE\u7EED\u7B7E\u523029\u5929\uFF0C\u660E\u65E5\u7B7E\u5230\u5373\u53EF\u83B7\u5F97ID\u7EA2\u8272\u9AD8\u4EAE\u6548\u679C\uFF0C\u4E0D\u8981\u5FD8\u4E86\u54E6~";if(30==s)return"\u606D\u559C\u4F60\u83B7\u5F97ID\u7EA2\u8272\u9AD8\u4EAE\u6548\u679C\uFF0C\u8D76\u7D27\u53D1\u8D34\u70AB\u8000\u5427\u3002\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u54E6~"}var t;if(10>=i)switch(parseInt(i)){case 1:t="\u606D\u559C\u4F60\u62A2\u5F97\u672C\u5427\u4ECA\u65E5\u7B7E\u5230\u7B2C1\u540D\uFF0C\u8D76\u7D27\u622A\u56FE\u7559\u5FF5\u5427~~";break;case 2:t="\u672C\u5427\u4ECA\u65E5\u7B7E\u5230\u7B2C1\u4EBA\u88AB\u62A2\u8D70\u4E86\u2026\u2026\u660E\u5929\u518D\u6765\u65E9\u4E00\u70B9\u5427~";break;default:t="\u606D\u559C\u4F60\u540D\u5217\u672C\u5427\u4ECA\u65E5\u7B7E\u5230\u524D10\uFF0C\u83B7\u5F97\u201C\u672C\u5427\u5FE0\u8BDA\u5427\u53CB\u201D\u79F0\u53F7~"}else if(100==i)t="\u54A6\uFF0C\u4E00\u4E0D\u5C0F\u5FC3\u5C31\u8E29\u5230100\u4E86\uFF0C\u4ECA\u5929\u4F1A\u6709\u597D\u8FD0\u6C14\u5594~";else if(250==i)t="\u8BF7\u5728\u5FC3\u4E2D\u9ED8\u5FF53\u904D\uFF1A\u6211\u4E0D\u662F250\u6211\u4E0D\u662F250\u6211\u4E0D\u662F250\u2026\u2026";else if(1e3==i)t="\u524D\u9762999\u4EBA\u7684\u7ECF\u8FC7\uFF0C\u53EA\u4E3A\u4E86\u6210\u5168\u4F60\u7684\u5706\u6EE1\u2026\u2026";else if(1e4==i)t="\u80FD\u8E29\u5230\u5982\u6B64\u5927\u6574\u5B9E\u5728\u662F\u4EBA\u54C1\u7206\u68DA\u554A\uFF01\u53EF\u4EE5\u51FA\u95E8\u4E70\u5F69\u7968\u4E86~";else if(100>=n)switch(parseInt(n)){case 1:t="\u672C\u5427\u7B2C\u4E00\u7684\u5730\u4F4D\uFF0C\u53C8\u7A33\u5B9A\u4E86\u7A33\u5B9A\u4E86\u7A33\u5B9A\u4E86\u2026\u2026";break;case 2:t="\u672C\u5427\u79BB\u7B2C\u4E00\u540D\u53C8\u8FD1\u4E86\u4E00\u70B9\u70B9\u70B9\u70B9\uFF0C\u52A0\u6CB9\uFF01";break;case 3:t="\u4FDD\u6301\u524D\u4E09\u540D\u4E0D\u5BB9\u6613\uFF0C\u8BB0\u5F97\u660E\u5929\u8981\u6765\u7B7E\u5230\u54E6~~";break;default:t=10>=n?"\u524D\u5341\u540D\u7ADE\u4E89\u6FC0\u70C8\uFF0C\u8BB0\u5F97\u6BCF\u5929\u90FD\u6765\u7B7E\u5230\u54E6~":30>=n?"\u79BB\u524D\u5341\u540D\u8FD8\u6709\u4E9B\u8DDD\u79BB\uFF0C\u5927\u5BB6\u6765\u5F97\u66F4\u52E4\u5FEB\u4E9B\u5427~":"\u4E00\u767E\u5F3A\u7684\u5730\u4F4D\u9700\u8981\u5927\u5BB6\u7684\u5171\u540C\u52AA\u529B\uFF0C\u52A0\u6CB9\uFF01"}else t="\u8BB0\u5F97\u660E\u5929\u8981\u6765\u7B7E\u5230\u54E6\uFF0C\u5E2E\u672C\u5427\u63D0\u5347\u6392\u540D~";return t},set_sign_calendar:function(n,i,e,s){function t(n){for(var i=n.data.sign_user_info.sign_month,e=["\uFF0C\u7B7E\u5230\u7ECF\u9A8C+2\uFF0C\u8FDE\u7EED\u7B7E\u5230+4","\uFF0C\u624B\u673A\u7B7E\u5230\u7ECF\u9A8C+3\uFF0C\u8FDE\u7EED\u7B7E\u5230+5","\uFF0C\u767E\u5EA6\u6D4F\u89C8\u5668\u7B7E\u5230\u7ECF\u9A8C+3\uFF0C\u8FDE\u7EED\u7B7E\u5230+5","\uFF0C\u767E\u5EA6\u624B\u673A\u6D4F\u89C8\u5668\u7B7E\u5230\u7ECF\u9A8C+4\uFF0C\u8FDE\u7EED\u7B7E\u5230+6","\uFF0C\u7B7E\u5230\u7ECF\u9A8C+6\uFF0C\u8FDE\u7EED\u7B7E\u5230+8","\uFF0C\u4F7F\u7528\u4F1A\u5458\u7B7E\u5230\u7ECF\u9A8C+8\uFF0C\u8FDE\u7EED\u7B7E\u5230+10","\uFF0C\u4F7F\u7528\u9AD8\u7EA7\u4F1A\u5458\u7B7E\u5230\u7ECF\u9A8C+12\uFF0C\u8FDE\u7EED\u7B7E\u5230\u7ECF\u9A8C+14",""],s=0;s<i.length;s++){var t=i[s],a=t.t,o=a.substr(0,a.indexOf(":")),l=a.substr(a.indexOf(":")+1),g="\u4E8E"+o+"\u70B9"+l+"\u5206\uFF0C\u7B2C"+t.rank+"\u4E2A\u7B7E\u5230";"00"==o&&"00"==l&&""==t.rank&&(g="\u989D\uFF0C\u670D\u52A1\u5668\u8FD9\u5929\u6253\u76F9\u4E86\uFF0C\u6CA1\u8BB0\u4F4F\u4F60\u662F\u51E0\u70B9\u7B7E\u5230\u7684\uFF0C\u62B1\u6B49...");var d=parseInt(t.d);r.push(d);var c="signed_day",u=7;switch(t.sign_type){case"pc":u=0,c="signed_day";break;case"mobile":u=1,c="signed_mob_day";break;case"brs":u=2,c="signed_day";break;case"mobile_brs":u=3,c="signed_mob_day";break;case"mobile_client":u=4,c="signed_mob_day";break;case"member":u=5,c="signed_member";break;case"senior_member":u=6,c="signed_member"}var m=g+e[u];PageData.user&&1==PageData.user.is_block&&(c="",m=g+"\uFF0C\u60A8\u5F53\u524D\u5DF2\u88AB\u5C01\u7981\uFF0C\u6682\u65E0\u7B7E\u5230\u7ECF\u9A8C"),t.is_resign&&(c="signed_rpln_day",m="\u8865\u7B7E\u6210\u529F\uFF0C\u8865\u7B7E\u7ECF\u9A8C+"+t.sign_score),n.data.is_detail||(c="sign_gray",m=""),_.find(".j_d_"+d).addClass(c).tbattr({title:m})}}function a(){var n=_.find(".j_canlerdar_days"),i=n.find("td").filter(function(){return!$(this).hasClass("emptyDate")});if(i.each(function(n){var i=new Date(o.sign_year,o.sign_month-1,n+1);$.inArray(n+1,r)<0&&i<o.getEnvInitialTime()&&i>=Math.max(o.rpln_available_time,o.getEnvInitialTime()-2592e6)&&($(this).addClass("unsigned_day"),$.browser.mozilla&&$(this).children(".mozilla_td_hack").length<1&&$(this).append('<div class="mozilla_td_hack" style="position:absolute"></div>'))}),n.off().on("mouseenter",".unsigned_day",function(){$(this).addClass("unsigned_day_hover")}).on("mouseleave",".unsigned_day",function(){$(this).removeClass("unsigned_day_hover"),o.rplnBubble&&o.rplnBubble.closeBubble()}).on("click",".unsigned_day",function(){o.delReplenishSignGuide(),o.replenishSign($(this))}),"1"!==$.cookie("rpln_guide")){var e=i.filter(".unsigned_day").last();if(e.length>0){var s=parseInt(e.text()),t=new Date(o.sign_year,o.sign_month-1,s);t>=o.rpln_available_time&&(e.addClass("rpln_guide_day"),o.setReplenishSignGuide(e.parent().index()),$.cookie("rpln_guide","1",{expires:1e3}))}}}var _=this.jq_wrap,r=[],o=this;(""==i||"undefined"==typeof i)&&(i=this.sign_year),(""==e||"undefined"==typeof e)&&(e=this.sign_month),"undefined"!=typeof s&&(s=parseInt(s),0>s?(e-=1,0==e&&(i-=1,e=12)):s>0&&(e+=1,13==e&&(i+=1,e=1)));var l,g,d,c;l=new Date(i,e-1,1),g=new Date(i,e,0),d=l.getDay(),c=g.getDate(),_.find(".j_5, .j_6").css({display:"none"});for(var u=1;32>u;u++)_.find(".j_d_"+u).removeClass(function(n,i){var e=i.split(" ");return e.shift(),e.join(" ")}).tbattr({title:""});for(var m=0;7>m;m++)_.find(".j_1_"+m+", .j_5_"+m+", .j_6_"+m).html("&nbsp;").addClass("emptyDate");for(var p=1,m=d,u=1;c>0;m++,c--,u++)7==m&&(m=0,p++),5==p&&_.find(".j_5").css({display:""}),6==p&&_.find(".j_6").css({display:""}),_.find(".j_"+p+"_"+m).addClass("j_d_"+u).html(u).removeClass("emptyDate");this.sign_year=i,this.sign_month=e,"undefined"!=typeof n&&""!=n?(t(n),a(n)):$.tb.get(this.get_url,{kw:$.tb.escapeHTML(PageData.forum.forum_name),ie:"utf-8",sign_y:i,sign_m:e},function(n){return n&&0==n.no?(t(n),o.setReplenishInfo(n),a(n),void 0):(alert(n.no),void 0)},"json"),String(e).length<2&&(e+="",e="0"+e);var h=i+"\u5E74"+e+"\u6708";if(_.find(".j_calendar_month").html(h),this.sign_month==this.orign_month&&this.sign_year==this.orign_year){var f=_.find(".j_d_"+new Date(Env.server_time).getDate());if(f.hasClass("signed_day")||f.hasClass("signed_mob_day")||f.hasClass("signed_member"));else{var b=$(".j_signin_index").html();f.addClass("signed_day").tbattr({title:"\u4E8E"+new Date(Env.server_time).getHours()+"\u70B9"+new Date(Env.server_time).getMinutes()+"\u5206\uFF0C\u7B2C"+b+"\u4E2A\u7B7E\u5230\uFF0C\u7B7E\u5230\u7ECF\u9A8C+2\uFF0C\u8FDE\u7EED\u7B7E\u5230+4"})}}},setReplenishSignGuide:function(n){if(!this.$guide_mask){this.$guide_mask_close=$('<div class="rpln_guide_close">X</div>'),this.$guide_mask=$('<div class="rpln_guide">'),this.$guide_text=$('<div class="rpln_guide_txt">');var i=this.jq_wrap.find(".sign_succ_calendar");this.$guide_text.css("top",26*(n+1)),i.prepend(this.$guide_text).prepend(this.$guide_mask).prepend(this.$guide_mask_close),this.$guide_mask_close.on("click",$.proxy(this.delReplenishSignGuide,this))}},delReplenishSignGuide:function(){this.$guide_mask_close&&this.$guide_mask_close.remove(),this.$guide_mask&&this.$guide_mask.remove(),this.$guide_text&&this.$guide_text.remove()},getEnvInitialTime:function(){var n=new Date(Env.server_time);return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n},replenishSign:function(n){var i,e,s,t,a,_,r,o,l=this;if(i=parseInt(n.text()),e=new Date(this.sign_year,this.sign_month-1,i),s=l.getEnvInitialTime(),t=(s-e)/864e5,a=0,2>=t)a=1;else if(10>=t)a=2;else if(20>=t)a=3;else{if(!(30>=t))throw"\u53EF\u7B7E\u5230\u5929\u6570\u4E0D\u5E94\u5927\u4E8E30\u5929";a=4}if(l.rplnBubble&&l.rplnBubble.closeBubble(),$.isNumeric(i)&&!(e>s-864e5)){var g={arrow_dir:"down",bubble_css:{top:-50,left:-61,width:143,height:53},arrow_pos:{left:70},wrap:n,closeBtn:!1};o={top:-19,left:-34,width:110,height:20},buy_arrow_pos={left:54},_='<div class="rpln_tip">\u8865\u7B7E\u672C\u6B21\u9700\u6D88\u8017<span class="rpln_card_needed_count">'+a+'\u5F20</span>\u8865\u7B7E\u5361<br><a class="yes_btn">\u786E\u5B9A</a><a class="cancel_btn">\u53D6\u6D88</a></div>',r='<div class="rpln_tip">\u8FD8\u9700\u8981'+parseInt(a-this.resign_card_num)+'\u5F20\u8865\u7B7E\u5361\uFF0C\u53BB<a target="_blank" class="tbmall_link" href="/tbmall/propslist?category=108">\u5546\u57CE\u8D2D\u4E70\u5427</a>>></div>',$.browser.mozilla&&(g.wrap=n.children(".mozilla_td_hack"),g.bubble_css.top=-74,o.top=-43),this.resign_card_num>=a?g.content=_:(g.content=r,g.bubble_css=o,g.arrow_pos=buy_arrow_pos),l.rplnBubble=new UiBubbleTipBase(g),l.rplnBubble.j_bubble.on("click",".yes_btn",function(){l.isReplenishing||(l.isReplenishing=!0,$.tb.post("/sign/resign",{kw:$.tb.escapeHTML(PageData.forum.forum_name),tbs:PageData.tbs,ie:"utf-8",sign_y:l.sign_year,sign_m:l.sign_month,sign_d:i},function(i){l.isReplenishing=!1,n.removeClass("unsigned_day_hover"),i?0==i.no||2280002==i.no?(n.removeClass("unsigned_day unsigned_day_hover").addClass("signed_rpln_anime"),l.rplnBubble.closeBubble(),PageData.user.is_like&&!PageData.user.is_block&&(n.append('<div style="position:absolute;"><div class="sign_plus">+'+5*a+" \u7ECF\u9A8C</div></div>"),n.find(".sign_plus").show().animate({opacity:0,top:"-=20"},2500,function(){$(this).parent().remove()})),n.tbattr("title","\u4E8E"+(new Date(Env.server_time).getMonth()+1)+"\u6708"+new Date(Env.server_time).getDate()+"\u65E5\u8865\u7B7E\u6210\u529F\uFF0C\u8865\u7B7E\u7ECF\u9A8C+"+5*a),l.sign_load_month(0,l.sign_year,l.sign_month)):(l.rplnBubble&&l.rplnBubble.closeBubble(),g.content=l._resignMap[i.no]||"\u54CE\u5440~\u670D\u52A1\u5668\u6253\u76F9\u4E86\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5~",g.bubble_css=o,g.arrow_pos=buy_arrow_pos,l.rplnBubble=new UiBubbleTipBase(g),l.rplnBubble.showBubble()):(l.rplnBubble&&l.rplnBubble.closeBubble(),g.content="\u54CE\u5440~\u670D\u52A1\u5668\u6253\u76F9\u4E86\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5~",g.bubble_css=o,g.arrow_pos=buy_arrow_pos,l.rplnBubble=new UiBubbleTipBase(g),l.rplnBubble.showBubble())}))}).on("click",".cancel_btn",function(){n.removeClass("unsigned_day_hover"),l.rplnBubble.closeBubble()}),l.rplnBubble.showBubble()}},pvLog:function(){$("#sign_music_rank").on("click",function(){$.stats.track("music_rank","\u7B7E\u5230")})},signShai:function(n){var i=this,e=null!=navigator.userAgent.match(/iPad/i);void 0==document.createElement("canvas").getContext||$.browser.mozilla||"frs"!=PageData.product||e||_.Module.use("frs/component/SignShai",["sign_mod",n.data.sign_user_info],function(n){n.bind("startRender",function(){i.cal_mouseEventRemove()}),n.bind("completeRender",function(){i.cal_mouseEnterOut()})})},sign_100:function(n){if(n){var i=new Date,e=i.getFullYear()+"\u5E74"+(i.getMonth()+1)+"\u6708"+i.getDate()+"\u65E5",s="";s="<div class='sign_100_dlg'><div class='sign_100_"+n.continueSign+"'></div><div class='sign_100_text'><div class='sign_100_close'></div><div class='sign_100_title'>\u4EB2\u7231\u7684"+n.username+"</div>",s=100==n.continueSign?s+"<div class='sign_100_content'>\u4ECA\u5929\u662F\u4F60\u5728\u54B1\u4EEC<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7B7E\u5230\u7684<span class='rank_number'>\u7B2C"+n.continueSign+"\u5929</span>\uFF0C\u503C\u5F97\u7EAA\u5FF5\u7684\u65E5\u5B50\uFF0C\u6709\u6728\u6709\uFF01<br/>\u65F6\u95F4\u8FC7\u5F97\u771F\u5FEB\u54C8\uFF0C\u4ECE\u7B2C\u4E00\u6B21\u7B7E\u5230\u5230\u73B0\u5728\uFF0C\u5DF2\u6709"+n.continueSign+"\u4E2A\u503C\u5F97\u56DE\u5473\u7684\u65E5\u65E5\u591C\u591C\u5728\u8FD9\u91CC\u7559\u5B58\u3002<br/>\u8BA9\u6211\u4EEC\u611F\u5230\u5F00\u5FC3\u7684\u662F\uFF0C\u4F60\u4ECD\u7136\u662F\u54B1\u4EEC<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7684"+n.memberCount+"\u4E2A<span class='sign_baname_highlight'>"+n.memberTitle+"</span>\u4E2D\u575A\u5B9E\u7684\u4E00\u4EFD\u5B50\u3002<br/>\u4ECA\u5929\uFF0C\u7B7E\u5230"+n.continueSign+"\u5929\uFF1B\u6B64\u540E\uFF0C\u8BA9\u6211\u4EEC\u4F9D\u7136\u5171\u540C\u6210\u957F\uFF0C\u5E76\u5FEB\u4E50\u3002<br/></div>":s+"<div class='sign_100_content'>\u77E5\u9053\u5417\uFF0C\u4ECA\u5929\u662F\u4F60\u5728\u54B1\u4EEC<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7B7E\u5230\u7684<span class='rank_number'>\u7B2C"+n.continueSign+"\u5929</span>\uFF0C\u6574\u6574\u4E00\u4E2A\u6708\u5566\uFF01<br/>\u65F6\u95F4\u8FC7\u5F97\u633A\u5FEB\u7684\u54C8\uFF0C\u4ECE\u4F60\u7B2C\u4E00\u6B21\u5230\u672C\u5427\u7B7E\u5230\uFF0C\u70B9\u4E0E\u4E0D\u70B9\u95F4\uFF0C\u5728\u8D34\u5427\u5EA6\u8FC7\u4E86"+n.continueSign+"\u4E2A\u7F8E\u597D\u7684\u65E5\u5B50\u3002<br/>\u4ECA\u540E\u7684\u8DEF\u8FD8\u957F\u7740\u5462\uFF0C\u8877\u5FC3\u5E0C\u671B\u4F60\u5728<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7684\u6BCF\u4E00\u5929\u90FD\u80FD\u5F00\u5FC3\uFF0C\u4E0E\u5168\u4F53\u5427\u53CB\u4EEC\u76F8\u77E5\u76F8\u7231\u3002<br/>\u4ECA\u5929\uFF0C\u7B7E\u5230\u6EE1\u6708\uFF1B\u6B64\u540E\uFF0C\u8BA9\u6211\u4EEC\u4F9D\u7136\u5171\u540C\u6210\u957F\u3002<br/></div>",s=s+"<div class='sign_100_message'><a href='/i/sys/jump?un=%CC%F9%B0%C9%C7%A9%B5%BD%D0%A1%C3%D8%CA%E9' target='_blank'>\u8D34\u5427\u7B7E\u5230\u5C0F\u79D8\u4E66</a><img src='http://tb2.bdstatic.com/tb/img/itieba_vip.gif' title='\u8D34\u5427\u5B9E\u540D\u8BA4\u8BC1' class='verified_icon'>&nbsp;&nbsp;&nbsp;&nbsp;"+e+"&nbsp;&nbsp;&nbsp;&nbsp;<button class='j_sign_100_shai sign_100_shai_btn'>&nbsp;</button></div></div></div>";var t=new $.dialog({html:s,holderClassName:"sign_100_wapper",width:"681",showTitle:!1});$(t.element[0]).find(".sign_100_close").click(function(){t.close()});var a=null!=navigator.userAgent.match(/iPad/i);void 0==document.createElement("canvas").getContext||$.browser.mozilla||"frs"!=PageData.product||a||($(".j_sign_100_shai").show(),_.Module.use("ucenter/component/sign100",["dialogJbody",n.continueSign],function(n){n.bind("completeRender",function(){t.close()})}))}},sign_right_tips:function(n){var i=[PageUnit.load("sign_mod_tiptitle1"),PageUnit.load("sign_mod_tiptitle2"),PageUnit.load("sign_mod_tiptitle3"),PageUnit.load("sign_mod_tiptitle4"),PageUnit.load("sign_mod_tiptitle5")],e=[PageUnit.load("sign_mod_tiptext1"),PageUnit.load("sign_mod_tiptext2"),PageUnit.load("sign_mod_tiptext3"),PageUnit.load("sign_mod_tiptext4"),PageUnit.load("sign_mod_tiptext5")],s=[PageUnit.load("sign_mod_tipcondition1"),PageUnit.load("sign_mod_tipcondition2"),PageUnit.load("sign_mod_tipcondition3"),PageUnit.load("sign_mod_tipcondition4"),PageUnit.load("sign_mod_tipcondition5")];$(".j_sign_rights").css("position","relative").css("z-index","1");var t=[43,77,114,145,175],a=n+1,_={icon:"sign_big_icon_"+a,title:i[n],text:e[n],condition:s[n],position_right:13,arr_right:t[n]},r={content:"<div class='sign_rights_tip'><div class='sign_rights_top clearfix'><div class='sign_rights_big_icon "+_.icon+"'></div><div class='sign_rights_text_wapper'><div class='sign_rights_title'>"+_.title+"</div><div class='sign_rights_title_text'>"+_.text+"</div></div></div><div class='sign_rights_popline'></div><div class='sign_rights_condition'>"+_.condition+"</div></div>",arrow_dir:"up",bubble_css:{top:35,right:_.position_right,width:250,"z-index":9999},arrow_pos:{left:_.arr_right},attr:" ",wrap:$(".j_sign_rights"),closeBtn:!1};if(null===this.rights_tips[n]){var o=new UiBubbleTipBase(r);o.showBubble(),this.rights_tips[n]=o}else this.rights_tips[n].showBubble()},check_rights_status:function(n){$(".j_sign_rights_icon:eq(0)").addClass("rights_get"),n>=2&&$(".j_sign_rights_icon:eq(1)").addClass("rights_get"),n>=10&&$(".j_sign_rights_icon:eq(2)").addClass("rights_get"),n>=20&&$(".j_sign_rights_icon:eq(3)").addClass("rights_get"),n>=30&&$(".j_sign_rights_icon:eq(4)").addClass("rights_get")}}}});_.Module.define({path:"frs/widget/medal",sub:{_card_op:{width:230,height:78},initial:function(){try{this._createMedalDialog(),this._handleEvent(),this._setMedalMap()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/medal/medal.js",method:"",ln:17}),t}},_handleEvent:function(){var t=this;$("#forum_medal").find("a").hover(function(){t._showMedalDialog($(this))},function(){}),$("#forum_medal").hover(function(){},function(){setTimeout(function(){t._medalShowing===!1&&t._medalDialog&&t._medalDialog.hide()},50)})},_setMedalMap:function(){this.medalMap={medal1:{url:"http://tieba.baidu.com/p/2510950726",title:"\u65B0\u79C0\u8D34\u5427\u51B2\u523A\u8D5B\u83B7\u80DC\u5427",intro:"\u4E13\u5C5E\u5C0F\u578B\u5427\u7684\u52A9\u63A8\u6D3B\u52A8\uFF0C\u5171\u6709133\u4E2A\u5427\u6210\u529F\u51B2\u523A"},medal2:{url:"http://tieba.baidu.com/p/2576294729",title:"\u5343\u4E07\u52A9\u63A8\u8BA1\u5212\u52A9\u63A8\u8D34\u5427",intro:"\u5427\u4E3B\u5343\u4E07\u52A9\u63A8\u8BA1\u5212\uFF0C\u6276\u6301\u767E\u4E07\u5427\u4E3B\u548C\u8D34\u5427\u6210\u957F"},medal3:{url:"http://tieba.baidu.com/p/2559913135",title:"\u725B\u5427\u8054\u8D5B\u201C\u8D85\u5427\u676F\u201D",intro:"\u4E89\u593A\u725B\u5427\u5E2D\u4F4D\uFF0C\u4E0D\u505A\u4E8C\u6D41\u8D34\u5427\uFF0C\u8DFB\u8EAB\u8D85\u4E00\u6D41\u8D34\u5427\uFF01"},medal4:{url:"http://tieba.baidu.com/p/2559913135",title:"\u725B\u5427\u8054\u8D5B\u201C\u51A0\u519B\u5956\u201D",intro:"\u4E89\u593A\u725B\u5427\u5E2D\u4F4D\uFF0C\u4E0D\u505A\u4E8C\u6D41\u8D34\u5427\uFF0C\u8DFB\u8EAB\u8D85\u4E00\u6D41\u8D34\u5427\uFF01"},medal5:{url:"http://tieba.baidu.com/p/2559913135",title:"\u725B\u5427\u8054\u8D5B\u201C\u4E9A\u519B\u5956\u201D",intro:"\u4E89\u593A\u725B\u5427\u5E2D\u4F4D\uFF0C\u4E0D\u505A\u4E8C\u6D41\u8D34\u5427\uFF0C\u8DFB\u8EAB\u8D85\u4E00\u6D41\u8D34\u5427\uFF01"},medal6:{url:"http://tieba.baidu.com/p/2559913135",title:"\u725B\u5427\u8054\u8D5B\u201C\u5B63\u519B\u5956\u201D",intro:"\u4E89\u593A\u725B\u5427\u5E2D\u4F4D\uFF0C\u4E0D\u505A\u4E8C\u6D41\u8D34\u5427\uFF0C\u8DFB\u8EAB\u8D85\u4E00\u6D41\u8D34\u5427\uFF01"},medal7:{url:"http://tieba.baidu.com/p/2559913135",title:"\u725B\u5427\u8054\u8D5B\u201C\u4F18\u79C0\u5956\u201D",intro:"\u4E89\u593A\u725B\u5427\u5E2D\u4F4D\uFF0C\u4E0D\u505A\u4E8C\u6D41\u8D34\u5427\uFF0C\u8DFB\u8EAB\u8D85\u4E00\u6D41\u8D34\u5427\uFF01"},medal8:{url:"http://tieba.baidu.com/p/2478431219",title:"\u6E38\u620F\u6700\u5F3A\u5427\u51A0\u519B",intro:"\u6700\u5177\u6E38\u620F\u8303\u513F\u3001\u6700\u591A\u6E38\u620F\u8FBE\u4EBA\u805A\u96C6\u7684\u6E38\u620F\u6700\u5F3A\u5427"},medal9:{url:"http://tieba.baidu.com/p/2478431219",title:"\u6E38\u620F\u6700\u5F3A\u5427\u4E9A\u519B",intro:"\u6700\u5177\u6E38\u620F\u8303\u513F\u3001\u6700\u591A\u6E38\u620F\u8FBE\u4EBA\u805A\u96C6\u7684\u6E38\u620F\u6700\u5F3A\u5427"},medal10:{url:"http://tieba.baidu.com/p/2478431219",title:"\u6E38\u620F\u6700\u5F3A\u5427\u5B63\u519B",intro:"\u6700\u5177\u6E38\u620F\u8303\u513F\u3001\u6700\u591A\u6E38\u620F\u8FBE\u4EBA\u805A\u96C6\u7684\u6E38\u620F\u6700\u5F3A\u5427"},medal11:{url:"http://tieba.baidu.com/p/2478431219",title:"\u6E38\u620F\u6700\u5F3A\u542720\u5F3A",intro:"\u6700\u5177\u6E38\u620F\u8303\u513F\u3001\u6700\u591A\u6E38\u620F\u8FBE\u4EBA\u805A\u96C6\u7684\u6E38\u620F\u6700\u5F3A\u5427"},medal12:{url:"http://tieba.baidu.com/p/2794801701",title:"\u4EBA\u6C14\u8D34\u5427\u7535\u53F0",intro:"\u6821\u56ED\u660E\u661FDJ\u9009\u62D4\u8D5B\u4E2D\u4EBA\u6C14\u7206\u68DA\u5427"},medal13:{url:"http://tieba.baidu.com/p/2794801701",title:"\u9B45\u529B\u8D34\u5427\u7535\u53F0",intro:"\u6821\u56ED\u660E\u661FDJ\u9009\u62D4\u8D5B\u4E2D\u6700\u5177\u9B45\u529B\u7684\u8D34\u5427"},medal14:{url:"http://tieba.baidu.com/p/2794801701",title:"\u660E\u661F\u8D34\u5427\u7535\u53F0",intro:"\u6821\u56ED\u660E\u661FDJ\u9009\u62D4\u8D5B\u4E2D\u8363\u83B7\u524D\u4E09\u7532\u7684\u5B9E\u529B\u8D34\u5427"}}},_createMedalDialog:function(){var t,i=this;t=['<div class="ui_card_wrap forum_medal_card" id="forum_medal_card">','<div class="ui_card_content medal-w">','<a class="medal-img-w" target="_blank" href=""></a>','<div class="medal-info-w">','<a class="medal-info-title medal-link" id="medal_title" target="_blank" href=""></a>','<p class="medal-intro"></p>',"</div>","</div>",'<span class="j_ui_white_arrow arrow ui_white_down"></span>',"</div>"].join(""),this._medalDialog=$(t),this._medalDialog.hide(),$("body").append(this._medalDialog),this._medalDialog.hover(function(){i._medalShowing=!0,i._medalDialog.show()},function(){i._medalShowing=!1,i._medalDialog.hide()})},_showMedalDialog:function(t){var i,a=this,e=t.tbattr("class"),l=this.medalMap[e];i=l.title,this._medalDialog.find(".medal-img-w").tbattr("href",l.url)[0].className="medal-img-w "+e,this._medalDialog.find("#medal_title").text(i).tbattr("href",l.url),this._medalDialog.find(".medal-intro").text(l.intro),this._medalDialog.find("#medal_link").text(l.link).tbattr("href",l.url);var d=t.offset();this._medalDialog.css({top:d.top-a._card_op.height-14,left:d.left-a._card_op.width/2+13}).show(),a._medalShowing=!1}}});_.Module.define({path:"frs/widget/forum_card/focus_btn",requires:["comforum/widget/attentionCategoryGame"],sub:{initial:function(t){try{this.isOfficial=t.isOfficial,this.tbs=t.tbs,this.uid=t.uid,this.is_forum_fourth_manager=t.is_forum_fourth_manager,this.avatar=t.avatar,this.userForumList=t.userForumList||"",this.forum_name="",t.fr&&"bawu"==t.fr&&(this.forum_name=$.tb.unescapeHTML(t.forum_name));var e=this,a=$("#j_head_focus_btn"),o=null;e.config={},e.config.url={closetip:"/f/like/commit/notice/delete",dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete"},o=parseInt(t.islike)?function(){if(PageData.user.power&&PageData.user.power.bawu)return e._showAlert('<p style="text-align: center;">\u60A8\u8FD8\u662F\u672C\u5427\u7684\u5427\u52A1\uFF0C\u8F9E\u804C\u540E\u624D\u80FD\u53D6\u6D88\u5173\u6CE8\u54E6~</p>'),!1;var t=PageData.forum_name||PageData.forum.forum_name;t=$.tb.subByte(t,10,"...");var a=['<div style="width:190px;text-align:center;top:18px;left:10px;position:absolute;">\u786E\u5B9A\u4E0D\u518D\u5173\u6CE8 <span style="color:red">'+t+"</span> \u5427\uFF1F</div>",'<a href="#" id="cancel_focus_yes" class=" ui_btn ui_btn_s" style="position:absolute;top:50px;left:55px;">',"<span><em>\u786E\u8BA4</em></span>","</a>",'<a href="#" onclick="return false;" id="cancel_focus_no" class="ui_btn ui_btn_sub_s" style="position:absolute;top:50px;left:105px;">',"<span><em>\u53D6\u6D88</em></span>","</a>"].join(""),o=new $.dialog({html:a,showTitle:!1,fixed:!1,show:!0,draggable:!1,autoCenter:!1,modal:!1,top:$("#j_head_focus_btn").offset().top-$(this).height()/2-90,left:$("#j_head_focus_btn").offset().left-$(this).width()/2+15,width:210,height:70});$("#cancel_focus_yes").on("click",function(){try{e._undolike(),o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:82}),t}}),$("#cancel_focus_no").on("click",function(){try{o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:85}),t}})}:function(){e._dolike()},a.on("click",o),$(".j_search_post ").click(function(){try{$.stats.track("FRS\u5168\u5427\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:95}),t}}),$(".search_internal_btn").click(function(){try{$.stats.track("FRS\u5427\u5185\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:98}),t}}),$(".sign_title_text_bright").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:101}),t}}),$(".j_nav_list > li:eq(2) a").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:104}),t}})}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:105}),i}},_showAlert:function(t){var e='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+t+"</div>";$.dialog.open(e,{title:"\u64CD\u4F5C\u5931\u8D25",width:380})},_dolike:function(){var t=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.is_login&&PageData.user.no_un)return TbCom.process("User","buildUnameFrame","\u586B\u5199\u7528\u6237\u540D","\u6709\u7528\u6237\u540D\u624D\u80FD\u70B9\u4EAE\u201C\u6211\u559C\u6B22\u201D\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~"),!1;var e={};1==$.tb.location.getSearchValue("fromadlike")&&$.stats.track("\u95F4\u63A5\u52A0\u5173\u6CE8","\u5206\u53D1\u5173\u6CE8\u5427\u63A8\u8350","","click"),PageData.forum&&(e={fid:PageData.forum.id||PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.post(t.config.url.dolike,e,function(e){var a=!1;try{var o=e}catch(i){a=!0}if(!a)if(o&&0==o.no)Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid),t.isOfficial?_.Module.use("frs/widget/platform_attention_recommend",[{tbs:t.tbs,uid:t.uid,is_forum_fourth_manager:t.is_forum_fourth_manager,avatar:t.avatar}]):"\u6E38\u620F"==PageData.forum.first_class?_.Module.use("comforum/widget/attentionCategoryGame",["",!1,{index:o.data.ret.index,like_no:o.like_no}]):_.Module.use("ucenter/widget/LikeTip",["",!1,{index:o.data.ret.index,like_no:o.like_no},t.userForumList]),$.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=auto");else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+o.no);var s="";s=8==o.no||9==o.no?"\u4F60\u5728\u672C\u5427\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":220==o.no?"\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":221==o.no?"\u4F60\u5DF2like\u4E86\u672C\u5427,\u8BF7\u4E0D\u8981\u91CD\u590D\u64CD\u4F5C":"\u62B1\u6B49\uFF0C\u5F02\u5E38\u9519\u8BEF\uFF0C\u5EFA\u8BAE\u5237\u65B0\u9875\u9762\u91CD\u8BD5\u4E00\u4E0B",t._showAlert(s)}},"json")},_undolike:function(){var t=this,e=null;PageData.forum&&(e={fid:PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.tb.post(t.config.url.undolike,e,function(t){var e=!1;try{var a=t}catch(o){e=!0}e||a&&0==a.no&&$.tb.location.reload(!0)})}}});
;_.Module.define({path:"frs/widget/forum_card",sub:{initial:function(){try{this.delay=150,this.$title=$(".card_title_location"),this.$locations=$(".card_locations"),this.$num=$(".card_num"),this._resizeWidth(),this._handleEvent()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/forum_card_main.js",method:"",ln:17}),t}},localDisplay:function(){var t=this;return setTimeout(function(){t.$title.parent().addClass("card_title_location_wrapper_sel"),t.$num.addClass("card_num_fix"),t.$locations.removeClass("card_nor").addClass("card_sel")},t.delay)},localHidden:function(){var t=this;return setTimeout(function(){t.$title.parent().removeClass("card_title_location_wrapper_sel"),t.$num.removeClass("card_num_fix"),t.$locations.removeClass("card_sel").addClass("card_nor")},t.delay)},_handleEvent:function(){var t,e=this;this.$title.on("mouseenter",function(){clearTimeout(t),t=e.localDisplay()}).on("mouseleave",function(){clearTimeout(t),t=e.localHidden()}),this.$locations.on("mouseenter",function(){clearTimeout(t),t=e.localDisplay()}).on("mouseleave",function(){clearTimeout(t),t=e.localHidden()}),this.$locations.delegate("a","mousedown",function(){$.stats.sendRequest("fr=tb0_forum&st_mod=difangba&difangba_down")})},_resizeWidth:function(){var t=this.$locations.find("a").length;t=t%2===0?t:t+1;var e=t/2*60+20*(t/2-1)+15+"px";this.$locations.css("width",e)}}});_.Module.define({path:"pcommon/widget/myOftenForum",sub:{_wrapId:null,_jqWrap:null,_imgPostParams:null,oftengo_bubble:null,initial:function(e,t){this._wrapId=e,this._imgPostParams=t,this.oftenGoForum()},oftenGoForum:function(){var e=this._imgPostParams.user.user_forum_list?this._imgPostParams.user.user_forum_list.info:null,t=$("#often_forum"),n=this;if(t.length>0){var o=null,i=null;n.renderForumMenu(e);var a=n.j_menu;if(!a)return;t.click(function(){return n.fixedPosition(),t.addClass("btn_select"),a.slideDown(100),clearTimeout(o),!1}),PageData.is_ipad||(t.mouseenter(function(){return clearTimeout(i),"none"!=a.css("display")?!1:(o=setTimeout(function(){n.fixedPosition(),t.addClass("btn_select"),a.slideDown(100)},300),void 0)}),t.mouseleave(function(){clearTimeout(o),i=setTimeout(function(){t.removeClass("btn_select"),a.hide()},50)}),a.mouseenter(function(){clearTimeout(i)}),a.mouseleave(function(){i=setTimeout(function(){t.removeClass("btn_select"),a.hide()},50)})),a.find(".j_often_go_fname").mousedown(function(){if($.stats.hive("of_click"),$.stats.sendRequest("fr="+PageData.product+"&st_mod=oftenforum&st_type=forumclick&uid="+PageData.user.id),PageData&&PageData.forum&&PageData.product){if($(this).hasClass("ui_text_desc"))return;var e={st_mod:"nav_oftenforum_bar",st_type:"enterba",st_from:encodeURIComponent(PageData.product),st_uid:PageData.user.id,st_benba:encodeURIComponent(PageData.forum.name),st_goto:encodeURIComponent($(this).text())};$.tb.Stats.sendRequest("http://tb1.bdstatic.com/tb/img/hive.gif",e)}}),a.find(".j_often_go_more").mousedown(function(){$.stats.hive("of_more"),$.stats.sendRequest("fr="+PageData.product+"&st_mod=oftenforum&st_type=forummoreclick&uid="+PageData.user.id)})}},renderForumMenu:function(e){var t=this.genericForumMenu(e);if(t){{var n=$(t);$("#often_forum"),$("#"+this._wrapId)}$("body").append(n),this.j_menu=n}},genericForumMenu:function(e){if(e&&e.length>0){for(var t='<div id="nav_forum_menu" class="nav_forum_menu"><div class="n_menu_wrap clearfix"><ul class="n_menu_content clearfix">',n=PageData.is_ipad?"n_menu_item_ipad":"n_menu_item",o=0,i=e.length;i>o;o++){var a=e[o],s="";if(!(7>o||7==o&&8==i)){s='<li class="'+n+'"><a href="http://tieba.baidu.com/home/forum?id='+PageData.user.portrait+'&fr=tbnav" target="_blank" class="j_often_go_more nav_g_more">\u66F4\u591A&gt;&gt;</a></li>',t+=s;break}s='<li class="'+n+'"><a class="j_often_go_fname" title="'+a.forum_name+'" href="/f?ie=utf-8&kw='+encodeURIComponent(a.forum_name)+'" target="_blank">'+$.tb.subByte(a.forum_name,12,"..")+"</a></li>",t+=s}return t+='</ul></div> <div class="btn_inherit">&nbsp;</div></div>'}return null},fixedPosition:function(){var e=this.j_menu,t=$("#often_forum"),n=$("#"+this._wrapId);t.removeClass("btn_select"),n.addClass("nav_position");var o=(t.position(),t.offset()),i=n.height();n.removeClass("nav_position");var a=e.find("li.n_menu_item"),s=a.length;1==s?(a.width(94),e.width(111),e.find(".btn_inherit").css("left","0px"),e.css({top:o.top+i-14,left:o.left})):(e.find(".btn_inherit").css("left","80px"),e.css({top:o.top+i-14,left:o.left-t.width()+5}))}}});_.Module.define({path:"common/widget/frs_version",sub:{initial:function(){}}});_.Module.define({path:"common/widget/tbnav_bright/tbnav_search",requires:["common/widget/search_handler"],sub:{_searchHandler:null,_jq_wrap:null,_jq_input:null,_options:{forumName:""},initial:function(t,i){var n=this;this._searchHandler=this.requireInstance("common/widget/search_handler"),this._jq_wrap=t,this._jq_input=t.find(".j_search_internal_input"),this._options=$.extend(this._options,i),this._jq_wrap.submit(function(){return n._searchInternal(),!1}),this._initPlaceHolder()},_addJump:function(){$(".qiangzuo_trigger").length>0&&$(".qiangzuo_trigger").on("click",function(){window.open("/game/worldcup/index")})},_searchInternal:function(){var t=this._getSearchWord();this._searchHandler.searchPostInBa(t,this._options.forumName)},_getSearchWord:function(){return this._jq_input.val()},_initPlaceHolder:function(){var t=this,i=this._jq_wrap.find(".j_search_internal_placeholder"),n=this._jq_input;""!=t._getSearchWord()&&i.hide(),n.focus(function(){i.hide()}).blur(function(){""==t._getSearchWord()&&i.show()}),i.click(function(){n.focus()})}}}),_.Module.define({path:"common/widget/stockNav",requires:["common/widget/tbnav_bright/tbnav_search"],sub:{_jq_wrap:null,_nav_wrap:null,promotion_tmp:['<div id="activity_nav_promotion_enter">','<a href="#{link}" target="_blank">','<img src="#{img}">',"</a>","</div>"].join(""),initial:function(t,i,n){this._jq_wrap=t,this._nav_wrap=$("#tb_nav"),this.requireInstance("common/widget/tbnav_bright/tbnav_search",i.jq_search,i),this._bindNavDropDownList(),this._initStats(),this._initWanleTip(),n=n||{},this._initPromotionEnter(n.promotion_setting)},_bindNavDropDownList:function(){var t=this;this._nav_wrap.find(".j_tbnav_list").on("mouseenter",function(i){i.preventDefault();var n=$(i.currentTarget);n.addClass("nav_list_over"),t._nav_wrap.find(".j_nav_list").css("overflow","visible"),$("#star_class_nav").css("overflow","visible")}).on("mouseleave",function(t){t.preventDefault();var i=$(t.currentTarget);i.removeClass("nav_list_over")})},_initPromotionEnter:function(t){var i=$.getPageData("0.0",0,t),n=$.getPageData("1.0",0,t);if(!n||!i)return!1;var e=i.replace(/[\/,:,.,-]/g,"").substr(-30);if(1==$.tb.Storage.get("tbnavHideBarrageEnter_"+e))return!1;var a=$.tb.format(this.promotion_tmp,{link:n,img:i}),r=$(a);this._nav_wrap.find(".j_nav_list").append(r),$("#star_class_nav").append(r),$.stats.track("\u5BFC\u822A\u680F\u5C55\u793A","\u5206\u53D1\u5BFC\u822A\u680F\u63A8\u5E7F\u4F4D","","view"),r.on("click",function(){$.stats.track("\u5BFC\u822A\u680F\u8DF3\u8F6C","\u5206\u53D1\u5BFC\u822A\u680F\u63A8\u5E7F\u4F4D","","click"),$.tb.Storage.set("tbnavHideBarrageEnter_"+e,1)})},_initStats:function(){var t=this._nav_wrap.find(".j_nav_list"),i="\u5BFC\u822A\u680Ftab\u7EDF\u8BA1";t.find("a").on("click",function(){var t=$(this).text().split("\uFF08")[0];$.stats.track(t,i)})},_initWanleTip:function(){var t=PageUnit.load("tbnav_bright_wanle_type");if(1!=t)return!1;var i=new Date,n=i.getTime(),e=new Date(i.getTime()+864e5-1e3*(60*i.getHours()*60+60*i.getMinutes()+i.getSeconds())),a=$.cookie("wanleTipCircle");if(a){if(n>a+1728e5)return $.cookie("wanleTipCircle",0),void 0;if(0==a)return}else $.cookie("wanleTipCircle",n);var r=this._nav_wrap.find("#j_navtab_wanle");if(r.on("click",function(){$.stats.track("tab\u5BFC\u6D41","\u8D34\u5427PC\u76D6\u697C\u6D3B\u52A8","","click"),s.hide(),$.cookie("wanleTipHide",1,{expires:e})}),1!=$.cookie("wanleTipHide")){var o=['<div class="wanle_tab_tip">','<a class="jump_tip" href="/f?ie=utf-8&kw='+encodeURIComponent("\u4E50\u6B64\u4E0D\u75B2")+'" target="_self"></a>','<a class="close_tip" href="#" onclick="return false;"></a>',"</div>"].join(""),s=$(o);r.closest(".space").append(s),s.on("click","a",function(){s.hide(),$.cookie("wanleTipHide",1,{expires:e})}),s.on("click",".jump_tip",function(){$.stats.track("tab\u5BFC\u6D41","\u8D34\u5427PC\u76D6\u697C\u6D3B\u52A8","","click")})}}}});_.Module.define({path:"common/widget/tbnav_bright/tbnav_search",requires:["common/widget/search_handler"],sub:{_searchHandler:null,_jq_wrap:null,_jq_input:null,_options:{forumName:""},initial:function(t,i){var n=this;this._searchHandler=this.use("common/widget/search_handler"),this._jq_wrap=t,this._jq_input=t.find(".j_search_internal_input"),this._options=$.extend(this._options,i),this._jq_wrap.submit(function(){return n._searchInternal(),!1}),this._initPlaceHolder()},_addJump:function(){$(".qiangzuo_trigger").length>0&&$(".qiangzuo_trigger").on("click",function(){window.open("/game/worldcup/index")})},_searchInternal:function(){var t=this._getSearchWord();this._searchHandler.searchPostInBa(t,this._options.forumName)},_getSearchWord:function(){return this._jq_input.val()},_initPlaceHolder:function(){var t=this,i=this._jq_wrap.find(".j_search_internal_placeholder"),n=this._jq_input;""!=t._getSearchWord()&&i.hide(),n.focus(function(){i.hide()}).blur(function(){""==t._getSearchWord()&&i.show()}),i.click(function(){n.focus()})}}}),_.Module.define({path:"common/widget/tbnav_bright",requires:["common/widget/tbnav_bright/tbnav_search"],sub:{_jq_wrap:null,_nav_wrap:null,promotion_tmp:['<div id="activity_nav_promotion_enter">','<a href="#{link}" target="_blank">','<img src="#{img}">',"</a>","</div>"].join(""),initial:function(t,i,n){this._jq_wrap=t,this._nav_wrap=$("#tb_nav"),this.use("common/widget/tbnav_bright/tbnav_search",i.jq_search,i),this._bindNavDropDownList(),this._initStats(),this._initWanleTip(),n=n||{},this._initPromotionEnter(n.promotion_setting)},_bindNavDropDownList:function(){var t=this;this._nav_wrap.find(".j_tbnav_list").on("mouseenter",function(i){i.preventDefault();var n=$(i.currentTarget);n.addClass("nav_list_over"),t._nav_wrap.find(".j_nav_list").css("overflow","visible"),$("#star_class_nav").css("overflow","visible")}).on("mouseleave",function(t){t.preventDefault();var i=$(t.currentTarget);i.removeClass("nav_list_over")})},_initPromotionEnter:function(t){var i=$.getPageData("0.0",0,t),n=$.getPageData("1.0",0,t);if(!n||!i)return!1;var e=i.replace(/[\/,:,.,-]/g,"").substr(-30);if(1==$.tb.Storage.get("tbnavHideBarrageEnter_"+e))return!1;var a=$.tb.format(this.promotion_tmp,{link:n,img:i}),r=$(a);this._nav_wrap.find(".j_nav_list").append(r),$("#star_class_nav").append(r),$.stats.track("\u5BFC\u822A\u680F\u5C55\u793A","\u5206\u53D1\u5BFC\u822A\u680F\u63A8\u5E7F\u4F4D","","view"),r.on("click",function(){$.stats.track("\u5BFC\u822A\u680F\u8DF3\u8F6C","\u5206\u53D1\u5BFC\u822A\u680F\u63A8\u5E7F\u4F4D","","click"),$.tb.Storage.set("tbnavHideBarrageEnter_"+e,1)})},_initStats:function(){var t=this._nav_wrap.find(".j_nav_list"),i="\u5BFC\u822A\u680Ftab\u7EDF\u8BA1";t.find("a").on("click",function(){var t=$(this).text().split("\uFF08")[0];$.stats.track(t,i)})},_initWanleTip:function(){var t=PageUnit.load("tbnav_bright_wanle_type");if(1!=t)return!1;var i=new Date,n=i.getTime(),e=new Date(i.getTime()+864e5-1e3*(60*i.getHours()*60+60*i.getMinutes()+i.getSeconds())),a=$.cookie("wanleTipCircle");if(a){if(n>a+1728e5)return $.cookie("wanleTipCircle",0),void 0;if(0==a)return}else $.cookie("wanleTipCircle",n);var r=this._nav_wrap.find("#j_navtab_wanle");if(r.on("click",function(){$.stats.track("tab\u5BFC\u6D41","\u8D34\u5427PC\u76D6\u697C\u6D3B\u52A8","","click"),s.hide(),$.cookie("wanleTipHide",1,{expires:e})}),1!=$.cookie("wanleTipHide")){var o=['<div class="wanle_tab_tip">','<a class="jump_tip" href="/f?ie=utf-8&kw='+encodeURIComponent("\u4E50\u6B64\u4E0D\u75B2")+'" target="_self"></a>','<a class="close_tip" href="#" onclick="return false;"></a>',"</div>"].join(""),s=$(o);r.closest(".space").append(s),s.on("click","a",function(){s.hide(),$.cookie("wanleTipHide",1,{expires:e})}),s.on("click",".jump_tip",function(){$.stats.track("tab\u5BFC\u6D41","\u8D34\u5427PC\u76D6\u697C\u6D3B\u52A8","","click")})}}}});_.Module.define({path:"pb/component/Pager",sub:{initial:function(e,t){try{this.jumpPage=$("#"+t),this.jump(e),this.bindPageNum(e),this.pagerWrap=$("#"+e),this.pageCheckLogin()}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:component/pager/pager.js",method:"",ln:15}),a}},jump:function(e){var t=this.jumpPage.tbattr("theme"),a=$("#pager_go"+t),n=this;this.jumpPage.bind("keydown",function(t){n._go(t,e)}),a.click(function(){try{n._go("click",e)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:component/pager/pager.js",method:"",ln:30}),t}})},_go:function(e,t){var a=this.jumpPage;totalPage=a.tbattr("max-page"),inPageNum=a.val(),("click"===e||13===e.keyCode)&&(/^(-?)(\d+)$/.test(inPageNum)?(inPageNum=Math.max(1,Math.min(inPageNum,totalPage)),this.sendRequest("pb_jump_page",t),this.jumpToPage(inPageNum)):a.val(""))},jumpToPage:function(e){var t=$.tb.location.getHref(),a=t.indexOf("#");a>=0&&(t=t.substr(0,a)),-1==t.indexOf("pn")?t+=-1==t.indexOf("?")?"?pn="+e:t.indexOf("?")==t.toString().length-1?"pn="+e:"&pn="+e:t=t.replace(/(.*pn=)(\d+)?/,function(t,a){return a+""+e}),t.length>0&&(PageData.user.is_login?$.tb.location.setHref(t):window.open("/f/user/passport?jumpUrl="+t+"&statsInfo=pb_pager#login_anchor"))},bindPageNum:function(e){var t=this;$("#"+e).delegate("a","mousedown",function(){return $(this).hasClass("pager_disabled")?!1:(t.sendRequest("pb_fanye_page",e),void 0)})},sendRequest:function(e,t){$.tb.Stats.sendRequest("http://tb1.bdstatic.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"pb",st_type:e,st_value:t})},pageCheckLogin:function(){var e=this;e.pagerWrap.find(".l_pager a").on("click",function(){try{if(PageData.user.is_login)return;var e="http://tieba.baidu.com"+$.tb.unescapeHTML($(this).tbattr("href"));return window.open("/f/user/passport?jumpUrl="+e+"&statsInfo=pb_pager#login_anchor"),!1}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:component/pager/pager.js",method:"",ln:106}),t}})}}});var bds_config={snsKey:{tsina:"2285628874",tqq:"801209366"}};document.getElementById("bdshell_js").src="http://share.baidu.com/static/js/shell_v2.js?t="+(new Date).getHours();_.Module.define({path:"common/widget/verifyManagerPhone",requires:[],sub:{_hasNextTimeButton:null,_template:{_confirmDialog:["<h2>","#{title}","</h2>","<p>","#{text}","</p>"].join(""),_changeBind:["<div>* \u5982\u60A8\u9700\u8981\u6362\u7ED1\u60A8\u7684\u624B\u673A\u540E\u518D\u8FDB\u884C\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C\u8BF7<a target='_blank' href='#{href}'>\u70B9\u6B64\u6362\u7ED1</a>\u3002</div>"].join(""),_complain:["<div>* \u5982\u679C\u60A8\u7533\u8BC9\u8FC7\u7A0B\u4E2D\u51FA\u73B0\u95EE\u9898\u5BFC\u81F4\u65E0\u6CD5\u9A8C\u8BC1\uFF0C\u8BF7<a target='_blank' href='#{href}'>\u70B9\u6B64\u4E13\u8D34</a>\u53CD\u9988\u3002</div>"].join("")},_url:{nextTime:"/bawu2/checkphone/commitActsctrl",getPopPassData:"/bawu2/checkphone/getPhoneToken",verifyDone:"/bawu2/checkphone/commitCheckTime"},initial:function(t){var e=this;e._hasNextTimeButton=!t,e._title=null,e._text=null,t?(e._title="\u5C0A\u656C\u7684\u8D34\u5427\u5427\u4E3B\u7528\u6237",e._text="\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u60A8\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C<br/>\u4EE5\u9632\u8D26\u53F7\u88AB\u76D7\u9020\u6210\u635F\u5931\u3002<span class='verify_manager_phone_tip_strong'>\uFF08\u8BBE\u7F6E\u6210\u529F\u540E\u4E0D\u518D\u63D0\u793A\uFF09</span>"):(e._title="\u5C0A\u656C\u7684\u8D34\u5427\u5427\u4E3B\u7528\u6237\uFF1A",e._text="\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u60A8\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C<br/>\u4EE5\u9632\u8D26\u53F7\u88AB\u76D7\u9020\u6210\u635F\u5931\u3002<span class='verify_manager_phone_tip_strong'>\uFF08\u8BBE\u7F6E\u6210\u529F\u540E\u4E0D\u518D\u63D0\u793A\uFF09</span>"),e._popConfirmDialog()},_startVerify:function(){var t=this;t._getPopPassData(function(e){t._popPassDialog(e.hasBind?"verify":"bind",e.token)},function(){t._onVerifyFail()})},_onVerifyFail:function(t){var e=this;t||(t="\u9A8C\u8BC1\u5931\u8D25~ T_T \u8BF7\u91CD\u8BD5~~");var n={message:"<h2>\u9A8C\u8BC1\u624B\u673A\u5931\u8D25\uFF1A</h2><p>"+t+"</p>",holderClassName:"verify_manager_phone_dialog",buttons:[{text:"\u91CD\u8BD5",callback:function(){e._startVerify()}},{text:"\u53D6\u6D88"}]};n.buttons[0]["class"]="ui_btn_m btn_left",n.buttons[1]["class"]="ui_btn_sub_m",$.tb.alert(n)},_popConfirmDialog:function(){function t(){n._startVerify()}function e(){n._informServerNextTime()}var n=this,a={text:"\u4E0B\u6B21\u518D\u8BF4",callback:e};a["class"]="ui_btn_sub_m";var i={text:"\u7ACB\u5373\u8BBE\u7F6E",callback:t};i["class"]="ui_btn_m btn_left";var o=[i];n._hasNextTimeButton&&o.push(a),$.tb.alert({message:$.tb.format(n._template._confirmDialog,{title:n._title,text:n._text}),holderClassName:"verify_manager_phone_dialog",buttons:o})},_getPopPassData:function(t,e){var n=this;$.ajax({url:n._url.getPopPassData,dataType:"json",success:function(n){n&&0===n.errno?t(n.data):e()},error:e})},_popPassDialog:function(t,e){function n(t){o._informServerVerifyDone(t)}function a(){o._informServerVerifyDone()}function i(){o._onVerifyFail()}var o=this;"verify"===t?o._showMobileVerify(e,a,i):o._showMobileBind(e,n,i)},_showMobileVerify:function(t,e,n){var a=this;$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_forceverify_wrapper.js?cdnversion="+a._getTimeStamp(),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+a._getTimeStamp()],function(){var i=window.passport.pop.initForceverify({token:t,curType:"mobile",onRender:function(){var t=this,e=$(t.getById("content")),n=e.find(".footer-tip");a._updatePassDialogZIndex(t);var i=$($.tb.format(a._template._changeBind,{href:"http://passport.baidu.com/v2/accountsecurity?act=rebindmobile"}));n.prepend(i);var o=$($.tb.format(a._template._complain,{href:"http://tieba.baidu.com/p/3472422906"}));n.prepend(o);var r=n.html(),s=r.lastIndexOf("<br>");n.html(r.substring(0,s))},onSubmitSuccess:e,onGetapiError:n,onSubmitFailure:n});i.show()},!0,"utf-8")},_showMobileBind:function(t,e,n){var a=this;$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_armorwidget_wrapper.js?cdnversion="+a._getTimeStamp(),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+a._getTimeStamp()],function(){var i=window.passport.pop.ArmorWidget("bindmobile",{token:t,onRender:function(){var t=this,e=$(t.getById("content")),n=e.find(".footer-tip");a._updatePassDialogZIndex(this);var i=$($.tb.format(a._template._complain,{href:"http://tieba.baidu.com/p/3472422906"}));n.prepend(i);var o=n.html(),r=o.lastIndexOf("<br>");n.html(o.substring(0,r))},successCountdown:0,onSubmitSuccess:function(t){e(t.bindid)},onInitFail:n,otherValue:{tpl:"tb"}});i.show()},!0,"utf-8")},_informServerNextTime:function(){var t=this;$.ajax(t._url.nextTime)},_informServerVerifyDone:function(t){var e=this,n=function(){$.tb.alert({message:"<h2>\u8BBE\u7F6E\u6210\u529F\uFF01</h2>",holderClassName:"verify_manager_phone_dialog",onclose:function(){location.reload()},buttons:[{text:"\u786E\u8BA4"}]})},a=function(){e._onVerifyFail()},i=e._url.verifyDone;t&&(i+="?bindid="+t),$.ajax({url:i,dataType:"json",success:function(t){t&&0===t.errno?n():a()},error:a})},_getTimeStamp:function(){var t=(new Date).getTime();return Math.floor(t/6e4)},_updatePassDialogZIndex:function(t){var e=$(t.getById("mask")),n=$(t.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),n.css("zIndex",5e4+parseInt(n.css("zIndex")))}}});!function(){var e=!1;_.Module.define({path:"common/widget/detectManagerBlock",requires:["common/widget/verifyManagerPhone"],sub:{initial:function(){},setBlockState:function(n){e=n},getBlockState:function(){return e},doOnNotBlocked:function(n,o){void 0===o&&(o=!0),e?o&&this.requireInstance("common/widget/verifyManagerPhone",[!0]):n()},doOnBlocked:function(n){e&&n()}}})}();_.Module.define({path:"common/widget/blockUser",requires:["common/widget/detectManagerBlock"],sub:{template:'<div class="block_user_wrapper"> <ul class="b_u_items">   <li class="b_u_items_outer">  <label>\u7528\u6237\u540D</label><div class="b_username" ></div> </li>  <li class="b_u_items_outer">    <label>\u5C01\u7981\u65F6\u957F:</label>  <div class="b_block_time"> <span class="b_fixed_time">1\u5929</span>   <select class="b_select_time"> <option data-info="1">1\u5929</option> <option data-info="3">3\u5929</option><option data-info="10">10\u5929</option>  </select>  </div>   </li>  <li class="b_u_items_outer"> <label>\u5C01\u7981\u539F\u56E0:</label> <div class="b_reason_box"><ul class="b_reason_ul">   <li class="b_reason_item" data-prefix="1."></li><li class="b_reason_item" data-prefix="2."></li> <li class="b_reason_item" data-prefix="3."></li>  <li class="b_reason_item" data-prefix="4."></li>  <li class="b_reason_item" data-prefix="5."></li> <li class="b_reason_item" data-prefix="6."></li>  </ul><div class="b_reason_content">    <div class="b_reason_top">   <div class="b_top_mod_bar" > <div class="b_mod_bar"><span></span>\u4FEE\u6539</div>  <div class="b_del_bar"><span></span>\u5220\u9664</div>   </div><div class="b_top_save_bar">  <div class="b_save_bar"><span></span>\u4FDD\u5B58</div> <div class="b_cancel_bar"><span></span>\u53D6\u6D88</div></div>     </div>   <div class="b_reason_textarea">  <label for="b_user_textarea" class="b_label_tips">\u62B1\u6B49\uFF0C\u4F60\u7684\u53D1\u8D34\u64CD\u4F5C\u6216\u53D1\u8868\u8D34\u5B50\u7684\u5185\u5BB9\u8FDD\u53CD\u4E86\u672C\u5427\u7684\u5427\u89C4\uFF0C\u5DF2\u7ECF\u88AB\u5C01\u7981\uFF0C\u5C01\u7981\u671F\u95F4\u4E0D\u80FD\u5728\u672C\u5427\u7EE7\u7EED\u53D1\u8A00\u3002</label><textarea id="b_user_textarea" class="b_textarea"></textarea>      </div>    </div>   </div>   </li>   </ul>   <div class="block_btns">  <div class="block_tips"></div> <div class="b_id_btn">\u5C01\u7981ID</div> <div class="b_fixed_tips"></div>  </div> </div>',errTemplate:'<div class="block_response_info"></div> ',initial:function(e,t,a,o,n){var i=this,s=i.requireInstance("common/widget/detectManagerBlock",[]);s.doOnNotBlocked(function(){i._block(e,t,a,o,n)})},_block:function(e,t,a,o,n){this.config={block_reason_list:"/pmc/tpl",add_block_reason:"/pmc/tpl",modify_block_reason:"/pmc/tpl",del_block_reason:"/pmc/tpl",save_block_id:"/pmc/blockid"},this.blockList=$.extend(!0,[],e),this.power=t,this.forum=a,this.tbs=o,this.sucCallback=n,this.user_num=this.blockList.length,this.add_new_temp="<span>+</span>\u65B0\u5EFA\u6A21\u677F",this.textarea_maxlength=200,this.curr_pattern="",this.$blockPopWinHtml=$(this.template),this.$responseBlockInfo=$(this.errTemplate),this.paramValidate(),this.setBlockDefaultInfo(),this.textareaKeyupEvtBind(),this.blockIDbtnEvtBind(),this.tabSwitchEvtBind(),this.textareaFocusEvtBind(),this.textareaBlurEvtBind(),this.logicalControl(),this.blockDialog.show(),this.trigger("show")},duplicateRemoval:function(e){for(var t={},a=[],o=e.length,n=0;o>n;n++)t[e[n]]||(a.push(e[n]),t[e[n]]=!0);return a},paramValidate:function(){var e=this;null===e.power.ban_id||null===e.power.ban_ip||""===e.power.ban_id||""===e.power.ban_ip?(this.blockDialog=new $.dialog({title:"\u5C01\u7981\u63D0\u793A",width:"556",html:this.$responseBlockInfo}),e.$responseBlockInfo.find(".block_response_info").html("\u4F60\u6CA1\u6709\u5C01\u7981\u64CD\u4F5C\u6743\u9650\uFF01")):e.blockDialog=new $.dialog({title:"\u5C01\u7981\u64CD\u4F5C",width:"556",html:this.$blockPopWinHtml}),e.blockDialog.bind("onclose",function(){e.user_num>1&&$.tb.location.reload()}),e.blockDialog.bind("onhide",function(){e.user_num>1&&$.tb.location.reload()})},insertDefaultNewTemp:function(){var e=this,t=0,a=0,o=!1;if($(".b_reason_ul .b_reason_item").each(function(e,o){$(o).hasClass("b_add_new_reason")||($(o).data("reasonId")&&""!=$(o).data("reasonId")&&$(o).data("isBuiltinTpl")===!1&&t++,a++)}),6>t){$(".b_reason_ul .b_reason_item").each(function(t,n){o&&$(".b_reason_ul .b_reason_item").eq(t).remove(),""!==$(n).html().trim()||o||($(n).tbattr("data-is-builtin-tpl",!1).tbattr("data-prefix",a),$(n).addClass("b_add_new_reason").append(e.add_new_temp),o=!0)});var n=$(".b_reason_ul .b_add_new_reason").length;0==n&&$(".b_reason_ul").append('<li class="b_reason_item b_add_new_reason" data-is-builtin-tpl="false" data-prefix="'+(a+1)+'.">'+e.add_new_temp+"</li>")}},setTextareaVal:function(){var e=this;0!=e.$blockPopWinHtml.find(".b_reason_curr").length||e.$blockPopWinHtml.find(".b_reason_item").eq(0).hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr");var t=e.$blockPopWinHtml.find(".b_reason_curr");if(t.hasClass("b_add_new_reason"))e.$blockPopWinHtml.find(".b_textarea").val("");else if(t.html()){var a=t.html(),o=2;t.data("prefix")>=10&&(o=3),e.$blockPopWinHtml.find(".b_textarea").val(a.substr(o,a.length))}},noReasonCantModify:function(){var e=0,t=this;t.$blockPopWinHtml.find(".b_reason_item").each(function(t,a){"undefined"!=typeof $(a).tbattr("data-reason-id")&&e++}),0==e&&(t.$blockPopWinHtml.find(".b_add_new_reason").removeClass("b_reason_curr"),t.$blockPopWinHtml.find(".b_reason_top").hide(),""==t.$blockPopWinHtml.find(".b_textarea").val()&&t.$blockPopWinHtml.find(".b_label_tips").show())},setBlockReasonList:function(){var e=this,t=!1;$.ajax({url:e.config.block_reason_list,type:"POST",dataType:"json",data:{fid:e.forum.forum_id,tbs:e.tbs},success:function(a){if("0"==a.errno){var o=a.data;if(0==o.length)e.$blockPopWinHtml.find(".b_label_tips").show(),e.$blockPopWinHtml.find(".b_textarea").val(""),e.noReasonCantModify(),e.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){$(t).removeAttr("data-reason-id").html("")}),e.$blockPopWinHtml.find(".b_reason_item").removeClass("b_reason_curr");else{var n=e.$blockPopWinHtml.find(".b_reason_item").length,i=o.length,s=i-n;if(s>0){for(var l=n,r="";s>0;)r+='<li class="b_reason_item" data-prefix="'+(l+1)+'." ></li>',l++,s--;$(".b_reason_ul").append(r)}e.$blockPopWinHtml.find(".b_reason_item").each(function(a,n){0==a&&(e.curr_pattern="undefined"!=typeof o[a]?"modify":"add"),"undefined"!=typeof o[a]?$(n).html(a+1+"."+o[a].template_text).tbattr("data-reason-id",o[a].template_id).tbattr("data-is-builtin-tpl",o[a].is_builtin_tpl).tbattr("data-prefix",a+1):$(n).html(""),$(n).hasClass("b_add_new_reason")&&!t&&($(n).removeClass("b_add_new_reason"),t=!0)}),e.$blockPopWinHtml.find(".b_reason_item").each(function(t,a){""==$(a).html()&&e.$blockPopWinHtml.find(".b_reason_item").eq(t).remove(),$(a).hasClass("b_reason_curr")&&($(a).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show())})}(e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip)&&e.insertDefaultNewTemp(),e.setTextareaVal()}else e.setResponseTips(2,"\u83B7\u53D6\u5C01\u7981\u539F\u56E0\u5217\u8868\u5931\u8D25!")},error:function(t){e.setNewDialogRespTips(2,t)}})},setBlockDefaultInfo:function(){for(var e=this,t=[],a=0;a<e.blockList.length;++a)-1===$.inArray(e.blockList[a].username,t)&&t.push(e.blockList[a].username);t=t.join(),e.$blockPopWinHtml.find(".b_username").html($.tb.subByte(t,30,"\u2026")),e.setBlockReasonList()},textareaKeyupEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_textarea").on("keyup",function(){var t=$(this).val(),a=$.tb.getByteLength(t),o=e.$blockPopWinHtml.find(".block_tips");o.css({display:"block"}),e.textarea_maxlength-a>0?($(this).hasClass("input_right_pattern")||$(this).addClass("input_right_pattern"),$(this).removeClass("input_error_pattern"),o.html("\u8FD8\u53EF\u8F93\u5165"+parseInt((e.textarea_maxlength-a)/2)+"\u5B57").addClass("b_green")):($(this).hasClass("input_error_pattern")||$(this).addClass("input_error_pattern"),$(this).removeClass("input_right_pattern"),o.removeClass("b_green").addClass("b_red").html("\u5DF2\u8D85\u51FA"+parseInt(parseInt((a-e.textarea_maxlength)/2)+1)+"\u5B57"))})},textareaFocusEvtBind:function(){var e=this;e.$blockPopWinHtml.on("focus.showEditor",".b_textarea",function(){e.curr_pattern="add",e.toogleToolBar(),e.$blockPopWinHtml.find(".block_tips").html("").removeClass("b_red,b_green"),e.$blockPopWinHtml.find(".b_label_tips").css({display:"none"}),e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?e.$blockPopWinHtml.find(".b_reason_top").show():e.$blockPopWinHtml.find(".b_reason_top").hide()})},textareaBlurEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",function(t){var a=$(t.target);if(0==a.closest(".b_reason_box").length){e.curr_pattern="modify",e.toogleToolBar(),0==e.$blockPopWinHtml.find(".b_reason_curr").length&&e.$blockPopWinHtml.find(".b_reason_top").hide();var o="undefined"==e.power.can_filter_id?!e.power.ban_id||!e.power.ban_ip:!e.power.can_filter_id||!e.power.can_filter_ip;o&&(""==e.$blockPopWinHtml.find(".b_textarea").val()?e.$blockPopWinHtml.find(".b_label_tips").show():e.$blockPopWinHtml.find(".b_label_tips").hide()),e.$blockPopWinHtml.find(".block_tips").html(""),e.noReasonCantModify()}})},modifyTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_mod_bar").on("click",function(){e.$blockPopWinHtml.find(".b_textarea").trigger("focus")})},deleteTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_del_bar").on("click",function(){if("undefined"==typeof e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")||e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_curr").data("isBuiltinTpl"))return!1;var t={op:"del",id:e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id"),fid:e.forum.forum_id,tbs:e.tbs};$.ajax({url:e.config.del_block_reason,type:"POST",dataType:"json",data:t,success:function(t){"0"==t.errno?(e.$blockPopWinHtml.find(".b_reason_curr").removeAttr("data-reason-id"),e.setBlockReasonList(),e.setResponseTips(1,"\u5220\u9664\u6210\u529F\uFF01")):e.setResponseTips(2,"\u5220\u9664\u5931\u8D25!")},error:function(t){e.setNewDialogRespTips(2,t)}})})},toogleToolBar:function(){var e=this;e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?(e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),"modify"==this.curr_pattern?(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"block"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"none"})):"add"==this.curr_pattern&&(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"none"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"block"}))):e.$blockPopWinHtml.find(".b_reason_top").css({display:"none"})},saveTextareaCon:function(){var e,t=this,a={},o=t.$blockPopWinHtml.find(".b_textarea");t.$blockPopWinHtml.find(".b_save_bar").on("click",function(){if(!t.checkCanbeBlocked())return!1;var n=t.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||0==t.$blockPopWinHtml.find(".b_reason_curr").length;n?(a={op:"add",tbs:t.tbs,fid:t.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(o.val())},e=t.config.add_block_reason):(a={op:"update",tbs:t.tbs,fid:t.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(t.$blockPopWinHtml.find(".b_textarea").val()),id:t.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")},e=t.config.modify_block_reason),$.ajax({url:e,type:"POST",dataType:"json",data:a,success:function(e){t.curr_pattern="modify",t.toogleToolBar(),"0"==e.errno?(t.setBlockReasonList(),t.setResponseTips(1,"\u4FDD\u5B58\u6210\u529F\uFF01"),n?$.stats.track("AddReasonItem","uegCount","bawuAppeal","success"):$.stats.track("modifyReasonItem"+$(".b_reason_curr").index(),"uegCount","bawuAppeal","success")):t.setResponseTips(2,"\u4FDD\u5B58\u5931\u8D25!")},error:function(e){t.setNewDialogRespTips(2,e)}})})},cancelTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_cancel_bar").on("click",function(){e.setTextareaVal(),e.curr_pattern="modify",e.toogleToolBar(),e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")&&e.$blockPopWinHtml.find(".b_reason_item").siblings().removeClass("b_reason_curr").end().eq(0).addClass("b_reason_curr")})},getSavesData:function(e){var t=this,a={};a.day="block"===t.$blockPopWinHtml.find(".b_fixed_time").css("display")?"1":t.$blockPopWinHtml.find(".b_select_time").find("option:selected").tbattr("data-info"),a.fid=t.forum.forum_id,a.tbs=t.tbs,a.ie="gbk",a.user_name=[],a.pid=[];for(var o=0;o<t.blockList.length;++o){var n=t.blockList[o];-1===$.inArray(n.username,a.user_name)&&a.user_name.push($.tb.escapeHTML(n.username)),n.pid&&a.pid.push(n.pid)}var i=t.$blockPopWinHtml.find(".b_textarea"),s=0;return t.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){"undefined"==typeof $(t).tbattr("data-reason-id")&&s++}),a.reason=6==s&&""===i.val().trim()?t.$blockPopWinHtml.find(".b_label_tips").html():t.$blockPopWinHtml.find(".b_textarea").val(),a.reason=$.tb.escapeHTML(a.reason),2===e&&(a.ip="1"),a},checkCanbeBlocked:function(){var e=this,t=e.$blockPopWinHtml.find(".b_textarea"),a=0;return t.hasClass("input_error_pattern")||""===t.val().trim()?(e.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){"undefined"==typeof $(t).tbattr("data-reason-id")&&a++}),6==a?!0:(e.$blockPopWinHtml.find(".b_textarea").trigger("focus"),t.hasClass("input_error_pattern")?e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u8D85\u51FA100\u5B57"):e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"),!1)):!0},blockIDbtnEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_id_btn").on("click",function(){if(!e.checkCanbeBlocked())return!1;var t=e.getSavesData(1),a=function(o){t=o?$.extend(t,o):t,$.ajax({url:e.config.save_block_id,type:"POST",dataType:"json",data:t,success:function(t){"0"==t.errno?(e.setNewDialogRespTips(1,"\u5C01\u7981\u6210\u529F\uFF01"),(e.sucCallback||"function"==typeof e.sucCallback)&&e.sucCallback()):224011==t.errno?e.getCaptcha(t,a,e):e.setNewDialogRespTips(2,"\u5C01\u7981\u5931\u8D25\uFF01")},error:function(t){e.setNewDialogRespTips(2,t)}})};a()})},getCaptcha:function(e,t,a){var o=this;a=a||o;var n=PageData.forum_name||(PageData.forum?PageData.forum.forum_name:""),i=PageData.forum_id||(PageData.forum?PageData.forum.forum_id:"");this.requireInstanceAsync("common/component/CaptchaDialog",[{title:"\u5C01\u7981",message:"\u5C01\u7981\u4E86\u90A3\u4E48\u591A\u4EBA\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.res.captcha_vcode_str,vCodeType:e.res.captcha_code_type,forumName:n,forumId:i,postType:"thread",paramsCallback:function(){return{}}}],function(e){o.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var o={vcode:e.getInputValue(),vcode_md5:e.getVCode()};t.call(a,o)}),e.show()})},setResponseTips:function(e,t){var a=this,o=a.$blockPopWinHtml.find(".block_tips");1==e?o.removeClass("b_red").addClass("b_green").html(t):o.removeClass("b_green").addClass("b_red").html(t),window.setTimeout(function(){o.hasClass("b_green")&&o.html("")},2e3)},setNewDialogRespTips:function(e,t){var a=this,o=a.$blockPopWinHtml;o.html(a.$responseBlockInfo),1==e?o.find(".block_response_info").removeClass("b_red").addClass("b_green").html(t):o.find(".block_response_info").removeClass("b_green").addClass("b_red").html(t),window.setTimeout(function(){a.blockDialog.hide(),a.user_num>1&&$.tb.location.reload(),a.trigger("hide")},2e3)},tabSwitchEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",".b_reason_item",function(){return $(this).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show(),"undefined"!=typeof $(this).tbattr("data-reason-id")||$(this).hasClass("b_add_new_reason")?("none"==e.$blockPopWinHtml.find(".b_reason_top").css("display")&&e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),$(this).siblings(".b_reason_item").removeClass("b_reason_curr").end().addClass("b_reason_curr"),$(this).hasClass("b_add_new_reason")?(e.curr_pattern="add",e.$blockPopWinHtml.find(".b_textarea").trigger("focus")):(e.curr_pattern="modify",$.stats.track("reasonItem"+$(this).index(),"uegCount","bawuAppeal","click")),e.setTextareaVal(),e.toogleToolBar(),void 0):!1})},logicalControl:function(){var e=this,t=e.$blockPopWinHtml.find(".b_fixed_time"),a=e.$blockPopWinHtml.find(".b_select_time");e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr"),e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?(e.$blockPopWinHtml.find(".b_fixed_tips").html("\u63D0\u793A\uFF1A\u5927\u5427\u4E3B\u53EF\u7F16\u8F91\u539F\u56E0\u6A21\u7248\uFF0C\u4FDD\u5B58\u540E\u5C0F\u5427\u4E3B\u53EF\u76F4\u63A5\u4F7F\u7528\u6587\u6848~"),e.user_num>1?(t.css({display:"block"}),a.css({display:"none"})):1==e.user_num&&(t.css({display:"none"}),a.css({display:"block"})),e.$blockPopWinHtml.find(".b_reason_top,.b_top_mod_bar").css({display:"block"}),e.modifyTextareaCon(),e.deleteTextareaCon(),e.saveTextareaCon(),e.cancelTextareaCon()):(e.$blockPopWinHtml.find(".b_fixed_tips").html("\u63D0\u793A\uFF1A\u539F\u56E0\u6A21\u7248\u53EA\u6709\u5927\u5427\u4E3B\u53EF\u4EE5\u7F16\u8F91\uFF0C\u5C0F\u5427\u4E3B\u4E5F\u53EF\u76F4\u63A5\u5728\u8F93\u5165\u6846\u4E2D\u5199\u4E0A\u5185\u5BB9\u5E76\u5B8C\u6210\u5C01\u7981~"),t.css({display:"block"}),a.css({display:"none"}))}}});F.module("common/widget/paypost_data",function(n,t){var e={},o=null,u=function(){};u.prototype={set:function(n,t){return e[n]=t,!0},get:function(n){return e[n]?e[n]:null}},u.getInstance=function(){return o||(o=new u),o},t.getInstance=u.getInstance},[]);_.Module.define({path:"encourage/widget/paypost_agree_dialog",require:["common/widget/paypost_data"],sub:{dialog:null,nextFnStack:[],tpl:["<div>","<h3>\u8D34\u5427\u201C\u4ED8\u8D39\u53EF\u89C1\u201D\u529F\u80FD\u7528\u6237\u4F7F\u7528\u534F\u8BAE</h3>",'<div class="scroll_section">',"<ul>","<li><b>\u3010\u9996\u90E8\u53CA\u5BFC\u9009\u3011</b></li>","<li>\u4EFB\u4F55\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u53D1\u8D34\u548C\u6D4F\u89C8\u7528\u6237\uFF08\u4EE5\u4E0B\u7EDF\u79F0\u4E3A\u201C\u60A8\u201D\uFF09\u5747\u5E94\u4ED4\u7EC6\u9605\u8BFB\u987B\u77E5\uFF0C\u7528\u6237\u53D1\u8D34\u548C\u6D4F\u89C8\u7684\u884C\u4E3A\u5C06\u88AB\u89C6\u4E3A\u5BF9\u672C\u987B\u77E5\u5168\u90E8\u5185\u5BB9\u7684\u8BA4\u53EF\u3002\u672C\u987B\u77E5\u89C6\u4E3A\u300A\u767E\u5EA6\u514D\u8D23\u58F0\u660E\u300B\u3001\u300A\u8D34\u5427\u534F\u8BAE\u300B\u3001\u300A\u5427\u4E3B\u5236\u5EA6\u300B\u3001\u300AT\u8C46\u4F7F\u7528\u987B\u77E5\u300B\u7684\u8865\u5145\u89C4\u5B9A\uFF0C\u662F\u5176\u4E0D\u53EF\u5206\u5272\u7684\u7EC4\u6210\u90E8\u5206\uFF0C\u4E0E\u5176\u6784\u6210\u7EDF\u4E00\u6574\u4F53\u3002\u672C\u987B\u77E5\u4E0E\u4E0A\u8FF0\u5185\u5BB9\u5B58\u5728\u51B2\u7A81\u7684\uFF0C\u4EE5\u672C\u89C4\u5219\u4E3A\u51C6\u3002\u672C\u987B\u77E5\u5185\u5BB9\u540C\u65F6\u5305\u62EC\u767E\u5EA6\u53EF\u80FD\u4E0D\u65AD\u53D1\u8868\u7684\u5173\u4E8E\u672C\u987B\u77E5\u7684\u76F8\u5173\u89C4\u5219\u3001\u4E1A\u52A1\u89C4\u5219\u7B49\u5185\u5BB9\u3002\u4E0A\u8FF0\u5185\u5BB9\u4E00\u7ECF\u6B63\u5F0F\u53D1\u8868\uFF0C\u5373\u4E3A\u672C\u987B\u77E5\u4E0D\u53EF\u5206\u5272\u7684\u7EC4\u6210\u90E8\u5206\uFF0C\u60A8\u540C\u6837\u5E94\u5F53\u9075\u5B88\u3002</li>","<li><b>\u7B2C\u4E00\u7AE0 \u4EC0\u4E48\u662F\u8D34\u5B50\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u4EE5\u53CA\u5982\u4F55\u4F7F\u7528\u8D34\u5B50\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD</b></li>","<li>\u7528\u6237\u4E3A\u6D4F\u89C8\u4F18\u8D28\u5185\u5BB9\u800C\u5411\u8D34\u5427\u53D1\u8D34\u7528\u6237\u4ED8\u8D39\u7684\u529F\u80FD\u3002<br />\u60A8\u5728\u5427\u5185\u5347\u81F36\u7EA7\u5373\u53EF\u5F00\u542F\u8BE5\u529F\u80FD\uFF0C\u5728\u53D1\u8D34\u6846\u70B9\u51FB\u201C\u4ED8\u8D39\u53EF\u89C1\u201D\u6309\u94AE\u6253\u5F00\u4ED8\u8D39\u5185\u5BB9\u7F16\u8F91\u533A\uFF0C\u7F16\u8F91\u533A\u4E0A\u65B9\u6587\u672C\u6846\u8F93\u5165\u552E\u4EF7\uFF08\u5373\u51FA\u552E\u7684T\u8C46\u6570\uFF09\uFF0C\u7136\u540E\u5728\u4ED8\u8D39\u533A\u57DF\u548C\u6B63\u5E38\u533A\u57DF\u5206\u522B\u7F16\u8F91\u5B8C\u6210\u540E\u70B9\u51FB\u201C\u53D1\u8868\u201D\u5373\u53EF\u3002</li>","<li><b>\u7B2C\u4E8C\u7AE0 \u8D23\u4EFB\u6761\u6B3E</b></li>","<li>\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u521B\u9020\u7684\u5185\u5BB9\uFF0C\u5747\u6765\u81EA\u70ED\u5FC3\u7528\u6237\u7684\u79EF\u6781\u53D1\u8868\u3002\u767E\u5EA6\u81EA\u8EAB\u4E0D\u7F16\u8F91\u6216\u4FEE\u6539\u7528\u6237\u53D1\u8868\u7684\u5185\u5BB9\u3002\u5BF9\u4E8E\u7528\u6237\u5728\u4F7F\u7528\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u53D1\u8868\u5185\u5BB9\u7684\u771F\u5B9E\u6027\u5F15\u53D1\u7684\u5168\u90E8\u8D23\u4EFB\uFF0C\u7531\u7528\u6237\u81EA\u884C\u627F\u62C5\u3002\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u4E0D\u80FD\u4FB5\u72AF\u5305\u62EC\u4ED6\u4EBA\u7684\u8457\u4F5C\u6743\u5728\u5185\u7684\u77E5\u8BC6\u4EA7\u6743\u4EE5\u53CA\u5176\u4ED6\u6743\u5229\u3002\u4E00\u65E6\u7531\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u7684\u5185\u5BB9\u53D1\u751F\u6743\u5229\u7EA0\u7EB7\u6216\u4FB5\u72AF\u4E86\u4EFB\u4F55\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u76CA\uFF0C\u5176\u8D23\u4EFB\u7531\u7528\u6237\u672C\u4EBA\u627F\u62C5\uFF0C\u56E0\u6B64\u7ED9\u767E\u5EA6\u6216\u4EFB\u4F55\u7B2C\u4E09\u65B9\u9020\u6210\u635F\u5931\u7684\uFF0C\u7528\u6237\u5E94\u8D1F\u8D23\u5168\u989D\u8D54\u507F\u3002</li>","<li>\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u53EF\u4EE5\u4E3A\u4ECB\u7ECD\u3001\u8BC4\u8BBA\u3001\u7814\u7A76\u7B49\u76EE\u7684\uFF0C\u5728\u5408\u7406\u7684\u8303\u56F4\u5185\u9002\u5F53\u5F15\u7528\u4ED6\u4EBA\u5DF2\u7ECF\u53D1\u8868\u7684\u4F5C\u54C1\uFF0C\u4F46\u5E94\u5F53\u6CE8\u660E\u4F5C\u8005\u59D3\u540D\u3001\u4F5C\u54C1\u540D\u79F0\uFF0C\u5E76\u4E0D\u5F97\u4FB5\u72AF\u8457\u4F5C\u6743\u4EBA\u53CA\u5176\u4ED6\u6743\u5229\u4EBA\u7684\u5408\u6CD5\u6743\u76CA\u3002</li>","<li>\u7528\u6237\u627F\u8BFA\uFF1A\u5176\u5728\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u53D1\u8868\u7684\u6240\u6709\u5185\u5BB9\u7B26\u5408\u4E2D\u56FD\u6CD5\u5F8B\u6CD5\u89C4\u548C\u89C4\u8303\u6027\u6587\u4EF6\u7684\u76F8\u5173\u89C4\u5B9A\uFF0C\u4E0D\u4FB5\u72AF\u4EFB\u4F55\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u76CA\u3002\u5982\u7528\u6237\u8FDD\u53CD\u524D\u8FF0\u4FDD\u8BC1\uFF0C\u767E\u5EA6\u8D34\u5427\u6709\u6743\u5220\u9664\u76F8\u5173\u6587\u672C\u548C\u9644\u4EF6\u5185\u5BB9\uFF0C\u5E76\u53EF\u4EE5\u6682\u505C\u6216\u7EC8\u6B62\u5411\u8BE5\u7528\u6237\u63D0\u4F9B\u670D\u52A1\u3002\u5982\u56E0\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u53D1\u8868\u7684\u5185\u5BB9\u4FB5\u72AF\u4E86\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u5229\uFF0C\u7B2C\u4E09\u65B9\u5411\u767E\u5EA6\u63D0\u51FA\u5F02\u8BAE\uFF0C\u767E\u5EA6\u8D34\u5427\u6709\u6743\u5220\u9664\u76F8\u5173\u7684\u5185\u5BB9\u3002\u63D0\u51FA\u5F02\u8BAE\u8005\u548C\u5185\u5BB9\u53D1\u8868\u8005\u4E4B\u95F4\u7684\u76F8\u5173\u6CD5\u5F8B\u95EE\u9898\u5F97\u5230\u89E3\u51B3\u540E\uFF0C\u4EE5\u6B64\u4E3A\u4F9D\u636E\uFF0C\u5411\u767E\u5EA6\u8D34\u5427\u63D0\u51FA\u7533\u8BF7\uFF0C\u767E\u5EA6\u8D34\u5427\u53EF\u4EE5\u6062\u590D\u88AB\u5220\u9664\u7684\u5185\u5BB9\u3002\u5BF9\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u7684\u4EFB\u4F55\u5185\u5BB9\uFF0C\u7528\u6237\u540C\u610F\u767E\u5EA6\u5728\u5168\u4E16\u754C\u8303\u56F4\u5185\u4EAB\u6709\u514D\u8D39\u7684\u3001\u6C38\u4E45\u7684\u3001\u4E0D\u53EF\u64A4\u9500\u7684\u3001\u975E\u6392\u4ED6\u6027\u7684\u4F7F\u7528\u548C\u518D\u8BB8\u53EF\u7684\u6743\u5229\u3002\u767E\u5EA6\u4EAB\u6709\u4FEE\u6539\u3001\u590D\u5236\u3001\u53D1\u884C\u3001\u8868\u6F14\u3001\u5C55\u89C8\u3001\u4FE1\u606F\u7F51\u7EDC\u4F20\u64AD\u3001\u6539\u7F16\u3001\u7FFB\u8BD1\u3001\u6C47\u7F16\u7B49\u6743\u5229\u3002\u540C\u65F6\uFF0C\u5BF9\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u5185\u5BB9\u7684\u4FB5\u6743\u884C\u4E3A\uFF0C\u7528\u6237\u6388\u6743\u767E\u5EA6\u5728\u5168\u4E16\u754C\u8303\u56F4\u5185\u8FDB\u884C\u7EF4\u6743\u3002</li>","<li><b>\u7B2C\u4E09\u7AE0 \u672C\u987B\u77E5\u9879\u4E0B\u670D\u52A1\u7684\u53D8\u66F4\u3001\u4E2D\u6B62\u6216\u7EC8\u6B62</b></li>","<li>\u60A8\u5145\u5206\u4E86\u89E3\u5E76\u540C\u610F\uFF0C\u7531\u4E8E\u4E92\u8054\u7F51\u670D\u52A1\u7684\u7279\u6B8A\u6027\uFF0C\u767E\u5EA6\u53EF\u80FD\u4F1A\u6309\u7167\u76F8\u5173\u6CD5\u89C4\u3001\u53CC\u65B9\u7EA6\u5B9A\u6216\u5728\u5176\u4ED6\u5FC5\u8981\u65F6\uFF0C\u4E2D\u6B62\u6216\u7EC8\u6B62\u5411\u60A8\u63D0\u4F9B\u76F8\u5E94\u670D\u52A1\uFF0C\u5C4A\u65F6\uFF0C\u767E\u5EA6\u4F1A\u4F9D\u6CD5\u4FDD\u62A4\u60A8\u7684\u5408\u6CD5\u6743\u76CA\u3002</li>","<li><b>\u7B2C\u56DB\u7AE0 \u9644\u5219</b></li>","<li>\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u5982\u56E0\u7CFB\u7EDF\u7EF4\u62A4\u6216\u5347\u7EA7\u7B49\u800C\u9700\u6682\u505C\u670D\u52A1\u65F6\uFF0C\u5C06\u4E8B\u5148\u516C\u544A\u3002\u82E5\u56E0\u786C\u4EF6\u6545\u969C\u6216\u5176\u5B83\u4E0D\u53EF\u6297\u529B\u800C\u5BFC\u81F4\u6682\u505C\u670D\u52A1\uFF0C\u4E8E\u6682\u505C\u670D\u52A1\u671F\u95F4\u9020\u6210\u7684\u4E00\u5207\u4E0D\u4FBF\u4E0E\u635F\u5931\uFF0C\u767E\u5EA6\u8D34\u5427\u4E0D\u8D1F\u4EFB\u4F55\u8D23\u4EFB\u3002 \u7531\u4E8E\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u7684\u8C03\u6574\u5BFC\u81F4\u4FE1\u606F\u4E22\u5931\u548C/\u6216\u5176\u4ED6\u7ED3\u679C\u7684\uFF0C\u767E\u5EA6\u516C\u53F8\u4E0D\u627F\u62C5\u4EFB\u4F55\u8D23\u4EFB\u3002</li>","<li>\u767E\u5EA6\u6709\u6743\u6839\u636E\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u6CD5\u5F8B\u3001\u6CD5\u89C4\u53CA\u89C4\u8303\u6027\u6587\u4EF6\u7684\u53D8\u5316\u4EE5\u53CA\u4E92\u8054\u7F51\u53CA\u81EA\u8EAB\u4E1A\u52A1\u7684\u53D1\u5C55\u60C5\u51B5\uFF0C\u4E0D\u65AD\u4FEE\u6539\u548C\u5B8C\u5584\u5305\u62EC\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u534F\u8BAE\u5728\u5185\u7684\u767E\u5EA6\u8D34\u5427\u5E2E\u52A9\u7684\u76F8\u5173\u6761\u6B3E\u3002\u767E\u5EA6\u4FDD\u7559\u968F\u65F6\u4FEE\u6539\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u534F\u8BAE\u5728\u5185\u7684\u767E\u5EA6\u8D34\u5427\u5E2E\u52A9\u6761\u6B3E\u7684\u6743\u5229\u3002\u672C\u534F\u8BAE\u672A\u6D89\u53CA\u7684\u95EE\u9898\u53C2\u89C1\u56FD\u5BB6\u6709\u5173\u6CD5\u5F8B\u6CD5\u89C4\uFF0C\u5F53\u672C\u534F\u8BAE\u4E0E\u56FD\u5BB6\u6CD5\u5F8B\u6CD5\u89C4\u51B2\u7A81\u65F6\uFF0C\u4EE5\u56FD\u5BB6\u6CD5\u5F8B\u6CD5\u89C4\u4E3A\u51C6\u3002</li>","</ul>","</div>",'<div class="btn_group">','<a href="javascript:;" class="ui_btn ui_btn_m j_agree">',"<span><em>\u540C \u610F</em></span>","</a>",'<a href="javascript:;" class="ui_btn ui_btn_sub_m j_refuse">',"<span><em>\u62D2 \u7EDD</em></span>","</a>","</div>","</div>"],initial:function(){},registNextFn:function(i,t){this.nextFnStack.push({fn:i,context:t})},show:function(){this.dialog=new $.dialog({holderClassName:"paypostAgreeDialog",html:this.tpl.join(""),title:"\u4F7F\u7528\u987B\u77E5",width:550,height:270,draggable:!1}),this._bindDialogEvents()},_bindDialogEvents:function(){var i=this;this.dialog.element.find(".j_agree").one("click",function(){$.post("/diamond/submit/paypost/agree",{tbs:PageData.tbs});var t=i.require("common/widget/paypost_data").getInstance();t.set("hasAgree",1),i._fireNextFn(),i.dialog.close()}),this.dialog.element.find(".j_refuse").one("click",function(){i.dialog.close()})},_fireNextFn:function(){_.forEach(this.nextFnStack,function(i){i.fn.call(i.context)})}}});_.Module.define({path:"pb/widget/Admin/ThreadManage",requires:["encourage/widget/paypost_agree_dialog"],sub:{initial:function(e){try{this.needPaypostAgree=e.needPaypostAgree,this.jdom=$("#j_quick_thread"),this._bindEvents()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/admin/threadManage.js",method:"",ln:17}),t}},_bindEvents:function(){var e=this;if(this.jdom){this.jdom.delegate("a","click",function(){try{switch(this.className){case"j_thread_setgood":if(e.needPaypostAgree){var t=e.requireInstance("encourage/widget/paypost_agree_dialog");t.registNextFn(e.set_good,e),t.show()}else e.set_good();break;case"j_thread_disgood":e.unset_good();break;case"j_thread_settop":if(e.needPaypostAgree){var t=e.requireInstance("encourage/widget/paypost_agree_dialog");t.registNextFn(e.set_top,e),t.show()}else e.set_top();break;case"j_thread_distop":e.unset_top();break;case"j_thread_settopic":e.set_topic();break;case"j_thread_distopic":e.unset_topic();break;case"j_thread_setpictopic":e.set_pictopic();break;case"j_thread_dispictopic":e.unset_pictopic();break;case"j_thread_setmembertop":var a={forum_id:PageData.forum.forum_id,thread_id:PageData.thread.thread_id,tbs:PageData.tbs,fag:1};$.tb.get("/tbmall/get/top",a,function(t){0==t.data.end_time?$("#d_post_manage").addClass("zdt"):$("#d_post_manage").removeClass("zdt"),e.set_membertop()});break;case"j_thread_dismembertop":e.unset_membertop()}return!1}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"pb:widget/admin/threadManage.js",method:"",ln:81}),s}});var t={forum_id:PageData.forum.forum_id,thread_id:PageData.thread.thread_id,tbs:PageData.tbs,fag:1};$.tb.get("/tbmall/get/top",t,function(e){0==e.data.end_time&&$("#d_post_manage").addClass("zdt")}),$("a.j_thread_delete").live("click",function(){try{return e.del(),!1}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/admin/threadManage.js",method:"",ln:97}),t}});var a=$("#d_post_manage"),s=this.jdom;s.children().length>0&&(a.show(),a.hover(function(){s.show()},function(){s.hide()}))}if(null==$.cookie("timeShow")){var i=(new Date).getTime(),i=$.cookie("timeShow",i);e.notify_bubble()}else{var i=$.cookie("timeShow"),o=(new Date).getTime(),n=(o-i)/1e3/60/60,r=7;if(n>r&&$("#notify_bubble").length>0){e.notify_bubble();var i=(new Date).getTime(),i=$.cookie("timeShow",i)}}},showMessage:function(e,t,a,s){if(e){var i=this;i.message?i.message.showMessage(e,t,a,s):_.Module.getInstance("pb/widget/Message",function(o){i.message=o,i.message.showMessage(e,t,a,s)})}},notify_bubble:function(){$("#notify_bubble").show();var e={content:"<p class='small_tip'><i class='icon_top_badge'></i>\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876</p>\u8D85\u7EA7\u4F1A\u5458\u7F6E\u9876\u7279\u6743\u5347\u7EA7\uFF0C\u65E0\u9650\u4F7F\u7528\uFF0C\u5FEB\u6765\u8BD5\u8BD5\u5427\uFF01",arrow_dir:"down",bubble_css:{top:0,right:0,width:150},arrow_pos:{left:30},attr:" id='tb_message_tip_d' ",wrap:$("#notify_bubble"),closeBtn:!0},t=new UiBubbleTipBase(e);t.showBubble()},del:function(){var e=$.dialog.confirm('<div class="center-text">\u786E\u8BA4\u5220\u9664\u8FD9\u6761\u4E3B\u9898\u5417\uFF1F</div>',{showTitle:!1,buttonAcceptValue:" \u786E\u8BA4 ",buttonCancelValue:" \u53D6\u6D88 "}),t=this;e.bind("onaccept",function(){t.execute_delete()})},execute_delete:function(e){var t=this,a={commit_fr:"pb",ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};e&&(a=$.extend(a,t._captcha)),PostHandler.execute("threadDelete",a,function(e){var a="";switch(e.no){case 2501:if("undefined"!=typeof TbSafe){var s=TbSafe.getEnvState();"risk"==s?TbSafe.showRiskTip():"uninstall"==s?TbSafe.showInstallTip("\u6267\u884C\u5220\u8D34\u64CD\u4F5C"):TbSafe.showSidErrorTip();break}case 2502:if("undefined"!=typeof TbSafe){TbSafe.showSidErrorTip();break}case 2503:if("undefined"!=typeof TbSafe){TbSafe.showRiskTip();break}case 0:$.tb.location.setHref("/f?kw="+PageData.forum.name_encode);break;case 12:case 13:Thread_add_result.resultNo=e.no,a=Thread_add_result.getMessage();break;case 34:a="\u4EB2\u7231\u7684\u5C0F\u4F19\u4F34\uFF0C\u4F60\u4ECA\u5929\u7684\u5220\u8D34\u6570\u91CF\u5DF2\u7ECF\u8FBE\u5230\u6700\u5927\u9650\u989D("+e.data.reason+"\u6761/\u5929\uFF09\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 4009:a="\u4EB2\uFF0C\u7531\u4E8E\u672C\u8D34\u5B50\u7684\u5185\u5BB9\u975E\u5E38\u8D5E\u6240\u4EE5\u88AB\u4FDD\u62A4\u8D77\u6765\u5566\uFF0C\u60F3\u8981\u5220\u9664\u7684\u8BDD\u8BF7\u8054\u7CFB\u697C\u4E3B\u672C\u4EBA\u54E6~";break;case 871:a="\u62B1\u6B49\uFF0C\u4ECA\u5929\u5DF2\u8FBE\u60A8\u5220\u8D34\u7684\u6700\u5927\u9650\u989D\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 4011:t._getCaptcha.call(t,e);break;case 899:a="\u5BF9\u4E0D\u8D77\uFF0C\u4F60\u6CA1\u6709\u6743\u9650\u5220\u9664\u8BE5\u8D34\u5B50";break;case 877:a="\u8BE5\u8D34\u4E3A\u4ED8\u8D39\u53EF\u89C1\u8D34\uFF0C\u65E0\u6CD5\u5220\u9664";break;default:a="\u5220\u9664\u4E3B\u9898\u64CD\u4F5C\u5931\u8D25"}""!=a&&t.showMessage(a,"",!1)})},_captcha:{},_getCaptcha:function(e){var t=this;_.Module.use("common/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:PageData.forum.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){t.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){t._captcha.vcode=e.getInputValue(),t._captcha.vcode_md5=e.getVCode(),t.execute_delete.call(t,1)}),e.show()})},set_good:function(){var e=this,t={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,cid:0};$.get("/f/center/goodclass?kw="+PageData.forum.name_encode,function(a){var s=[];if(s.push('<div style="width:90%;margin:0 auto; line-height:25px;padding-top:20px">'),s.push("<p>\u5C06\u8BE5\u5E16\u5B50\u5206\u7C7B\u81F3\uFF1A"),s.push('<select class="j_thread_classes">'),s.push('<option value="0" selected>\u672A\u5206\u7C7B</option>'),a)for(var i=0;i<a.length;i++)s.push('<option value="'+a[i].class_id+'">'+a[i].class_name+"</option>");s.push("</select>"),s.push("</p>"),s.push("<p>\u63D0\u793A\uFF1A\u60A8\u53EF\u4EE5\u5230\u5427\u52A1\u7BA1\u7406\u9875\u4E2D\u6DFB\u52A0/\u4FEE\u6539\u5206\u7C7B</p>"),s.push('<div style="text-align:center">'),s.push('<input type="button" value="\u63D0\u4EA4" class="btn-sub btn-small j_thread_classes_confirm"><input type="button" value="\u53D6\u6D88" class="btn-sub btn-small j_thread_classes_cancel">'),s.push("</div>"),s.push("</div>");var o=new $.dialog({html:s.join(""),title:"\u8BBE\u7F6E\u7CBE\u534E\u8D34",width:400,height:140});$("select.j_thread_classes").bind("change",function(){t.cid=this.options[this.selectedIndex].value}),$("input.j_thread_classes_confirm").bind("click",function(){try{PostHandler.execute("goodAdd",t,function(t){var a="";switch(t.no){case 0:a="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:a=Thread_add_result.getMessage();break;default:a="\u8BBE\u4E3A\u7CBE\u534E\u8D34\u64CD\u4F5C\u5931\u8D25"}o.close(),e.showMessage(a,"",!1)})}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/admin/threadManage.js",method:"",ln:339}),a}}),$("input.j_thread_classes_cancel").bind("click",function(){try{o.close()}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/admin/threadManage.js",method:"",ln:343}),e}})},"json")},unset_good:function(){function e(e){$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_forceverify_wrapper.js?cdnversion="+(new Date).getTime()],function(){var a=passport.pop.initForceverify({token:e,title:"\u53D6\u6D88\u7CBE\u54C1\u8D34",msg:"\u4E3A\u4E86\u9632\u6B62\u76D7\u53F7\u9020\u6210\u8BEF\u64CD\u4F5C\uFF0C\u53D6\u6D88\u7CBE\u54C1\u8D34\u524D\u8BF7\u5148\u8FDB\u884C\u5B89\u5168\u9A8C\u8BC1",onSubmitSuccess:function(){t.unset_good()}});a.show()},!0,"utf-8")}var t=this,a={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};PageData.user.mobilephone?PostHandler.execute("goodCancel",a,function(a){var s="";switch(a.no){case 0:s="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:s=Thread_add_result.getMessage();break;case 41:e(a.data.token);break;default:s="\u8BBE\u4E3A\u7CBE\u534E\u8D34\u64CD\u4F5C\u5931\u8D25"}t.showMessage(s,"",!1)}):$.dialog.alert("\u4EB2\u7231\u7684\u5427\u4E3B\uFF0C\u6211\u4EEC\u68C0\u6D4B\u5230\u60A8\u5F53\u524D\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u8BF7\u524D\u5F80\u5B89\u5168\u4E2D\u5FC3\u7ED1\u5B9A\u624B\u673A\u53F7\u540E\uFF0C\u518D\u8FDB\u884C\u76F8\u5173\u64CD\u4F5C\uFF1B\u5982\u679C\u4E0D\u7ED1\u5B9A\u624B\u673A\u53F7\uFF0C\u5219\u5B58\u5728\u88AB\u76D7\u53F7\u6216\u88AB\u76D7\u53F7\u8005\u62C6\u5427\u7684\u98CE\u9669\u54E6",{title:"\u53D6\u6D88\u7CBE\u54C1\u8D34"})},set_top:function(){var e=this,t={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};PostHandler.execute("threadTopAdd",t,function(t){var a="";switch(t.no){case 0:a="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:a=Thread_add_result.getMessage();break;case 21:a="\u8BE5\u8D34\u4E3A\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u8D34\uFF0C\u65E0\u6CD5\u8FDB\u884C\u666E\u901A\u7F6E\u9876\u64CD\u4F5C";break;default:a="\u7F6E\u9876\u4E3B\u9898\u64CD\u4F5C\u5931\u8D25"}e.showMessage(a,"",!0)})},unset_top:function(){var e=this,t={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};PostHandler.execute("threadTopCancel",t,function(t){var a="";switch(t.no){case 0:a="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:a=Thread_add_result.getMessage();break;case 21:a="\u8BE5\u8D34\u4E3A\u4F1A\u5458\u7F6E\u9876\u8D34\uFF0C\u8BF7\u70B9\u51FB\u53D6\u6D88\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u8D34\u64CD\u4F5C";default:a="\u53D6\u6D88\u7F6E\u9876\u64CD\u4F5C\u5931\u8D25"}e.showMessage(a,"",!0)})},set_topic:function(){var e={ie:"utf-8",tbs:PageData.tbs,kw:$.tb.escapeHTML(PageData.forum.forum_name),fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,type:3};this.set_topic_request(e)},set_topic_request:function(e){var t=this;$.get("/live/setLiveTopic",e,function(e){var a="",s=80;switch(e.no){case 0:if(a="\u8BDD\u9898\u8D34\u8BBE\u7F6E\u6210\u529F\uFF0C\u6709\u6548\u671F\u81F3"+e.data.expire_time+"\uFF0C\u8FC7\u671F\u81EA\u52A8\u5931\u6548\u54E6~",e.data.conflict_info){var i,o=e.data.conflict_info;a+="\n\u60A8\u6240\u8BBE\u7F6E\u7684\u8BDD\u9898\u8D34\uFF0C\u4E0E\u4E0B\u5217\u8D34\u5427\u76F4\u64AD\u6D3B\u52A8\u51B2\u7A81\uFF0C\u5C4A\u65F6\u5C06\u66FF\u6362\u4E3A\u8D34\u5427\u6D3B\u52A8\uFF0C\u8BF7\u77E5\u6653\uFF1A\n",s+=20;for(var n in o)if(o.hasOwnProperty(n))for(var r=0;r<o[n].length;++r)i=o[n][r],a+=i.forum_name+"\u5427\uFF0C"+$.dateFormat(new Date(1e3*parseInt(i.start_time)),"yyyy-MM-dd HH:mm")+" ~ "+$.dateFormat(new Date(1e3*parseInt(i.end_time)),"yyyy-MM-dd HH:mm")+"\n",s+=20}break;case 12:case 13:a=Thread_add_result.getMessage();break;case 100012:a="\u8BE5\u5E16\u5B50\u5DF2\u7ECF\u88AB\u8FD0\u8425\u914D\u7F6E\u4E3A\u76F4\u64AD\u8D34\uFF0C\u8BF7\u6362\u4E2A\u5E16\u5B50\u8FDB\u884C\u64CD\u4F5C";break;case 100013:a="\u8BE5\u5427\u5DF2\u7ECF\u6709\u8BDD\u9898\u8D34";break;case 100005:a="\u672C\u5427\u6CA1\u6709\u5F00\u901A\u8BDD\u9898\u8D34\u7684\u6743\u9650";break;case 100003:a="\u8BE5\u7528\u6237\u6CA1\u6709\u914D\u7F6E\u8BDD\u9898\u5E16\u6743\u9650";break;default:a="\u518D\u8BD5\u4E00\u4E0B\uFF0C\u670D\u52A1\u5668\u53EF\u80FD\u5F00\u5C0F\u5DEE\u4E86"}t.showMessage(a,"",!1,{height:s})},"json")},unset_topic:function(){var e=this,t={ie:"utf-8",tbs:PageData.tbs,kw:$.tb.escapeHTML(PageData.forum.forum_name),fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};$.get("/live/delLiveTopic",t,function(t){var a="";switch(t.no){case 0:a="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:a=Thread_add_result.getMessage();break;default:a="\u53D6\u6D88\u8BDD\u9898\u8D34\u64CD\u4F5C\u5931\u8D25"}e.showMessage(a,"",!0)},"json")},set_pictopic:function(){var e={ie:"utf-8",tbs:PageData.tbs,kw:$.tb.escapeHTML(PageData.forum.forum_name),fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,type:4};this.set_topic_request(e)},unset_pictopic:function(){var e=this,t={ie:"utf-8",tbs:PageData.tbs,kw:$.tb.escapeHTML(PageData.forum.forum_name),fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};$.get("/live/delLiveTopic",t,function(t){var a="";switch(t.no){case 0:a="\u64CD\u4F5C\u6210\u529F";break;case 12:case 13:a=Thread_add_result.getMessage();break;default:a="\u53D6\u6D88\u56FE\u7247\u8BDD\u9898\u8D34\u64CD\u4F5C\u5931\u8D25"}e.showMessage(a,"",!0)},"json")},set_membertop:function(){var e=this;if(!PageData.user.Parr_props||!PageData.user.Parr_props.level||1e3*PageData.user.Parr_props.level.end_time<(new Date).getTime()){var t=new $.dialog({html:"",title:"\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876",draggable:!1,width:415,height:162});return e.setMtopDialogContent(t,{msg:'<p>\u60A8\u5C1A\u672A\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458<i class="icon_top_badge"></i>\uFF0C\u65E0\u6CD5\u4F7F\u7528\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u7279\u6743</p><p class="small_tip">\u73B0\u5728\u5F00\u901A\uFF0C\u5728\u4F1A\u5458\u6709\u6548\u671F\u5185\u53EF\u65E0\u9650\u6B21\u4F7F\u7528\u7F6E\u9876\u7279\u6743</p>',btnTrue:"\u7ACB\u5373\u5F00\u901A",btnCancel:"\u53D6 \u6D88"}),t.bind("true",function(){var a="\u4F1A\u5458\u7F6E\u9876",s=e.requireInstance("common/widget/payMember"),i={fr:a||"\u8D2D\u4E70\u4F1A\u5458"};s.showCashier(i),t.close()}),t.bind("cancel",function(){t.close()}),void 0}if($("#d_post_manage").hasClass("zdt"))e.set_topsuc();else{var a=['<div id="membertop_dialog_container" class="membertop_rst_container">','<div class="tips">',"<p>\u662F\u5426\u8981\u5C06\u6B64\u8D34\u7F6E\u9876\uFF1F</p>",'<p class="small_tip">\u65B0\u4F1A\u5458\u4E13\u4EAB\u7F6E\u9876\u8D34\u4F1A\u5C06\u65E7\u539F\u7F6E\u9876\u8D34\u66FF\u6362</p>',"</div>",'<div class="btn">','<a href="#" class="ui_btn ui_btn_m j_true">',"<span><em>\u786E \u5B9A</em></span>","</a>",'<a href="#" class="ui_btn ui_btn_sub_m j_cancel">',"<span><em>\u53D6 \u6D88</em></span>","</a>","</div>"].join(""),s=0;PageData.user.Parr_props&&PageData.user.Parr_props["118"]&&PageData.user.Parr_props["118"]["1180001"]&&(s=PageData.user.Parr_props["118"]["1180001"].left_num);var i=$.tb.format(a,{count:s}),o=new $.dialog({html:i,title:"\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876",draggable:!1,width:415,height:162}),n=o.element.find("#membertop_dialog_container"),r={forum_id:PageData.forum.forum_id,thread_id:PageData.thread.thread_id,tbs:PageData.tbs,fag:1};$.tb.get("/tbmall/get/top",r,function(e){if(0==e.no&&e.data&&e.data.end_time&&1e3*e.data.end_time>(new Date).getTime()){var t='<p class="counttime_section">\u5269\u4F59\u7F6E\u9876\u65F6\u95F4\uFF1A#{time}</p>',a="",s=1e3*e.data.end_time-(new Date).getTime();if(0>s)a="<span>0</span>\u5C0F\u65F6<span>0</span>\u5206";else{var i=Math.floor(s/36e5),o=Math.floor((s-36e5*i)/6e4);a="<span>"+i+" </span>\u5C0F\u65F6<span> "+o+"</span>\u5206"}var r=$.tb.format(t,{time:a}),d=n.find(".count_section");$(r).insertBefore(d),n.parent("#dialogJbody").css("height",140)}}),0==s&&n.find(".j_true").tbattr("class","ui_btn_disable ui_btn_m_disable j_true"),n.find(".j_true").on("click",function(t){try{if(t.preventDefault(),$(this).hasClass("ui_btn_disable"))return;o.close(),e.set_topsuc()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/admin/threadManage.js",method:"",ln:705}),t}}),n.find(".j_cancel").on("click",function(e){try{e.preventDefault(),o.close()}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/admin/threadManage.js",method:"",ln:709}),e}})}},set_topsuc:function(){var e=this,t={tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,props_id:1180001,user_id:PageData.user.id};$.tb.post("/f/commit/thread/top/madd",t,function(t){var a=new $.dialog({html:"",title:"\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876",draggable:!1,width:415,height:162});switch(parseInt(t.err_code,10)){case 0:e.setMtopDialogContent(a,{msg:"\u4F1A\u5458\u7F6E\u9876\u6210\u529F",btnTrue:"\u786E \u5B9A"}),a.bind("true",function(){$.tb.location.reload()}),e._postTrack("\u975E\u4F1A\u5458\u5427\u4E3B\u70B9\u51FB_\u7ACB\u5373\u5F00\u901A",PageData.user.id);break;case 2270020:e.setMtopDialogContent(a,{msg:'<p>\u60A8\u5C1A\u672A\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458<i class="icon_top_badge"></i>\uFF0C\u65E0\u6CD5\u4F7F\u7528\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u7279\u6743</p><p class="small_tip">\u73B0\u5728\u5F00\u901A\uFF0C\u5728\u4F1A\u5458\u6709\u6548\u671F\u5185\u53EF\u65E0\u9650\u6B21\u4F7F\u7528\u7F6E\u9876\u7279\u6743</p>',btnTrue:"\u7ACB\u5373\u5F00\u901A",btnCancel:"\u53D6 \u6D88"}),a.bind("true",function(){var t="\u4F1A\u5458\u7F6E\u9876",s=e.requireInstance("common/widget/payMember"),i={fr:t||"\u8D2D\u4E70\u4F1A\u5458"};s.showCashier(i),a.close()}),a.bind("cancel",function(){a.close()});break;case 2270022:e.setMtopDialogContent(a,{msg:"\u8BE5\u8D34\u5DF2\u7ECF\u8BBE\u7F6E\u4E3A\u7F6E\u9876\u8D34\uFF0C\u65E0\u6CD5\u88AB\u8BBE\u7F6E\u4E3A\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u8D34",btnTrue:"\u786E \u5B9A"}),a.bind("true",function(){a.close()});break;default:e.setMtopDialogContent(a,{msg:"\u670D\u52A1\u5668\u62BD\u98CE\u4E86\uFF0C\u9519\u8BEF\u7801\uFF1A"+t.err_code,btnTrue:"\u786E \u5B9A"}),a.bind("true",function(){a.close()})}var s=a.element.find("#membertop_dialog_container");s.find(".j_cancel").on("click",function(e){try{e.preventDefault(),a.close()}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/admin/threadManage.js",method:"",ln:783}),e}})})},unset_membertop:function(){var e=this,t={tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id};$.tb.post("/f/commit/thread/top/mcancel",t,function(t){var a=new $.dialog({html:"",title:"\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876",draggable:!1,width:415,height:122,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id});switch(parseInt(t.err_code,10)){case 0:e.setMtopDialogContent(a,{msg:"\u53D6\u6D88\u4F1A\u5458\u7F6E\u9876\u6210\u529F",btnTrue:"\u786E \u5B9A"}),$("#d_post_manage").addClass("zdt"),a.bind("true",function(){a.close()});break;case 2270020:e.setMtopDialogContent(a,{msg:'<p>\u60A8\u5C1A\u672A\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458<i class="icon_top_badge"></i>\uFF0C\u65E0\u6CD5\u4F7F\u7528\u8D85\u7EA7\u4F1A\u5458\u4E13\u5C5E\u7F6E\u9876\u7279\u6743</p><p class="small_tip">\u73B0\u5728\u5F00\u901A\uFF0C\u5728\u4F1A\u5458\u6709\u6548\u671F\u5185\u53EF\u65E0\u9650\u6B21\u4F7F\u7528\u7F6E\u9876\u7279\u6743</p>',btnTrue:"\u7ACB\u5373\u5F00\u901A",btnCancel:"\u53D6 \u6D88"}),a.bind("true",function(){var t="\u4F1A\u5458\u7F6E\u9876",s=e.requireInstance("common/widget/payMember"),i={fr:t||"\u8D2D\u4E70\u4F1A\u5458"};s.showCashier(i),a.close()}),a.bind("cancel",function(){a.close()});break;case 2270024:e.setMtopDialogContent(a,{msg:"\u53EA\u6709\u4F1A\u5458\u7F6E\u9876\u5E16\u624D\u53EF\u4EE5\u88AB\u53D6\u6D88",btnTrue:"\u786E \u5B9A"}),a.bind("true",function(){a.close()});break;default:e.setMtopDialogContent(a,{msg:"\u670D\u52A1\u5668\u62BD\u98CE\u4E86\uFF0C\u9519\u8BEF\u7801\uFF1A"+t.err_code,btnTrue:"\u786E \u5B9A"}),a.bind("true",function(){a.close()})}})},setMtopDialogContent:function(e,t){var a=['<div id="membertop_rst_container" class="membertop_rst_container">','<div class="tips">#{msg}</div>','<div class="btn">#{btns}</div>',"</div>"].join(""),s=['<a href="#" class="ui_btn ui_btn_m j_rst_true">',"<span><em>#{btnTrue}</em></span>","</a>"].join(""),i=['<a href="#" class="ui_btn ui_btn_sub_m j_rst_cancel">',"<span><em>#{btnCancel}</em></span>","</a>"].join(""),o="";t.btnTrue&&(o+=$.tb.format(s,t)),t.btnCancel&&(o+=$.tb.format(i,t)),t.btns=o;var n=$.tb.format(a,t);e.setContent(n),e.element.find(".j_rst_true").on("click",function(t){try{t.preventDefault(),e.triggerHandler("true")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/admin/threadManage.js",method:"",ln:886}),t}}),e.element.find(".j_rst_cancel").on("click",function(t){try{t.preventDefault(),e.triggerHandler("cancel")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/admin/threadManage.js",method:"",ln:890}),t}})},_postTrack:function(e,t){$.stats.track(e,"\u4F1A\u5458\u5065\u5EB7\u7EDF\u8BA1","","click",{obj_name:"\u7F6E\u9876\u7684\u70B9\u51FB\u91CF",obj_id:t})}}});
;_.Module.define({path:"pb/widget/Admin",requires:["pb/widget/Admin/ThreadManage","common/widget/BlockUser"],sub:{needPaypostAgree:0,initial:function(e){try{e&&(this.needPaypostAgree=e.needPaypostAgree)}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/admin/admin_main.js",method:"",ln:20}),a}},loadThreadManage:function(){PageData.is_thread_admin&&this.requireInstance("pb/widget/Admin/ThreadManage",{needPaypostAgree:this.needPaypostAgree})},loadAdmin:function(e,a,t){var n=e.find("ul.p_mtail");n.append(this._getAdminOplistHtml(a,t)),PageData.power.lz_del&&!PageData.user.forbidden.isForbid&&2==t.post_no&&this._showVipdelTip(n)},loadLzlAdmin:function(e){for(var a=e.find("li.j_lzl_s_p"),t=null,n=null,i=null,o=0,s=a.length;s>o;o++)t=$(a[o]),n=t.find("span.j_lzl_o_l"),i=t.getData(),n.html(this._getLzlAdminOplistHtml(i)),n.show()},_getAdminOplistHtml:function(e,a){var t=new Array,n="&nbsp;|";return a.is_anonym?PageData.power.can_filter_ip&&t.push('<li><a class="p_post_ban_anonym" href="#">\u5C01</a>'+n+"</li>"):PageData.power.can_filter_id&&t.push('<li><a class="p_post_ban" href="#">\u5C01</a>'+n+"</li>"),1!=a.post_no&&(PageData.power.can_mask_delete||PageData.power.lz_del&&!PageData.user.forbidden.isForbid&&!PageData.user.is_black)&&t.push('<li><a class="p_post_del" href="#">\u5220\u9664</a>'+n+"</li>"),PageData.power.can_super&&!a.is_anonym&&t.push('<li><a class="p_tieba_manage" href="/f?ct=503316480&cm=6000&tn=bdUserManager&un='+encodeURIComponent(e.name)+'" target="_blank">\u8D34\u5427\u7BA1\u7406</a>&nbsp;|</li>'),t.join("")},_getLzlAdminOplistHtml:function(e){var a=new Array,t="&nbsp;|&nbsp;";(PageData.power.can_filter_ip||PageData.power.can_filter_id)&&a.push('<a href="#" class="j_lzl_ban">\u5C01</a>'+t),(PageData.power.can_mask_delete||PageData.power.lz_del&&!PageData.user.forbidden.isForbid&&!PageData.user.is_black)&&a.push('<a href="#" class="j_lzl_del">\u5220\u9664</a>'+t),PageData.power.can_super&&a.push('<a href="/f?ct=503316480&cm=6000&tn=bdUserManager&un="'+e.user_name+' class="j_lzl_manage p_tieba_manage" target="_blank">\u8D34\u5427\u7BA1\u7406</a>'+t);var n=a.join("");return $.browser.msie&&"6.0"==$.browser.version&&!$.support.style&&(n+="&nbsp;"),n},_showVipdelTip:function(e){var a=$.cookie("VIP_TIP_USERS")||"|",t="|"+PageData.user.user_id+"|";if(!(a.indexOf(t)>=0)){a+=PageData.user.user_id+"|",$.cookie("VIP_TIP_USERS",a);var n=$('<div id="vip_del_tip" class="vip_del_tip"></div>');e.append(n);var i=0,o=0;o=0,i=-112;var s={content:"\u60A8\u53EF\u4EE5\u5220\u9664\u81EA\u5DF1\u4E3B\u9898\u8D34\u4E2D\u7684\u56DE\u590D",arrow_dir:"down",bubble_css:{top:o,right:i,width:180},arrow_pos:{left:30},attr:" id='tb_message_tip_n' ",wrap:$("#vip_del_tip"),closeBtn:!0},r=new UiBubbleTipBase(s);r.showBubble()}},bindAdminEvents:function(){var e=this,a=null,t=null;$("a.p_post_ban_anonym,.p_post_ban").live("click",function(){try{return a=$(this).parents(".j_l_post"),t=a.getData(),e.use("common/widget/BlockUser",[{username:t.author.user_name,pid:t.content.post_id}],{ban_ip:PageData.power.can_filter_ip,ban_id:PageData.power.can_filter_id},{forum_name:PageData.forum.forum_name,forum_id:PageData.forum.forum_id},PageData.tbs),!1}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"pb:widget/admin/admin_main.js",method:"",ln:169}),n}}),$("a.p_post_del").live("click",function(){try{a=$(this).parents(".j_l_post"),t=a.getData();var n={author_name:t.author.user_name,content_id:t.content.post_id};return e._del_post_confirm(n,0),!1}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"pb:widget/admin/admin_main.js",method:"",ln:180}),i}})},bindLzlAdminEvents:function(){var e=this,a=null,t=null;$("a.j_lzl_ban").live("click",function(){try{return a=$(this).parents("li.j_lzl_s_p "),t=a.getData(),e.use("common/widget/BlockUser",[{username:t.user_name,pid:t.spid||t.pid}],PageData.power,{forum_id:PageData.forum.forum_id,forum_name:PageData.forum.forum_name},PageData.tbs),!1}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"pb:widget/admin/admin_main.js",method:"",ln:201}),n}}),$("a.j_lzl_del").live("click",function(){try{return a=$(this).parents("li.j_lzl_s_p"),t=a.getData(),e._del_post_confirm(t,1),!1}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"pb:widget/admin/admin_main.js",method:"",ln:208}),n}})},_del_post_confirm:function(e,a){var t=this,n=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">\u786E\u8BA4\u5220\u9664\u8FD9\u6761\u56DE\u590D?<div>',{showTitle:!1});n.bind("onaccept",function(){t._del_post(e,a)})},_del_post:function(e,a,t){var n=this,i={commit_fr:"pb",ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,is_vipdel:PageData.power.lz_del?1:0};a?(i.pid=e.spid,i.is_finf=1):(i.pid=e.content_id,i.is_finf=!1),t&&(i=$.extend(i,n._captcha)),window.PostHandler.execute("postDelete",i,function(t){var i="";switch(t.no){case 2501:if("undefined"!=typeof window.TbSafe){var o=window.TbSafe.getEnvState();"risk"==o?window.TbSafe.showRiskTip():"uninstall"==o?window.TbSafe.showInstallTip("\u6267\u884C\u5220\u8D34\u64CD\u4F5C"):window.TbSafe.showSidErrorTip()}break;case 2502:"undefined"!=typeof window.TbSafe&&window.TbSafe.showSidErrorTip();break;case 2503:"undefined"!=typeof window.TbSafe&&window.TbSafe.showRiskTip();break;case 0:$.tb.location.reload(!0);break;case 12:case 13:i=window.Thread_add_result.getMessage();break;case 871:i="\u62B1\u6B49\uFF0C\u4ECA\u5929\u5DF2\u8FBE\u60A8\u5220\u8D34\u7684\u6700\u5927\u9650\u989D\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 34:i="\u4EB2\u7231\u7684\u5C0F\u4F19\u4F34\uFF0C\u4F60\u4ECA\u5929\u7684\u5220\u8D34\u6570\u91CF\u5DF2\u7ECF\u8FBE\u5230\u6700\u5927\u9650\u989D("+t.data.reason+"\u6761/\u5929\uFF09\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~";break;case 4009:i="\u4EB2\uFF0C\u7531\u4E8E\u672C\u8D34\u5B50\u7684\u5185\u5BB9\u975E\u5E38\u8D5E\u6240\u4EE5\u88AB\u4FDD\u62A4\u8D77\u6765\u5566\uFF0C\u60F3\u8981\u5220\u9664\u7684\u8BDD\u8BF7\u8054\u7CFB\u697C\u4E3B\u672C\u4EBA\u54E6~";break;case 4011:n._getCaptcha.call(n,t,e,a);break;default:i="\u62B1\u6B49\uFF0C\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u8D34\u5B50\u5220\u9664\u5931\u8D25\u3002"}""!=i&&(n.message?n.message.showMessage(i,"",!1):_.Module.getInstance("pb/widget/Message",function(e){n.message=e,e.showMessage(i,"",!1)}))})},_captcha:{},_getCaptcha:function(e,a,t){var n=this;n.requireInstanceAsync("common/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:PageData.forum.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){n.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){n._captcha.vcode=e.getInputValue(),n._captcha.vcode_md5=e.getVCode(),n._del_post.call(n,a,t,1)}),e.show()})}}});!function(){window.Path={map:function(t){return this.routes.defined[t]||(this.routes.defined[t]=new this.Route(t)),this.routes.defined[t]},listened:!1,listen:function(){this.listened=!0,this.supported=!(!window.history||!window.history.pushState),this.oldIE=navigator.userAgent.toLowerCase().search("msie")>0&&(!document.documentMode||document.documentMode<8);var t,e,n=$.tb.location;this.supported?(t=function(){Path.dispatch(n.getPathname()+n.getSearch())},window.onpopstate=t,e=n.getPathname()+n.getSearch()):(e=this.getHash(),this.oldIE?(t=function(){Path.dispatch(Path.getHash(Path.iframe.location))},this.iframe=document.createElement('<iframe src="javascript:0" tabindex="-1">'),this.iframe.style.display="none",document.body.insertBefore(this.iframe,document.body.firstChild),this.iframe=this.iframe.contentWindow,this.iframe.document.open().close(),this.iframe.location.hash=e,setInterval(t,1e4)):(t=function(){Path.dispatch(n.getHash().replace("#",""))},window.onhashchange=t),""!==e&&this.execute(e)),this.routes.current=e},nav:function(t){if(this.listened){if(/pn=1$/.test(t)){var e=$.tb.location.getHref(),n=/pn=\d+/g,i=n.test(e)?e.replace(n,"pn=1"):"/p/"+PageData.thread.thread_id+"?pn=1";return $.tb.location.setHref(i),void 0}this.supported?(window.history.pushState(null,null,t),this.dispatch(t)):this.oldIE?(this.iframe.document.open().close(),this.iframe.location.hash=t):$.tb.location.setHash(t)}},refresh:function(){this.execute(this.routes.current,!0)},setDefaultAction:function(t){this.defaultAction=t},Route:function(t){this.action=null,this.path=t},routes:{current:null,defined:{}},dispatch:function(t){t!==this.routes.current&&(this.routes.current=t,this.oldIE&&$.tb.location.setHash(t),this.execute(t))},execute:function(t,e){""===t&&(t=$.tb.location.getPathname()+$.tb.location.getSearch());var n,i;for(var a in Path.routes.defined)if(n=Path.routes.defined[a],i=Path.match(n.path,t))return n.action.call(n,i[0],i[1],e),void 0;"function"==typeof this.defaultAction&&this.defaultAction.call(this,t,!0)},match:function(t,e){var n=[e];if(t=t.split("/"),e=e.split("/"),t.length!==e.length)return!1;for(var i,a=0,o=t.length;o>a;a++)if(i=t[a].search(":"),-1!==i){if(t[a].slice(0,i)!==e[a].slice(0,i))return!1;n.push(e[a].slice(i))}else if(t[a]!==e[a])return!1;return n},getHash:function(t){var e="";return e=t?t.href.match(/#(.*)$/):$.tb.location.getHref().match(/#(.*)$/),e?e[1]:""},clean:function(){this.routes.current=null,this.routes.defined={}}},Path.Route.prototype={to:function(t){this.action=t}}}(),_.Module.define({path:"pb/widget/NoRefresh",sub:{initial:function(t,e){function n(){$(".pb_list_pager").off("click").on("click",function(t){try{var e,n,i,a=$.tb.location,o=t.target;if(!PageData.user.is_login)return n="http://tieba.baidu.com"+$.tb.unescapeHTML($(o).tbattr("href")),window.open("/f/user/passport?jumpUrl="+n+"&statsInfo=frs_pager#login_anchor"),!1;if(i=$(this).parents(".p_thread"),i.find(".loading-tip").css({top:i.offset().top+i.height()+20+"px",left:i.offset().left+$(".left_section").width()/2-35+"px"}).show(),m&&m.start_event(),"a"===o.tagName.toLowerCase())return e=o.getAttribute("href",2).replace(a.getProtocol()+"//"+a.getHost(),""),d||(e="/pn="+e.match(/\d+$/)),Path.nav(e),t.preventDefault(),!1}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/no_refresh_pager/no_refresh_pager.js",method:"",ln:191}),t}}),$(".jump_input_bright").off("keypress").on("keypress",function(t){var e=$(this);m&&m.start_event(),13==t.keyCode&&h(t,e)}),$(".jump_btn_bright").off("click").on("click",function(t){try{var e=$(this).prev(".jump_input_bright");m&&m.start_event(),h(t,e)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/no_refresh_pager/no_refresh_pager.js",method:"",ln:203}),t}})}function i(){bdShareTb.fn?bdShareTb.fn.init():_.Module.use("common/widget/bd_share",null,function(){bdShareTb.fn.init()})}function a(){mbox.player&&mbox.player.stop(),mbox.player&&mbox.player.dispose()}function o(o,s,h){var c;if(-1!==o.indexOf("#")&&o.slice(0,o.indexOf("#")),c=d?o+"&ajax=1&t="+(new Date).getTime():t+s+"&ajax=1&t="+(new Date).getTime(),h&&(c+="&refresh=true"),l){if(f===s)return;l.abort()}a(),f=s,m&&m.start_send(),l=$.get(c,function(t){l=null,m&&m.transfer_time(),e||r(),setTimeout(function(){var e=$(t),a=e.slice(1),o=e.find("#j_p_postlist"),r=e.find("#ajax-up"),s=e.find("#ajax-down"),h=e.find("#ajax-title .core_title_txt");buttons=e.find("#ajax-title .core_title_btns"),script=e.find("#ajax-script"),$("#j_p_postlist").empty().html(o.html()),$(".p_thread:first").replaceWith(r.html()),$(".p_thread:last").replaceWith(s.html()),$(".core_title_txt").replaceWith(h),$(".core_title_btns").empty().html(buttons.html()),$("body").append(a);u.use("pb/widget/NoAutoVideo");u.fire("noRefreshFinish"),n(),i(),PageData.pager.total_page=parseInt(r.find(".jump_input_bright").tbattr("max-page"))||1,PageData.pager.cur_page=parseInt(f,10)||1,m&&m.view_time(),m&&m.ready()},0)},"html")}function r(){var t=$(window).scrollTop();t>0&&($("body").animate({scrollTop:1},"medium"),setTimeout(function(){window.scrollTo(0,0)},500))}function s(t){var e=$.tb.location.getPathname()+$.tb.location.getSearch(),n=e.indexOf("#");return n>=0&&(e=e.substr(0,n)),-1==e.indexOf("pn")?e+=-1==e.indexOf("?")?"?pn="+t:e.indexOf("?")==e.toString().length-1?"pn="+t:"&pn="+t:e=e.replace(/(.*pn=)(\d+)?/,function(e,n){return n+""+t}),e}function h(t,e){var n,i=e,a=i.val(),o=i.tbattr("max-page");return d?/^(-?)(\d+)$/.test(a)?($pthread=i.parents(".p_thread"),$pthread.find(".loading-tip").css({top:$pthread.offset().top+$pthread.height()+20+"px",left:$pthread.offset().left+$(".left_section").width()/2-35+"px"}).show(),a=Math.max(1,Math.min(a,o)),n=s(a),d||(n="/pn="+a),Path.nav(n),t.preventDefault(),!1):(i.val(""),!1):/^(-?)(\d+)$/.test(a)?(Path.nav("/pn="+a),$pthread=i.parents(".p_thread"),$pthread.find(".loading-tip").css({top:$pthread.offset().top+$pthread.height()+20+"px",left:$pthread.offset().left+$(".left_section").width()/2-35+"px"}).show(),!1):void 0}function c(){$("#container").on("mousedown",".pb_list_pager a",function(){var t=$(this).parents(".p_thread").tbattr("id");return $(this).hasClass("pager_disabled")?!1:(p("pb_fanye_page",t),void 0)})}function p(t,e){$.tb.Stats.sendRequest("http://tb1.bdstatic.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"pb",st_type:t,st_value:e})}try{var f,d=!(!window.history||!window.history.pushState),u=this,l=null;if("undefined"!=typeof AJAX_MONITOR){AJAX_MONITOR.PDC.init({product_id:14,sample:1,max:5});var m=AJAX_MONITOR.PDC.createInstance(13)}n(),c(),Path.map(d?t+":num":"/pn=:num").to(function(t,e,n){o(t,e,n)}),Path.setDefaultAction(function(t,e){if(""===t.replace("#","")||e){var n=t.match(/&pn=(\d+)/i);n=n?n[1]:void 0===f?0:f,o(n,e)}}),Path.listen(),window.refreshPage=o}catch(g){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:g.message||g.description,path:"pb:widget/no_refresh_pager/no_refresh_pager.js",method:"",ln:418}),g}}}});_.Module.define({path:"pb/widget/Favthread",sub:{initial:function(){try{this.jdom=$("#j_favthread"),this.ele=$(".j_favor"),this.data=this.ele.getData(),this.status=null,this.is_anonym=null,this.bub=null,this.tip_tid=null,this.init()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/favthread/favthread.js",method:"",ln:19}),t}},init:function(){this.status=this.data.status,this.is_anonym=this.data.is_anonym,this.bind_menu_event()},_showMessageDilog:function(t,e,a){var i=this;i.message?i.message.showMessage(t,e,a):_.Module.use("pb/widget/Message",function(s){s.showMessage(t,e,a),i.message=s})},cookie_draw:function(){$.cookie("favthread","1",{expires:30})},bind_menu_event:function(){var t=this;t.ele.click(function(){try{if(0===PageData.user.is_login)return TbCom.process("User","buildLoginFrame",null,null,null,null),void 0;0==t.status?t.excute_open():t.excute_cancel()}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/favthread/favthread.js",method:"",ln:57}),e}})},_updateFavorText:function(){var t=0!=this.status?"\u5DF2\u6536\u85CF":"\u6536\u85CF";this.ele.html(t)},show_tip:function(t,e,a){var i=this,s=e?5400:2400;this.bub&&(this.bub.hide(),this.cookie_draw()),this.close_tip(a);var o=a||this.jdom.find(".p_favthr_tip");e?o.width(410):o.width(270),a&&o.width(240),$.ajax({url:"/ugctag/delStorThread",data:{tid:PageData.thread.thread_id,tbs:PageData.tbs,ie:"utf-8"},type:"post",datatype:"json",success:function(e){0==e.no?($(".recommend_outtest_container").remove(),o.html(t),o.css("opacity","0").animate({opacity:1,height:"toggle"},600),this.tip_tid=setTimeout(function(){o.animate({opacity:0,height:"toggle"},600)},s)):i._showMessageDilog('<div style="width:180px;">\u53D6\u6D88\u6536\u85CF\u5931\u8D25</div>',"\u64CD\u4F5C\u5931\u8D25",!1)},error:function(){i._showMessageDilog('<div style="width:180px;">\u53D6\u6D88\u6536\u85CF\u5931\u8D25</div>',"\u64CD\u4F5C\u5931\u8D25",!1)}})},show_recommend_tag:function(t,e,a){var i=this,s=this.jdom.find("div.p_favthr_main"),o=$("#j_p_postlist");s.find("p").html("\u5DF2\u6536\u85CF"),param={tid:t,offset:e,limit:a},$(".recommend_outtest_container").remove(),$.get("/ugctag/getThreadRecTag",param,function(e){e.no?i.dialog_alert("\u83B7\u53D6\u6570\u636E\u5931\u8D25"):($(".j_add_tag").tbattr("placeholder"," \u6DFB\u52A0\u6807\u7B7E\u6765\u6536\u85CF\u4F60\u7BA1\u7406\u7684\u5E16\u5B50"),o.prepend(i.append_recommend_tag(e)),$(".recommend_outtest_container").on("click",".pb_recommend_tag",function(t){try{var e=" "+$(t.currentTarget).tbattr("title"),a=$(".j_add_tag").val();$(".j_add_tag").val(a+e)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/favthread/favthread.js",method:"",ln:137}),t}}),$(".recommend_outtest_container").on("click",".delete_collect",function(){try{$(".recommend_outtest_container").remove()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/favthread/favthread.js",method:"",ln:140}),t}}),$(".tag_button").delegate(".tag_submit_button","click",function(){try{$(".tag_submit_button").tbattr("disabled",!0);var e="";e=$.trim($(".show_tag_input").find(".j_add_tag").val()),i.send_tag(e,t)}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/favthread/favthread.js",method:"",ln:146}),a}}),$(".recommend_outtest_container").delegate(".j_add_tag","blur",function(){var t=$(".j_add_tag").val();" "!==t[t.length-1]&&void 0!=t[t.length-1]&&$(".j_add_tag").val($(".j_add_tag").val()+" ")}).on("click",function(){try{$(".j_add_tag").tbattr("placeholder","")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/favthread/favthread.js",method:"",ln:154}),t}}))},"json")},append_recommend_tag:function(t){var e=[];return e.push('<div class="recommend_outtest_container">'),e.push("<span class = 'arrow_top'></span>"),e.push('<div class="success_tip">'),e.push('<div class="collect_success"><div class = "collect_tip"></div><span>\u6536\u85CF\u6210\u529F</span></div>'),e.push('<div class="delete_collect"></div><hr>'),e.push("</div>"),e.push('<div class = "rules_tip">\u6807\u7B7E\uFF1A(\u591A\u4E2A\u6807\u7B7E\u7528\u7A7A\u683C\u5206\u9694)</div>'),e.push('<div class="show_tag_input" ><input type="text" placeholder = " \u6DFB\u52A0\u6807\u7B7E\u6765\u6536\u85CF\u4F60\u7BA1\u7406\u7684\u5E16\u5B50" class="j_add_tag" ></input></div>'),e.push('<div class = "recommend_tag">'),$.each(t.data.output,function(t,a){if(a.length>5)var i=a.substr(0,5)+"...";else i=a;e.push('<div class = "pb_recommend_tag" title = '+a+"><span>"+i+"</span></div>")}),e.push("</div>"),e.push('<div class="tag_button"><div class="tag_submit_button" ><span>\u6DFB\u52A0</span></div></div>'),e.push("</div>"),e.join("")},close_tip:function(t){var e=this.tip_tid;e&&(clearTimeout(e),t?t.hide():$(".p_favthr_tip").hide())},send_tag:function(t,e){var a=this,i=t.split(" "),s=[];$.each(i,function(t,e){e&&s.push(e)});var o={tid:e,tags:s,tbs:PageData.tbs,ie:"utf-8"};s.length?$.ajax({url:"/ugctag/addStorThreadTags",data:o,dataType:"json",type:"post",success:function(t){$(".tag_submit_button").tbattr("disabled",!1),0==t.no?(a.dialog_alert("\u6DFB\u52A0\u6210\u529F"),$(".recommend_outtest_container").remove()):10001==t.no?a.dialog_alert("\u4E00\u4E2A\u5E16\u5B50\u6700\u591A\u6DFB\u52A03\u4E2A\u6807\u7B7E"):10002==t.no?a.dialog_alert("\u6700\u591A\u8F93\u516530\u4E2A\u5B57\u7B26\u6216\u800515\u4E2A\u6C49\u5B57"):161001==t.no?a.dialog_alert("\u7981\u6B62\u8F93\u5165\u91CD\u590D\u6570\u636E"):210009==t.no&&a.dialog_alert("\u53C2\u6570\u9519\u8BEF")},error:function(){$(".tag_submit_button").tbattr("disabled",!1),a.dialog_alert("\u6DFB\u52A0\u5931\u8D25")}}):a.dialog_alert("\u7981\u6B62\u6DFB\u52A0\u7A7A\u6570\u636E")},excute_open:function(t){var e=this,a={tbs:PageData.follow_sign,tid:PageData.thread.thread_id,type:0,datatype:"json",ie:"utf-8"};$.post("/i/submit/open_storethread",a,function(a){if(t instanceof Function&&t(a),a)if(0==a.error_no&&0==a.ret.type)e.status=1,e._updateFavorText(),t||e.show_recommend_tag(PageData.thread.thread_id,0,3);else{if(4==a.error_no)return TbCom.process("User","buildLoginFrame",null,null,null,null),void 0;if(40==a.error_no)e._showMessageDilog('<div style="padding-bottom:10px;">\u4F60\u4ECA\u5929\u6536\u85CF\u7684\u8D34\u5B50\u592A\u591A\u4E86,\u8BF7\u54C1\u8BFB\u4E4B\u540E\u660E\u5929\u518D\u6765\u5427:)~ </div>',"\u64CD\u4F5C\u5931\u8D25",!1);else if(9e3==a.error_no)return TbCom.process("User","buildUnameFrame","\u6709\u7528\u6237\u540D\u624D\u80FD\u201C\u6536\u85CF\u201D\u8D34\u5B50\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~"),void 0}else e._showMessageDilog('<div style="width:180px;">\u670D\u52A1\u5668\u73B0\u5728\u5F88\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5 *_*</div>',"\u64CD\u4F5C\u5931\u8D25",!1)},"json")},excute_cancel:function(t){var e=this,a={tbs:PageData.follow_sign,tid:PageData.thread.thread_id,type:0,datatype:"json",ie:"utf-8"};$.post("/i/submit/cancel_storethread",a,function(a){if(t instanceof Function&&t(a),a)if(0==a.error_no&&0==a.ret.type)e.status=0,e._updateFavorText(),t||e.show_tip("<span>\u53D6\u6D88\u6536\u85CF\u6210\u529F</span>",!1);else{if(4==a.error_no)return TbCom.process("User","buildLoginFrame",null,null,null,null),void 0;40==a.error_no&&e._showMessageDilog('<div style="padding-bottom:10px;">\u4F60\u4ECA\u5929\u6536\u85CF\u7684\u8D34\u5B50\u592A\u591A\u4E86,\u8BF7\u54C1\u8BFB\u4E4B\u540E\u660E\u5929\u518D\u6765\u5427:)~ </div>',"\u64CD\u4F5C\u5931\u8D25",!1)}else e._showMessageDilog('<div style="width:180px;">\u670D\u52A1\u5668\u73B0\u5728\u5F88\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5 *_*</div>',"\u64CD\u4F5C\u5931\u8D25",!1)},"json")},dialog_alert:function(t){var e="<div class = 'add_success'>"+t+"</div>",a=$.dialog.alert(e,{title:"\u8D34\u5427\u63D0\u793A"});this.dialog_success=$(a.element),$(".dialogJbtn",this.dialog_success).addClass("j_add_success")}}});_.Module.define({path:"common/component/force_login",sub:{_config:{apiOpt:{staticPage:"http://"+$.tb.location.getHost()+"/tb/static-common/html/pass/v3Jump.html",product:"pctb_3",charset:PageData&&PageData.charset?PageData.charset:"GBK",u:"",memberPass:!0,safeFlag:0},cache:!1,img:"",onLoginSuccess:function(t){t.returnValue=!1,$.stats.sendRequest("st_type=login_succeed&fr=tb0&st_pos="),$.tb.location.reload()},onSubmitStart:function(){$.stats.sendRequest("st_type=login_click&fr=tb0&st_pos=")},registerLink:"https://passport.baidu.com/v2/?reg&tpl=tieba&u=http://tieba.baidu.com",tangram:!0},initial:function(t,e,s,a,c){var i=this,p=1,o="string"==typeof s&&""!==s?s:"dialog";if(i._config.apiOpt.u="string"==typeof t&&""!=t?t:$.tb.location.getHref(),"page"===o)return $.tb.location.setHref("/f/user/passport?jumpUrl="+i._config.apiOpt.u+"&statsInfo="+a),void 0;switch(a){case"pb_lzl_more":$.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web");break;case"pb_see_lz":$.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web")}if("string"==typeof e){switch(e){case"userBar":p=1;break;case"editor1":case"lzl":p=2;break;case"editor":p=3;break;case"lzonly":p=4;break;case"ilike":p=5;break;default:p=1}i._config.img="http://tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic"+p+".png"}else i._config.img="http://tb2.bdstatic.com/tb/static-common/img/passport/logindlg_pic"+p+".png";PageData&&(i._config.apiOpt.isQuickUser=PageData.is_quick_user||0),i._config.onLoginSuccess=c?function(t){switch(a){case"pb_lzl_more":$.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u767B\u5F55\u6210\u529F","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web");break;case"pb_see_lz":$.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u767B\u5F55\u6210\u529F","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web")}t.returnValue=!1,c(),setTimeout(function(){$.tb.location.setHref(i._config.apiOpt.u)},500)}:function(t){switch(a){case"pb_lzl_more":$.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u767B\u5F55\u6210\u529F","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web");break;case"pb_see_lz":$.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u767B\u5F55\u6210\u529F","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","view","pc_web")}t.returnValue=!1,setTimeout(function(){$.tb.location.setHref(i._config.apiOpt.u)},500)},arguments.length>4&&(i._config.apiOpt.product=arguments[4]),function(t){var e="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();t.JsLoadManager.use(["http://passport.bdimg.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(e/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(e/6e4)],function(){t.passPopInstance||(t.passPopInstance=passport.pop.init(i._config)),t.passPopInstance.show();var e=setInterval(function(){var s=t("#passport-login-pop");0!==s.length&&(s.find(".pass-login-pop-img img").tbattr("src",i._config.img),s.find(".pass-reglink").click(function(){switch(a){case"pb_lzl_more":t.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u7ACB\u5373\u6CE8\u518C","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web");break;case"pb_see_lz":t.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u7ACB\u5373\u6CE8\u518C","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web")}}),s.find(".pass-fgtpwd").click(function(){switch(a){case"pb_lzl_more":t.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u5FD8\u8BB0\u5BC6\u7801","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web");break;case"pb_see_lz":t.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u5FD8\u8BB0\u5BC6\u7801","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web")}}),s.find(".pass-button-submit").click(function(){switch(a){case"pb_lzl_more":t.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u767B\u5F55","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web");break;case"pb_see_lz":t.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u767B\u5F55","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web")}}),s.find(".close-btn").click(function(){switch(a){case"pb_lzl_more":t.stats.track("PB\u9875\u70B9\u51FB\u697C\u4E2D\u697C\u67E5\u770B\u66F4\u591A\u767B\u5F55\u5F39\u7A97_\u5173\u95ED","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web");break;case"pb_see_lz":t.stats.track("PB\u9875\u70B9\u51FB\u53EA\u770B\u697C\u4E3B\u767B\u5F55\u5F39\u7A97_\u5173\u95ED","PC\u7AEF\u5F3A\u5236\u767B\u5F55\u7EDF\u8BA1","pb","click","pc_web")}}),clearInterval(e))},200);setTimeout(function(){t("#passport-login-pop").find("input.pass-button-submit").tbattr("alog-alias","login")},1e3)},!0,"utf-8")}(window.jQuery)}}});_.Module.define({path:"adsense/widget/tool_async",requires:[],sub:{initial:function(){this.dataHandler=this.requireInstance("adsense/widget/data_handler_async",[])},genMd5:function(e){var t="AS"+this.genRandChar(),a=(new Date).getTime();return t+e.substr(-3)+(""+a).substr(-6)},genQaClassName:function(){return"1"==$.tb.location.getSearchValue("__qa_page_diff")?"__qa_page_diff":""},genRandChar:function(){var e="abcdefghijklmnopqrstuvwxyz";return e[this._randomInt(0,e.length-1)]},_randomInt:function(e,t){return e-=1,Math.ceil(e+Math.random()*(t-e))},getStatsUrl:function(e,t){var a;return a=t.click_url_params?this.getUrl({url:"/link",tbjump:t.click_url_params,extra:{obj_id:t.id}}):e},getUrl:function(e){var t=$.getPageData("forum"),a=$.getPageData("user"),r=$.getPageData("context.thread_info",{}),n=e.url?e.url:"",i=$.getPageData("product",""),u=["client_type=pc_web","tbjump="+(e.tbjump?e.tbjump:""),"task="+(e.task?e.task:""),"locate="+(e.locate?e.locate:""),"page="+(e.page?e.page:""!=i?i:"MODULE_NAME"),"type=click","fid="+(t.forum_id?t.forum_id:""),"fname="+(t.forum_name?t.forum_name:""),"uid="+(a.user_id?a.user_id:""),"uname="+(a.user_name?a.user_name:""),"is_new_user="+(a.is_new_user?a.is_new_user:""),"tid="+(r.thread_id?r.thread_id:""),"_t="+(new Date).getTime()];return e.extra&&$.each(e.extra,function(e,t){u.push(e+"="+t)}),n+"?"+u.join("&")},getDirInfo:function(){var e=this.dataHandler.getData();return{forum_dir:$.getPageData("forum.first_class",""),forum_second_dir:$.getPageData("forum.second_class",""),forum_vdir:$.getPageData("forum_vdir","",e)}},getSpecialInfo:function(e){for(var t=this.dataHandler.getData(),a={},r=0,n=e.length;n>r;r++)a[e[r]]=t[e[r]];return a},preProcess:function(e,t,a){return"undefined"==typeof a&&(a=0),t.loc_index=a+1,t}}});_.Module.define({path:"adsense/widget/loader_async",requires:["adsense/widget/tool_async"],sub:{initial:function(e){var t=this.requireInstance("adsense/widget/tool_async"),a="/dasense/"+e.url,n=e.extraData||{},s=e.specialDataName||[];this.tool=t,a=t.getUrl({url:a}),this.dataname=e.dataname||null,this.dfd=$.Deferred(),this._getData(a,n,s)},_getData:function(e,t,a){var n=this,s=this.tool.getDirInfo(),i=this.tool.getSpecialInfo(a);t=$.extend(null,t,s,i,{ie:"utf-8"}),$.getJSON(e,t,function(e){if(0!=e.errno||!n.dataname)return!1;var t=$.getPageData("data.adsense",{},e);n.data=t[n.dataname]||[],n._loadTPL()})},_loadTPL:function(){for(var e=!0,t=null,a=0,n=this.data.length;n>a;a++){var s=this.data[a];s=this.tool.preProcess(this.dataname,s,a),s.first_screen&&"0"!=s.first_screen||!e||(t=-1==(s.tpl_name+"").indexOf("ASYNC_")?"tpl_async_"+s.tpl_name:"tpl_"+s.tpl_name,t="adsense/widget/"+t,this.requireInstanceAsync(t,[{adData:s,needStats:!0}]))}this._resolve()},_resolve:function(){var e=null;e=this.data.length?{no:0,error:""}:{no:1,error:"has no data"},this.dfd.resolve(e)}}});_.Module.define({requires:["adsense/widget/loader_async"],path:"ucenter/widget/LikeTip",sub:{initial:function(e,s,i,t){var a=this;if(this.userForumList=t||"",i&&i.like_no&&i.like_no>=1){var r=$.dialog.open(['<div id="do_like_back_wrapper">','<img class="like_back_img" src="http://tb2.bdstatic.com/tb/static-ucenter/widget/like_tip/img/like_back_c3abf90.jpg">',this.like_forum_tmp,"</div>"].join(""),{width:478,acceptValue:"\u77E5\u9053\u4E86"});$(r.element[0]).find(".dialogJcontent").css("padding-bottom","0px"),$(r.element[0]).find(".dialogJanswers").css("padding-top","0px"),r.bind("onaccept",function(){a.reloadAndGotop()}).bind("onclose",function(){a._postDaLikeTrack("\u5173\u95ED"),a.reloadAndGotop()})}else{var n=this.getTipContent(e,s,i),l={title:"\u6210\u529F\u63D0\u793A",width:478,modal:!e};this.isSuperMember()&&(l.width=535);var r=$.dialog.open(n,l);e&&$(r.element[0]).css("padding","2px"),$(r.element[0]).find(".dialogJcontent").tbattr("id","balv_first_like_dialog"),$(r.element[0]).find(".userlike_tip_span a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=entryimallinpop")}),$(r.element[0]).on("click",".userlike_supermember_btn",function(){window.open("/tbmall/mall/forumMember"),a.reloadAndGotop()}),r.bind("onclose",function(){a._postDaLikeTrack("\u5173\u95ED"),a.reloadAndGotop()})}this.initLikeForum(r)},like_forum_tmp:['<div id="content-recommend-like-forum">','<p class="like-btn-wrapper">\u4F60\u53EF\u80FD\u8FD8\u60F3\u5173\u6CE8<button class="btn-default btn-small pull-right a-like-all-btn">\u4E00\u952E\u5173\u6CE8</button></p>','<div class="adsense-content-recommend-forum"></div>',"</div>"].join(""),initLikeForum:function(e){var s=100,i=this.requireInstance("adsense/widget/loader_async",[{url:"recommend",dataname:"PC_RECOMM_BOTTOM",extraData:{user_forum_list:this.userForumList}}]),t=$("#content-recommend-like-forum"),a=this;t.on("click",".a-like-all-btn",function(){a._postDaLikeTrack("\u4E00\u952E\u5173\u6CE8"),t.find(".a-like-btn.btn-sub:lt(4)").trigger("click")}),i.dfd.done(function(i){0==i.no&&t.html().length&&(t.show(),e.setPosition(null,s))})},_postDaLikeTrack:function(e,s,i,t){"undefined"==typeof e&&(e=""),"undefined"==typeof t&&(t="click"),i=i||{},s&&(i=$.extend({obj_name:s.game_name,obj_game_id:s.game_id},i)),$.stats.track(e,"\u5206\u53D1\u5173\u6CE8\u5427\u63A8\u8350","",t,i)},getTipContent:function(e,s,i){var t=PageData,a=t.user.level_id?t.user:t.user.balv,r="<span>";e&&(r+=e+"\uFF0C"),r+="\u606D\u559C\u4F60\u6210\u4E3A\u672C\u5427\u7B2C</span>",r+="<span class='tip_font_orange'>"+i.index+"</span>",r+="<span>\u4F4D\u4F1A\u5458</span>";var n="";n+='<div class="userlike_tip_join" id="userlike_tip_join">',n+='<div class="userlike_tip_info" id="userlike_tip_info">'+r+"</div>",e?n+='<div class="user_rights_msg"><span class="user_rights_msg_gray">\u83B7\u5F97\u5934\u8854&nbsp;</span><img class="user_rights_msg_img" src="/tb/static-frs/img/balv/lv_join.png">&nbsp;'+a.level_name+'<span class="user_rights_msg_gray">&nbsp;\u5347\u7EA7\u4EAB\u7279\u6743\uFF0C<span><a class="user_rights_msg_link" target="_blank" href="/f/like/level?kw='+t.forum.name_url+'">\u67E5\u770B\u4F1A\u5458\u6743\u5229</a></div>':1==a.level_id?n+='<div class="user_rights_msg">\u83B7\u5F97\u5934\u8854&nbsp;<img class="user_rights_msg_img" src="/tb/static-frs/img/balv/lv_join.png">&nbsp;'+a.level_name+'\uFF0C\u5347\u7EA7\u4EAB\u7279\u6743\uFF0C<a target="_blank" href="/f/like/level?kw='+t.forum.name_url+'">\u67E5\u770B\u5347\u7EA7\u79D8\u7C4D</a></div>':(n+='<div class="user_rights_msg">\u6839\u636E\u4F60\u5728\u672C\u5427\u7684\u6D3B\u8DC3\u8868\u73B0\uFF0C\u76F4\u63A5\u6388\u4E88<img src="http://tb2.bdstatic.com/tb/static-member/img/badges/'+a.level_id+'.png">&nbsp;'+a.level_name+"\uFF0C\u7ED9\u529B\uFF01</div>",n+='<div class="userlike_tip_span">\u672C\u5427\u767E\u5B9D\u7BB1\u5BF9\u4F60\u5F00\u653E\u4E86\uFF0C<a target="_blank" href="/imall/mall?kw='+t.forum.name_url+'">\u53BB\u767E\u5B9D\u7BB1\u770B\u770B\u6709\u54EA\u4E9B\u7279\u6743\u548C\u5B9D\u8D1D</a></div>'),this.isSuperMember()&&(n+=this.getSuperMemberHtml()),n+=this.like_forum_tmp,n+='<div class="lvlup_tip_btnzone">';var l="";return this.isSuperMember()&&(n+='<input class="userlike_supermember_btn userlike_sm_btn_style" type="button" value="\u8BE6\u7EC6\u4E86\u89E3\u7279\u6743"/>',l="userlike_sm_btn_style"),e&&(n+='<a class="userlike_tip_cancel" target="_blank" href="/home/forum?id='+t.user.portrait+"&fr="+t.product+'">\u5982\u4F55\u53D6\u6D88\u4F1A\u5458</a>'),n+="</div></div>"},reloadAndGotop:function(){$.tb.location.setHref($.tb.location.getHref().split("#")[0])},getSuperMemberHtml:function(){var e=[],s=PageData.user?PageData.user.Parr_props?PageData.user.Parr_props.level?PageData.user.Parr_props.level:{}:{}:{},i=PageData.forum.name||PageData.forum.forum_name;return e.push('<div class="userlike_supermember">'),e.push('<div class="userlike_sm_up clearfix">'),e.push('<div class="userlike_sm_up_gift"></div>'),e.push('<div class="userlike_sm_up_info">'),e.push('<h3>\u5C0A\u8D35\u7684<span class="userlike_sm_up_icon">\u8D34\u5427\u8D85\u7EA7\u4F1A\u5458</span></h3>'),e.push("<h2>\u60A8\u5DF2\u6210\u529F\u83B7\u5F97<b>\u3010"+i+"\u5427\u7279\u6743\u5305\u3011</b></h2>"),e.push("<p>\u6709\u6548\u671F\u81F3"+this.getFormatZhTime(1e3*s.end_time)+"</p>"),e.push("</div>"),e.push("</div>"),e.push('<div class="userlike_sm_down clearfix">'),e.push('<div class="userlike_sm_down_item">'),e.push('<div class="userlike_sm_down_title">\u7EA2\u8272\u6807\u9898</div>'),e.push('<div class="userlike_sm_down_pic userlike_sm_down_pic_1"></div>'),e.push("</div>"),e.push('<div class="userlike_sm_down_item">'),e.push('<div class="userlike_sm_down_title">\u7ECF\u9A8C\u52A0\u901F</div>'),e.push('<div class="userlike_sm_down_pic userlike_sm_down_pic_2"></div>'),e.push("</div>"),e.push("</div>"),e.push("</div>"),e.join("")},isSuperMember:function(){var e=PageUnit.load("like_tip_svip_black_list");if(e)return!1;var s=PageData.user?PageData.user.Parr_props?PageData.user.Parr_props.level?PageData.user.Parr_props.level:{}:{}:{};return 1e3*s.end_time>1*new Date&&2===s.props_id&&!PageData.forum.is_star},getFormatZhTime:function(e){return"number"!=typeof e?"":(e=new Date(e),[e.getFullYear()+"\u5E74",parseInt(e.getMonth()+1)+"\u6708",e.getDate()+"\u65E5"].join(""))}}});_.Module.define({path:"tbmall/component/captcha_payment",sub:{initial:function(a){this.reCommitUrl=a.url,this.data=a.data},showCaptcha:function(a,t){var e=this,c=PageData.tbs||PageData.user.tbs,o=2150040==e.data.no?"\u6B63\u786E\u8F93\u5165\u9A8C\u8BC1\u7801\u540E\uFF0C\u53EF\u7EE7\u7EED\u8D2D\u4E70":"\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";this.requireInstanceAsync("common/component/CaptchaDialog",{message:e.data.data.captcha_str_reason,vCode:e.data.data.captcha_vcode_str,vCodeType:e.data.data.captcha_code_type,exceptionalAccount:0,title:"T\u8C46\u652F\u4ED8\u9A8C\u8BC1\u7801",message:o,forumName:"",modal:!0,forumId:0,checkUrl:"/tbmall/vcode/safecheckvcode?tbs="+c,vCodeUrl:"/tbmall/vcode/safegetvcode",paramsCallback:function(){return{tbs:c}}},function(e){e.bind("onclose",function(){e.hide(),$.tb.location.reload()}),e.bind("onaccept",function(){var c={};c.captcha_input_str=e.getInputValue(),c.captcha_vcode_str=e.getVCode(),"function"==typeof a&&(t?a.call(t,c):a(c))}),e.show()})}}});_.Module.define({path:"tbmall/widget/paykey_rsa",requires:[],sub:{RSA:{},publicKey:"",setKey:function(){this.publicKey=pkey},getKey:function(){var t=this;$.ajax({url:"/tbmall/pass/getpubkey",type:"get",dataType:"json",success:function(e){PageData.publicKey=e.data.pubkey,t.publicKey=PageData.publicKey}})},vcode:function(t){var e=new this.RSA;return e.setKey(this.publicKey),encodeURIComponent(e.encrypt(t))},initial:function(t){var e=this,i=$.extend({},t);PageData.publicKey||i.publicKey?this.publicKey=PageData.publicKey:this.getKey(),function(t){function e(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new e(null)}function r(t,e,i,r,s,n){for(;--n>=0;){var o=e*this[t++]+i[r]+s;s=Math.floor(o/67108864),i[r++]=67108863&o}return s}function s(t,e,i,r,s,n){for(var o=32767&e,h=e>>15;--n>=0;){var a=32767&this[t],u=this[t++]>>15,c=h*a+u*o;a=o*a+((32767&c)<<15)+i[r]+(1073741823&s),s=(a>>>30)+(c>>>15)+h*u+(s>>>30),i[r++]=1073741823&a}return s}function n(t,e,i,r,s,n){for(var o=16383&e,h=e>>14;--n>=0;){var a=16383&this[t],u=this[t++]>>14,c=h*a+u*o;a=o*a+((16383&c)<<14)+i[r]+s,s=(a>>28)+(c>>14)+h*u,i[r++]=268435455&a}return s}function o(t){return Ui.charAt(t)}function h(t,e){var i=Oi[t.charCodeAt(e)];return null==i?-1:i}function a(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function c(t){var e=i();return e.fromInt(t),e}function f(t,i){var r;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;else if(32==i)r=5;else{if(4!=i)return this.fromRadix(t,i),void 0;r=2}this.t=0,this.s=0;for(var s=t.length,n=!1,o=0;--s>=0;){var a=8==r?255&t[s]:h(t,s);0>a?"-"==t.charAt(s)&&(n=!0):(n=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=r,o>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&e.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function l(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,s=!1,n="",h=this.t,a=this.DB-h*this.DB%e;if(h-->0)for(a<this.DB&&(i=this[h]>>a)>0&&(s=!0,n=o(i));h>=0;)e>a?(i=(this[h]&(1<<a)-1)<<e-a,i|=this[--h]>>(a+=this.DB-e)):(i=this[h]>>(a-=e)&r,0>=a&&(a+=this.DB,--h)),i>0&&(s=!0),s&&(n+=o(i));return s?n:"0"}function d(){var t=i();return e.ZERO.subTo(this,t),t}function g(){return this.s<0?this.negate():this}function y(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(e=i-t.t,0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function m(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function b(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function T(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function S(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function R(t,e){var i,r=t%this.DB,s=this.DB-r,n=(1<<s)-1,o=Math.floor(t/this.DB),h=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>s|h,h=(this[i]&n)<<r;for(i=o-1;i>=0;--i)e[i]=0;e[o]=h,e.t=this.t+o+1,e.s=this.s,e.clamp()}function D(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return e.t=0,void 0;var r=t%this.DB,s=this.DB-r,n=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&n)<<s,e[o-i]=this[o]>>r;r>0&&(e[this.t-i-1]|=(this.s&n)<<s),e.t=this.t-i,e.clamp()}function E(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=0>r?-1:0,-1>r?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()}function x(t,i){var r=this.abs(),s=t.abs(),n=r.t;for(i.t=n+s.t;--n>=0;)i[n]=0;for(n=0;n<s.t;++n)i[n+r.t]=r.am(0,s[n],i,n,0,r.t);i.s=0,i.clamp(),this.s!=t.s&&e.ZERO.subTo(i,i)}function w(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function K(t,r,s){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=r&&r.fromInt(0),null!=s&&this.copyTo(s),void 0;null==s&&(s=i());var h=i(),a=this.s,u=t.s,c=this.DB-m(n[n.t-1]);c>0?(n.lShiftTo(c,h),o.lShiftTo(c,s)):(n.copyTo(h),o.copyTo(s));var f=h.t,p=h[f-1];if(0!=p){var l=p*(1<<this.F1)+(f>1?h[f-2]>>this.F2:0),d=this.FV/l,g=(1<<this.F1)/l,y=1<<this.F2,v=s.t,b=v-f,T=null==r?i():r;for(h.dlShiftTo(b,T),s.compareTo(T)>=0&&(s[s.t++]=1,s.subTo(T,s)),e.ONE.dlShiftTo(f,T),T.subTo(h,h);h.t<f;)h[h.t++]=0;for(;--b>=0;){var S=s[--v]==p?this.DM:Math.floor(s[v]*d+(s[v-1]+y)*g);if((s[v]+=h.am(0,S,s,b,0,f))<S)for(h.dlShiftTo(b,T),s.subTo(T,s);s[v]<--S;)s.subTo(T,s)}null!=r&&(s.drShiftTo(f,r),a!=u&&e.ZERO.subTo(r,r)),s.t=f,s.clamp(),c>0&&s.rShiftTo(c,s),0>a&&e.ZERO.subTo(s,s)}}}function A(t){var r=i();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r}function B(t){this.m=t}function U(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function O(t){return t}function V(t){t.divRemTo(this.m,null,t)}function N(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function J(t,e){t.squareTo(e),this.reduce(e)}function I(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function P(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t){var r=i();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r}function L(t){var e=i();return t.copyTo(e),this.reduce(e),e}function q(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function C(t,e){t.squareTo(e),this.reduce(e)}function H(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function j(){return 0==(this.t>0?1&this[0]:this.s)}function k(t,r){if(t>4294967295||1>t)return e.ONE;var s=i(),n=i(),o=r.convert(this),h=m(t)-1;for(o.copyTo(s);--h>=0;)if(r.sqrTo(s,n),(t&1<<h)>0)r.mulTo(n,o,s);else{var a=s;s=n,n=a}return r.revert(s)}function F(t,e){var i;return i=256>t||e.isEven()?new B(e):new P(e),this.exp(t,i)}function _(){var t=i();return this.copyTo(t),t}function z(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return 0==this.t?this.s:this[0]<<24>>24}function G(){return 0==this.t?this.s:this[0]<<16>>16}function Y(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),s=c(r),n=i(),o=i(),h="";for(this.divRemTo(s,n,o);n.signum()>0;)h=(r+o.intValue()).toString(t).substr(1)+h,n.divRemTo(s,n,o);return o.intValue().toString(t)+h}function X(t,i){this.fromInt(0),null==i&&(i=10);for(var r=this.chunkSize(i),s=Math.pow(i,r),n=!1,o=0,a=0,u=0;u<t.length;++u){var c=h(t,u);0>c?"-"==t.charAt(u)&&0==this.signum()&&(n=!0):(a=i*a+c,++o>=r&&(this.dMultiply(s),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(i,o)),this.dAddOffset(a,0)),n&&e.ZERO.subTo(this,this)}function te(t,i,r){if("number"==typeof i)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var s=new Array,n=7&t;s.length=(t>>3)+1,i.nextBytes(s),n>0?s[0]&=(1<<n)-1:s[0]=0,this.fromString(s,256)}}function ee(){var t=this.t,e=new Array;e[0]=this.s;var i,r=this.DB-t*this.DB%8,s=0;if(t-->0)for(r<this.DB&&(i=this[t]>>r)!=(this.s&this.DM)>>r&&(e[s++]=i|this.s<<this.DB-r);t>=0;)8>r?(i=(this[t]&(1<<r)-1)<<8-r,i|=this[--t]>>(r+=this.DB-8)):(i=this[t]>>(r-=8)&255,0>=r&&(r+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==s&&(128&this.s)!=(128&i)&&++s,(s>0||i!=this.s)&&(e[s++]=i);return e}function ie(t){return 0==this.compareTo(t)}function re(t){return this.compareTo(t)<0?this:t}function se(t){return this.compareTo(t)>0?this:t}function ne(t,e,i){var r,s,n=Math.min(t.t,this.t);for(r=0;n>r;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(s=t.s&this.DM,r=n;r<this.t;++r)i[r]=e(this[r],s);i.t=this.t}else{for(s=this.s&this.DM,r=n;r<t.t;++r)i[r]=e(s,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function oe(t,e){return t&e}function he(t){var e=i();return this.bitwiseTo(t,oe,e),e}function ae(t,e){return t|e}function ue(t){var e=i();return this.bitwiseTo(t,ae,e),e}function ce(t,e){return t^e}function fe(t){var e=i();return this.bitwiseTo(t,ce,e),e}function pe(t,e){return t&~e}function le(t){var e=i();return this.bitwiseTo(t,pe,e),e}function de(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function ge(t){var e=i();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ye(t){var e=i();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function me(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function ve(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+me(this[t]);return this.s<0?this.t*this.DB:-1}function be(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Te(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=be(this[i]^e);return t}function Se(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Re(t,i){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,i,r),r}function De(t){return this.changeBit(t,ae)}function Ee(t){return this.changeBit(t,pe)}function xe(t){return this.changeBit(t,ce)}function we(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=0>r?-1:0,r>0?e[i++]=r:-1>r&&(e[i++]=this.DV+r),e.t=i,e.clamp()}function Ke(t){var e=i();return this.addTo(t,e),e}function Ae(t){var e=i();return this.subTo(t,e),e}function Be(t){var e=i();return this.multiplyTo(t,e),e}function Ue(){var t=i();return this.squareTo(t),t}function Oe(t){var e=i();return this.divRemTo(t,e,null),e}function Ve(t){var e=i();return this.divRemTo(t,null,e),e}function Ne(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)}function Je(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ie(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Pe(){}function Me(t){return t}function Le(t,e,i){t.multiplyTo(e,i)}function qe(t,e){t.squareTo(e)}function Ce(t){return this.exp(t,new Pe)}function He(t,e,i){var r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;var s;for(s=i.t-this.t;s>r;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(s=Math.min(t.t,e);s>r;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function je(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}function ke(t){this.r2=i(),this.q3=i(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Fe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function _e(t){return t}function ze(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ze(t,e){t.squareTo(e),this.reduce(e)}function Ge(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function $e(t,e){var r,s,n=t.bitLength(),o=c(1);if(0>=n)return o;r=18>n?1:48>n?3:144>n?4:768>n?5:6,s=8>n?new B(e):e.isEven()?new ke(e):new P(e);var h=new Array,a=3,u=r-1,f=(1<<r)-1;if(h[1]=s.convert(this),r>1){var p=i();for(s.sqrTo(h[1],p);f>=a;)h[a]=i(),s.mulTo(p,h[a-2],h[a]),a+=2}var l,d,g=t.t-1,y=!0,v=i();for(n=m(t[g])-1;g>=0;){for(n>=u?l=t[g]>>n-u&f:(l=(t[g]&(1<<n+1)-1)<<u-n,g>0&&(l|=t[g-1]>>this.DB+n-u)),a=r;0==(1&l);)l>>=1,--a;if((n-=a)<0&&(n+=this.DB,--g),y)h[l].copyTo(o),y=!1;else{for(;a>1;)s.sqrTo(o,v),s.sqrTo(v,o),a-=2;a>0?s.sqrTo(o,v):(d=o,o=v,v=d),s.mulTo(v,h[l],o)}for(;g>=0&&0==(t[g]&1<<n);)s.sqrTo(o,v),d=o,o=v,v=d,--n<0&&(n=this.DB-1,--g)}return s.revert(o)}function Ye(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var s=e.getLowestSetBit(),n=i.getLowestSetBit();if(0>n)return e;for(n>s&&(n=s),n>0&&(e.rShiftTo(n,e),i.rShiftTo(n,i));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i}function We(t){if(0>=t)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}function Qe(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return e.ZERO;for(var r=t.clone(),s=this.clone(),n=c(1),o=c(0),h=c(0),a=c(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),i?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;s.isEven();)s.rShiftTo(1,s),i?(h.isEven()&&a.isEven()||(h.addTo(this,h),a.subTo(t,a)),h.rShiftTo(1,h)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(s)>=0?(r.subTo(s,r),i&&n.subTo(h,n),o.subTo(a,o)):(s.subTo(r,s),i&&h.subTo(n,h),a.subTo(o,a))}return 0!=s.compareTo(e.ONE)?e.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function Xe(t){var e,i=this.abs();if(1==i.t&&i[0]<=Vi[Vi.length-1]){for(e=0;e<Vi.length;++e)if(i[0]==Vi[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<Vi.length;){for(var r=Vi[e],s=e+1;s<Vi.length&&Ni>r;)r*=Vi[s++];for(r=i.modInt(r);s>e;)if(r%Vi[e++]==0)return!1}return i.millerRabin(t)}function ti(t){var r=this.subtract(e.ONE),s=r.getLowestSetBit();if(0>=s)return!1;var n=r.shiftRight(s);t=t+1>>1,t>Vi.length&&(t=Vi.length);for(var o=i(),h=0;t>h;++h){o.fromInt(Vi[Math.floor(Math.random()*Vi.length)]);var a=o.modPow(n,this);if(0!=a.compareTo(e.ONE)&&0!=a.compareTo(r)){for(var u=1;u++<s&&0!=a.compareTo(r);)if(a=a.modPowInt(2,this),0==a.compareTo(e.ONE))return!1;if(0!=a.compareTo(r))return!1}}return!0}function ei(){this.i=0,this.j=0,this.S=new Array}function ii(t){var e,i,r;for(e=0;256>e;++e)this.S[e]=e;for(i=0,e=0;256>e;++e)i=i+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[i],this.S[i]=r;this.i=0,this.j=0}function ri(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function si(){return new ei}function ni(t){Ii[Pi++]^=255&t,Ii[Pi++]^=t>>8&255,Ii[Pi++]^=t>>16&255,Ii[Pi++]^=t>>24&255,Pi>=Mi&&(Pi-=Mi)}function oi(){ni((new Date).getTime())}function hi(){if(null==Ji){for(oi(),Ji=si(),Ji.init(Ii),Pi=0;Pi<Ii.length;++Pi)Ii[Pi]=0;Pi=0}return Ji.next()}function ai(t){var e;for(e=0;e<t.length;++e)t[e]=hi()}function ui(){}function ci(t,i){return new e(t,i)}function fi(t,i){if(i<t.length+11)return console.error("Message too long for RSA"),null;for(var r=new Array,s=t.length-1;s>=0&&i>0;){var n=t.charCodeAt(s--);128>n?r[--i]=n:n>127&&2048>n?(r[--i]=63&n|128,r[--i]=n>>6|192):(r[--i]=63&n|128,r[--i]=n>>6&63|128,r[--i]=n>>12|224)}r[--i]=0;for(var o=new ui,h=new Array;i>2;){for(h[0]=0;0==h[0];)o.nextBytes(h);r[--i]=h[0]}return r[--i]=2,r[--i]=0,new e(r)}function pi(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function li(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")}function di(t){return t.modPowInt(this.e,this.n)}function gi(t){var e=fi(t,this.n.bitLength()+7>>3);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;var r=i.toString(16);return 0==(1&r.length)?r:"0"+r}function yi(t,e){for(var i=t.toByteArray(),r=0;r<i.length&&0==i[r];)++r;if(i.length-r!=e-1||2!=i[r])return null;for(++r;0!=i[r];)if(++r>=i.length)return null;for(var s="";++r<i.length;){var n=255&i[r];128>n?s+=String.fromCharCode(n):n>191&&224>n?(s+=String.fromCharCode((31&n)<<6|63&i[r+1]),++r):(s+=String.fromCharCode((15&n)<<12|(63&i[r+1])<<6|63&i[r+2]),r+=2)}return s}function mi(t,e,i){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16)):console.error("Invalid RSA private key")}function vi(t,e,i,r,s,n,o,h){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16),this.p=ci(r,16),this.q=ci(s,16),this.dmp1=ci(n,16),this.dmq1=ci(o,16),this.coeff=ci(h,16)):console.error("Invalid RSA private key")}function bi(t,i){var r=new ui,s=t>>1;this.e=parseInt(i,16);for(var n=new e(i,16);;){for(;this.p=new e(t-s,1,r),0!=this.p.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.p.isProbablePrime(10););for(;this.q=new e(s,1,r),0!=this.q.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var h=this.p.subtract(e.ONE),a=this.q.subtract(e.ONE),u=h.multiply(a);if(0==u.gcd(n).compareTo(e.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(u),this.dmp1=this.d.mod(h),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function Ti(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function Si(t){var e=ci(t,16),i=this.doPrivate(e);return null==i?null:yi(i,this.n.bitLength()+7>>3)}function Ri(t){var e,i,r="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),r+=Ci.charAt(i>>6)+Ci.charAt(63&i);for(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),r+=Ci.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),r+=Ci.charAt(i>>2)+Ci.charAt((3&i)<<4));(3&r.length)>0;)r+=Hi;return r}function Di(t){var e,i,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=Hi;++e)v=Ci.indexOf(t.charAt(e)),0>v||(0==s?(r+=o(v>>2),i=3&v,s=1):1==s?(r+=o(i<<2|v>>4),i=15&v,s=2):2==s?(r+=o(i),r+=o(v>>2),i=3&v,s=3):(r+=o(i<<2|v>>4),r+=o(15&v),s=0));return 1==s&&(r+=o(i<<2)),r}var Ei,xi=0xdeadbeefcafe,wi=15715070==(16777215&xi);wi&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=s,Ei=30):wi&&"Netscape"!=navigator.appName?(e.prototype.am=r,Ei=26):(e.prototype.am=n,Ei=28),e.prototype.DB=Ei,e.prototype.DM=(1<<Ei)-1,e.prototype.DV=1<<Ei;var Ki=52;e.prototype.FV=Math.pow(2,Ki),e.prototype.F1=Ki-Ei,e.prototype.F2=2*Ei-Ki;var Ai,Bi,Ui="0123456789abcdefghijklmnopqrstuvwxyz",Oi=new Array;for(Ai="0".charCodeAt(0),Bi=0;9>=Bi;++Bi)Oi[Ai++]=Bi;for(Ai="a".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;for(Ai="A".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;B.prototype.convert=U,B.prototype.revert=O,B.prototype.reduce=V,B.prototype.mulTo=N,B.prototype.sqrTo=J,P.prototype.convert=M,P.prototype.revert=L,P.prototype.reduce=q,P.prototype.mulTo=H,P.prototype.sqrTo=C,e.prototype.copyTo=a,e.prototype.fromInt=u,e.prototype.fromString=f,e.prototype.clamp=p,e.prototype.dlShiftTo=T,e.prototype.drShiftTo=S,e.prototype.lShiftTo=R,e.prototype.rShiftTo=D,e.prototype.subTo=E,e.prototype.multiplyTo=x,e.prototype.squareTo=w,e.prototype.divRemTo=K,e.prototype.invDigit=I,e.prototype.isEven=j,e.prototype.exp=k,e.prototype.toString=l,e.prototype.negate=d,e.prototype.abs=g,e.prototype.compareTo=y,e.prototype.bitLength=b,e.prototype.mod=A,e.prototype.modPowInt=F,e.ZERO=c(0),e.ONE=c(1),Pe.prototype.convert=Me,Pe.prototype.revert=Me,Pe.prototype.mulTo=Le,Pe.prototype.sqrTo=qe,ke.prototype.convert=Fe,ke.prototype.revert=_e,ke.prototype.reduce=ze,ke.prototype.mulTo=Ge,ke.prototype.sqrTo=Ze;var Vi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ni=(1<<26)/Vi[Vi.length-1];e.prototype.chunkSize=Y,e.prototype.toRadix=Q,e.prototype.fromRadix=X,e.prototype.fromNumber=te,e.prototype.bitwiseTo=ne,e.prototype.changeBit=Re,e.prototype.addTo=we,e.prototype.dMultiply=Je,e.prototype.dAddOffset=Ie,e.prototype.multiplyLowerTo=He,e.prototype.multiplyUpperTo=je,e.prototype.modInt=We,e.prototype.millerRabin=ti,e.prototype.clone=_,e.prototype.intValue=z,e.prototype.byteValue=Z,e.prototype.shortValue=G,e.prototype.signum=W,e.prototype.toByteArray=ee,e.prototype.equals=ie,e.prototype.min=re,e.prototype.max=se,e.prototype.and=he,e.prototype.or=ue,e.prototype.xor=fe,e.prototype.andNot=le,e.prototype.not=de,e.prototype.shiftLeft=ge,e.prototype.shiftRight=ye,e.prototype.getLowestSetBit=ve,e.prototype.bitCount=Te,e.prototype.testBit=Se,e.prototype.setBit=De,e.prototype.clearBit=Ee,e.prototype.flipBit=xe,e.prototype.add=Ke,e.prototype.subtract=Ae,e.prototype.multiply=Be,e.prototype.divide=Oe,e.prototype.remainder=Ve,e.prototype.divideAndRemainder=Ne,e.prototype.modPow=$e,e.prototype.modInverse=Qe,e.prototype.pow=Ce,e.prototype.gcd=Ye,e.prototype.isProbablePrime=Xe,e.prototype.square=Ue,ei.prototype.init=ii,ei.prototype.next=ri;var Ji,Ii,Pi,Mi=256;if(null==Ii){Ii=new Array,Pi=0;var Li;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var qi=window.crypto.random(32);for(Li=0;Li<qi.length;++Li)Ii[Pi++]=255&qi.charCodeAt(Li)}for(;Mi>Pi;)Li=Math.floor(65536*Math.random()),Ii[Pi++]=Li>>>8,Ii[Pi++]=255&Li;Pi=0,oi()}ui.prototype.nextBytes=ai,pi.prototype.doPublic=di,pi.prototype.setPublic=li,pi.prototype.encrypt=gi,pi.prototype.doPrivate=Ti,pi.prototype.setPrivate=mi,pi.prototype.setPrivateEx=vi,pi.prototype.generate=bi,pi.prototype.decrypt=Si,function(){var t=function(t,r,s){var n=new ui,o=t>>1;this.e=parseInt(r,16);var h=new e(r,16),a=this,u=function(){var r=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var i=a.p.subtract(e.ONE),r=a.q.subtract(e.ONE),n=i.multiply(r);0==n.gcd(h).compareTo(e.ONE)?(a.n=a.p.multiply(a.q),a.d=h.modInverse(n),a.dmp1=a.d.mod(i),a.dmq1=a.d.mod(r),a.coeff=a.q.modInverse(a.p),setTimeout(function(){s()},0)):setTimeout(u,0)},c=function(){a.q=i(),a.q.fromNumberAsync(o,1,n,function(){a.q.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.q.isProbablePrime(10)?setTimeout(r,0):setTimeout(c,0)})})},f=function(){a.p=i(),a.p.fromNumberAsync(t-o,1,n,function(){a.p.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(f,0)})})};setTimeout(f,0)};setTimeout(u,0)};pi.prototype.generateAsync=t;var r=function(t,e){var i=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var s=i;i=r,r=s}var n=i.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return e(i),void 0;o>n&&(o=n),o>0&&(i.rShiftTo(o,i),r.rShiftTo(o,r));var h=function(){(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),i.compareTo(r)>=0?(i.subTo(r,i),i.rShiftTo(1,i)):(r.subTo(i,r),r.rShiftTo(1,r)),i.signum()>0?setTimeout(h,0):(o>0&&r.lShiftTo(o,r),setTimeout(function(){e(r)},0))};setTimeout(h,10)};e.prototype.gcda=r;var s=function(t,i,r,s){if("number"==typeof i)if(2>t)this.fromInt(1);else{this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);var n=this,o=function(){n.dAddOffset(2,0),n.bitLength()>t&&n.subTo(e.ONE.shiftLeft(t-1),n),n.isProbablePrime(i)?setTimeout(function(){s()},0):setTimeout(o,0)};setTimeout(o,0)}else{var h=new Array,a=7&t;h.length=(t>>3)+1,i.nextBytes(h),a>0?h[0]&=(1<<a)-1:h[0]=0,this.fromString(h,256)}};e.prototype.fromNumberAsync=s}();var Ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hi="=",ji=ji||{};ji.env=ji.env||{};var ki=ji,Fi=Object.prototype,_i="[object Function]",zi=["toString","valueOf"];ji.env.parseUA=function(t){var e,i=function(t){var e=0;return parseFloat(t.replace(/\./g,function(){return 1==e++?"":"."}))},r=navigator,s={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:r&&r.cajaVersion,secure:!1,os:null},n=t||navigator&&navigator.userAgent,o=$.tb.location,h=o&&o.getHref();return s.secure=h&&0===h.toLowerCase().indexOf("https"),n&&(/windows|win32/i.test(n)?s.os="windows":/macintosh/i.test(n)?s.os="macintosh":/rhino/i.test(n)&&(s.os="rhino"),/KHTML/.test(n)&&(s.webkit=1),e=n.match(/AppleWebKit\/([^\s]*)/),e&&e[1]&&(s.webkit=i(e[1]),/ Mobile\//.test(n)?(s.mobile="Apple",e=n.match(/OS ([^\s]*)/),e&&e[1]&&(e=i(e[1].replace("_","."))),s.ios=e,s.ipad=s.ipod=s.iphone=0,e=n.match(/iPad|iPod|iPhone/),e&&e[0]&&(s[e[0].toLowerCase()]=s.ios)):(e=n.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),e&&(s.mobile=e[0]),/webOS/.test(n)&&(s.mobile="WebOS",e=n.match(/webOS\/([^\s]*);/),e&&e[1]&&(s.webos=i(e[1]))),/ Android/.test(n)&&(s.mobile="Android",e=n.match(/Android ([^\s]*);/),e&&e[1]&&(s.android=i(e[1])))),e=n.match(/Chrome\/([^\s]*)/),e&&e[1]?s.chrome=i(e[1]):(e=n.match(/AdobeAIR\/([^\s]*)/),e&&(s.air=e[0]))),s.webkit||(e=n.match(/Opera[\s\/]([^\s]*)/),e&&e[1]?(s.opera=i(e[1]),e=n.match(/Version\/([^\s]*)/),e&&e[1]&&(s.opera=i(e[1])),e=n.match(/Opera Mini[^;]*/),e&&(s.mobile=e[0])):(e=n.match(/MSIE\s([^;]*)/),e&&e[1]?s.ie=i(e[1]):(e=n.match(/Gecko\/([^\s]*)/),e&&(s.gecko=1,e=n.match(/rv:([^\s\)]*)/),e&&e[1]&&(s.gecko=i(e[1]))))))),s},ji.env.ua=ji.env.parseUA(),ji.isFunction=function(t){return"function"==typeof t||Fi.toString.apply(t)===_i},ji._IEEnumFix=ji.env.ua.ie?function(t,e){var i,r,s;for(i=0;i<zi.length;i+=1)r=zi[i],s=e[r],ki.isFunction(s)&&s!=Fi[r]&&(t[r]=s)}:function(){},ji.extend=function(t,e,i){if(!e||!t)throw new Error("extend failed, please check that all dependencies are included.");var r,s=function(){};if(s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Fi.constructor&&(e.prototype.constructor=e),i){for(r in i)ki.hasOwnProperty(i,r)&&(t.prototype[r]=i[r]);ki._IEEnumFix(t.prototype,i)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var r=i.substr(1),s=r.length;s%2==1?s+=1:i.match(/^[0-7]/)||(s+=2);for(var n="",o=0;s>o;o++)n+="f";var h=new e(n,16),a=h.xor(t).add(e.ONE);i=a.toString(16).replace(/^-/,"")}return i},this.getPEMStringFromHex=function(t,e){var i=CryptoJS.enc.Hex.parse(t),r=CryptoJS.enc.Base64.stringify(i),s=r.replace(/(.{64})/g,"$1\r\n");return s=s.replace(/\r\n$/,""),"-----BEGIN "+e+"-----\r\n"+s+"\r\n-----END "+e+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+t.length+",v="+this.hV;var e=this.hV.length/2,i=e.toString(16);if(i.length%2==1&&(i="0"+i),128>e)return i;var r=i.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);var s=128+r;return s.toString(16)+i},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex&&this.setStringHex(t.hex))},ji.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){utc=t.getTime()+6e4*t.getTimezoneOffset();var e=new Date(utc);return e},this.formatDate=function(t,e){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var n=i(String(r.getMonth()+1),2),o=i(String(r.getDate()),2),h=i(String(r.getHours()),2),a=i(String(r.getMinutes()),2),u=i(String(r.getSeconds()),2);return s+n+o+h+a+u+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(t,e,i,r,s,n){var o=new Date(Date.UTC(t,e-1,i,r,s,n,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ji.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,"undefined"!=typeof t&&"undefined"!=typeof t.array&&(this.asn1Array=t.array)},ji.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ji.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var i=new e(String(t),10);this.setByBigInteger(i)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.bigint?this.setByBigInteger(t.bigint):"undefined"!=typeof t["int"]?this.setByInteger(t["int"]):"undefined"!=typeof t.hex&&this.setValueHex(t.hex))},ji.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t
},this.setUnusedBitsAndHexValue=function(t,e){if(0>t||t>7)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var e=8-t.length%8;8==e&&(e=0);for(var i=0;e>=i;i++)t+="0";for(var r="",i=0;i<t.length-1;i+=8){var s=t.substr(i,8),n=parseInt(s,2).toString(16);1==n.length&&(n="0"+n),r+=n}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)e+=1==t[i]?"1":"0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;t>i;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.hex?this.setHexValueIncludingUnusedBits(t.hex):"undefined"!=typeof t.bin?this.setByBinaryString(t.bin):"undefined"!=typeof t.array&&this.setByBooleanArray(t.array))},ji.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ji.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ji.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(t){var i=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},r=function(t){var r="",s=new e(t,10),n=s.toString(2),o=7-n.length%7;7==o&&(o=0);for(var h="",a=0;o>a;a++)h+="0";n=h+n;for(var a=0;a<n.length-1;a+=7){var u=n.substr(a,7);a!=n.length-7&&(u="1"+u),r+=i(parseInt(u,2))}return r};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var e="",s=t.split("."),n=40*parseInt(s[0])+parseInt(s[1]);e+=i(n),s.splice(0,2);for(var o=0;o<s.length;o++)e+=r(s[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueName=function(t){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[t])throw"DERObjectIdentifier oidName undefined: "+t;var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.oid?this.setValueOidString(t.oid):"undefined"!=typeof t.hex?this.setValueHex(t.hex):"undefined"!=typeof t.name&&this.setValueName(t.name))},ji.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ji.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ji.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ji.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ji.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ji.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t+=i.getEncodedHex()}return this.hV=t,this.hV}},ji.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}},ji.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.tag&&(this.hT=t.tag),"undefined"!=typeof t.explicit&&(this.isExplicit=t.explicit),"undefined"!=typeof t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ji.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="0123456789ABCDEF",n=" \f\n\r	 \u2028\u2029";for(e=[],r=0;16>r;++r)e[s.charAt(r)]=r;for(s=s.toLowerCase(),r=10;16>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=2?(o[o.length]=h,h=0,a=0):h<<=4}}if(a)throw"Hex encoding incomplete: 4 bits missing";return o},window.Hex=i}(),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="= \f\n\r	 \u2028\u2029";for(e=[],r=0;64>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=4?(o[o.length]=h>>16,o[o.length]=h>>8&255,o[o.length]=255&h,h=0,a=0):h<<=6}}switch(a){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:o[o.length]=h>>10;break;case 3:o[o.length]=h>>16,o[o.length]=h>>8&255}return o},i.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,i.unarmor=function(t){var e=i.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw"RegExp out of sync";t=e[2]}return i.decode(t)},window.Base64=i}(),function(t){"use strict";function e(t,i){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=i)}function i(t,e,i,r,s){this.stream=t,this.header=e,this.length=i,this.tag=r,this.sub=s}var r=100,s="\u2026",n={tag:function(t,e){var i=document.createElement(t);return i.className=e,i},text:function(t){return document.createTextNode(t)}};e.prototype.get=function(e){if(e===t&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},e.prototype.hexDump=function(t,e,i){for(var r="",s=t;e>s;++s)if(r+=this.hexByte(this.get(s)),i!==!0)switch(15&s){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},e.prototype.parseStringISO=function(t,e){for(var i="",r=t;e>r;++r)i+=String.fromCharCode(this.get(r));return i},e.prototype.parseStringUTF=function(t,e){for(var i="",r=t;e>r;){var s=this.get(r++);i+=128>s?String.fromCharCode(s):s>191&&224>s?String.fromCharCode((31&s)<<6|63&this.get(r++)):String.fromCharCode((15&s)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return i},e.prototype.parseStringBMP=function(t,e){for(var i="",r=t;e>r;r+=2){var s=this.get(r),n=this.get(r+1);i+=String.fromCharCode((s<<8)+n)}return i},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(t,e){var i=this.parseStringISO(t,e),r=this.reTime.exec(i);return r?(i=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(i+=":"+r[5],r[6]&&(i+=":"+r[6],r[7]&&(i+="."+r[7]))),r[8]&&(i+=" UTC","Z"!=r[8]&&(i+=r[8],r[9]&&(i+=":"+r[9]))),i):"Unrecognized time: "+i},e.prototype.parseInteger=function(t,e){var i=e-t;if(i>4){i<<=3;var r=this.get(t);if(0===r)i-=8;else for(;128>r;)r<<=1,--i;return"("+i+" bit)"}for(var s=0,n=t;e>n;++n)s=s<<8|this.get(n);return s},e.prototype.parseBitString=function(t,e){var i=this.get(t),r=(e-t-1<<3)-i,s="("+r+" bit)";if(20>=r){var n=i;s+=" ";for(var o=e-1;o>t;--o){for(var h=this.get(o),a=n;8>a;++a)s+=h>>a&1?"1":"0";n=0}}return s},e.prototype.parseOctetString=function(t,e){var i=e-t,n="("+i+" byte) ";i>r&&(e=t+r);for(var o=t;e>o;++o)n+=this.hexByte(this.get(o));return i>r&&(n+=s),n},e.prototype.parseOID=function(t,e){for(var i="",r=0,s=0,n=t;e>n;++n){var o=this.get(n);if(r=r<<7|127&o,s+=7,!(128&o)){if(""===i){var h=80>r?40>r?0:1:2;i=h+"."+(r-40*h)}else i+="."+(s>=31?"bigint":r);r=s=0}}return i},i.prototype.typeName=function(){if(this.tag===t)return"unknown";var e=this.tag>>6,i=(this.tag>>5&1,31&this.tag);switch(e){case 0:switch(i){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+i.toString(16)}case 1:return"Application_"+i.toString(16);case 2:return"["+i+"]";case 3:return"Private_"+i.toString(16)}},i.prototype.reSeemsASCII=/^[ -~]+$/,i.prototype.content=function(){if(this.tag===t)return null;var e=this.tag>>6,i=31&this.tag,n=this.posContent(),o=Math.abs(this.length);if(0!==e){if(null!==this.sub)return"("+this.sub.length+" elem)";var h=this.stream.parseStringISO(n,n+Math.min(o,r));return this.reSeemsASCII.test(h)?h.substring(0,2*r)+(h.length>2*r?s:""):this.stream.parseOctetString(n,n+o)}switch(i){case 1:return 0===this.stream.get(n)?"false":"true";case 2:return this.stream.parseInteger(n,n+o);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+o);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+o);case 6:return this.stream.parseOID(n,n+o);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+o);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+o);case 30:return this.stream.parseStringBMP(n,n+o);case 23:case 24:return this.stream.parseTime(n,n+o)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},i.prototype.print=function(e){if(e===t&&(e=""),document.writeln(e+this),null!==this.sub){e+="  ";for(var i=0,r=this.sub.length;r>i;++i)this.sub[i].print(e)}},i.prototype.toPrettyString=function(e){e===t&&(e="");var i=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(i+="+"),i+=this.length,32&this.tag?i+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+=" (encapsulates)"),i+="\n",null!==this.sub){e+="  ";for(var r=0,s=this.sub.length;s>r;++r)i+=this.sub[r].toPrettyString(e)}return i},i.prototype.toDOM=function(){var t=n.tag("div","node");t.asn1=this;var e=n.tag("div","head"),i=this.typeName().replace(/_/g," ");e.innerHTML=i;var r=this.content();if(null!==r){r=String(r).replace(/</g,"&lt;");var s=n.tag("span","preview");s.appendChild(n.text(r)),e.appendChild(s)}t.appendChild(e),this.node=t,this.head=e;var o=n.tag("div","value");if(i="Offset: "+this.stream.pos+"<br/>",i+="Length: "+this.header+"+",i+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?i+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+="<br/>(encapsulates)"),null!==r&&(i+="<br/>Value:<br/><b>"+r+"</b>","object"==typeof oids&&6==this.tag)){var h=oids[r];h&&(h.d&&(i+="<br/>"+h.d),h.c&&(i+="<br/>"+h.c),h.w&&(i+="<br/>(warning!)"))}o.innerHTML=i,t.appendChild(o);var a=n.tag("div","sub");if(null!==this.sub)for(var u=0,c=this.sub.length;c>u;++u)a.appendChild(this.sub[u].toDOM());return t.appendChild(a),e.onclick=function(){t.className="node collapsed"==t.className?"node":"node collapsed"},t},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.fakeHover=function(t){this.node.className+=" hover",t&&(this.head.className+=" hover")},i.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,""),t&&(this.head.className=this.head.className.replace(e,""))},i.prototype.toHexDOM_sub=function(t,e,i,r,s){if(!(r>=s)){var o=n.tag("span",e);o.appendChild(n.text(i.hexDump(r,s))),t.appendChild(o)}},i.prototype.toHexDOM=function(e){var i=n.tag("span","hex");if(e===t&&(e=i),this.head.hexNode=i,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},i.asn1=this,i.onmouseover=function(){var t=!e.selected;t&&(e.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(t)},i.onmouseout=function(){var t=e.selected==this.asn1;this.asn1.fakeOut(t),t&&(e.selected=null,this.className="hex")},this.toHexDOM_sub(i,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(i,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)i.appendChild(n.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var r=this.sub[0],s=this.sub[this.sub.length-1];this.toHexDOM_sub(i,"intro",this.stream,this.posContent(),r.posStart());for(var o=0,h=this.sub.length;h>o;++o)i.appendChild(this.sub[o].toHexDOM(e));this.toHexDOM_sub(i,"outro",this.stream,s.posEnd(),this.posEnd())}return i},i.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(t){var e=t.get(),i=127&e;if(i==e)return i;if(i>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0===i)return-1;e=0;for(var r=0;i>r;++r)e=e<<8|t.get();return e},i.hasContent=function(t,r,s){if(32&t)return!0;if(3>t||t>4)return!1;var n=new e(s);3==t&&n.get();var o=n.get();if(o>>6&1)return!1;try{var h=i.decodeLength(n);return n.pos-s.pos+h==r}catch(a){return!1}},i.decode=function(t){t instanceof e||(t=new e(t,0));var r=new e(t),s=t.get(),n=i.decodeLength(t),o=t.pos-r.pos,h=null;if(i.hasContent(s,n,t)){var a=t.pos;if(3==s&&t.get(),h=[],n>=0){for(var u=a+n;t.pos<u;)h[h.length]=i.decode(t);if(t.pos!=u)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var c=i.decode(t);if(0===c.tag)break;h[h.length]=c}n=a-t.pos}catch(f){throw"Exception while decoding undefined length content: "+f}}else t.pos+=n;return new i(r,o,n,s,h)},i.test=function(){for(var t=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],r=0,s=t.length;s>r;++r){var n=new e(t[r].value,0),o=i.decodeLength(n);o!=t[r].expected&&document.write("In test["+r+"] expected "+t[r].expected+" got "+o+"\n")}},window.ASN1=i}(),ASN1.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,i=2*this.length;return t.substr(e,i)},pi.prototype.parseKey=function(t){try{var e=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,i=e.test(t)?Hex.decode(t):Base64.unarmor(t),r=ASN1.decode(i);if(9===r.sub.length){var s=r.sub[1].getHexStringValue();this.n=ci(s,16);var n=r.sub[2].getHexStringValue();this.e=parseInt(n,16);var o=r.sub[3].getHexStringValue();this.d=ci(o,16);var h=r.sub[4].getHexStringValue();this.p=ci(h,16);var a=r.sub[5].getHexStringValue();this.q=ci(a,16);var u=r.sub[6].getHexStringValue();this.dmp1=ci(u,16);var c=r.sub[7].getHexStringValue();this.dmq1=ci(c,16);var f=r.sub[8].getHexStringValue();this.coeff=ci(f,16)}else{if(2!==r.sub.length)return!1;var p=r.sub[1],l=p.sub[0],s=l.sub[0].getHexStringValue();this.n=ci(s,16);var n=l.sub[1].getHexStringValue();this.e=parseInt(n,16)}return!0}catch(d){return!1}},pi.prototype.getPrivateBaseKey=function(){var t={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},e=new KJUR.asn1.DERSequence(t);return e.getEncodedHex()},pi.prototype.getPrivateBaseKeyB64=function(){return Ri(this.getPrivateBaseKey())},pi.prototype.getPublicBaseKey=function(){var t={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},e=new KJUR.asn1.DERSequence(t);t={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var i=new KJUR.asn1.DERSequence(t);t={hex:"00"+i.getEncodedHex()};var r=new KJUR.asn1.DERBitString(t);t={array:[e,r]};var s=new KJUR.asn1.DERSequence(t);return s.getEncodedHex()},pi.prototype.getPublicBaseKeyB64=function(){return Ri(this.getPublicBaseKey())},pi.prototype.wordwrap=function(t,e){if(e=e||64,!t)return t;var i="(.{1,"+e+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(i,"g")).join("\n")},pi.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},pi.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},pi.prototype.hasPublicKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")},pi.prototype.hasPrivateKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},pi.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)};var Zi=function(t){pi.call(this),t&&("string"==typeof t?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))};Zi.prototype=new pi,Zi.prototype.constructor=Zi;var Gi=function(t){t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};Gi.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new Zi(t)},Gi.prototype.setPrivateKey=function(t){this.setKey(t)},Gi.prototype.setPublicKey=function(t){this.setKey(t)},Gi.prototype.decrypt=function(t){try{return this.getKey().decrypt(Di(t))}catch(e){return!1}},Gi.prototype.encrypt=function(t){try{return Ri(this.getKey().encrypt(t))}catch(e){return console.log(arguments),!1}},Gi.prototype.getKey=function(t){if(!this.key){if(this.key=new Zi,t&&"[object Function]"==={}.toString.call(t))return this.key.generateAsync(this.default_key_size,this.default_public_exponent,t),void 0;this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},Gi.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},Gi.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},Gi.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},Gi.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.JSEncrypt=Gi}(e.RSA),e.RSA=e.RSA.JSEncrypt}}});_.Module.define({path:"tbmall/widget/paykey_dialog",requires:["tbmall/widget/paykey_rsa"],sub:{ERROR:{2270018:"",1990005:"\u652F\u4ED8\u5BC6\u7801\u9A8C\u8BC1\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF0C\u60A8\u8FD8\u6709{#NUM#}\u6B21\u8F93\u5165\u673A\u4F1A",2190005:'\u4F60\u5DF2\u8F93\u5165\u5BC6\u7801\u9519\u8BEF5\u6B21\uFF0C\u652F\u4ED8\u5BC6\u7801\u88AB\u9501\u5B9A\uFF0C\u8BF7<a target="_blank" href="/tbmall/pass/set">\u627E\u56DE\u5BC6\u7801</a>'},MAX_ERR_TIME:5,_setTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">',"<p>\u8BF7\u8BBE\u7F6E\u652F\u4ED8\u5BC6\u7801\u540E\u5B8C\u6210\u6D88\u8D39</br>\uFF08\u53EF\u964D\u4F4ET\u8C46\u88AB\u76D7\u98CE\u9669\uFF0C\u4FDD\u969C\u8D22\u4EA7\u5B89\u5168\uFF09</p>",'<div class="paykey_btn_area clearfix">','<a href="/tbmall/pass/set" target="_blank" class="paykey_set_accept_btn paykey_set_btn" id="paykey_set_accept_btn">\u7ACB\u5373\u8BBE\u7F6E</a>','<a href="#" class="paykey_set_cancel_btn paykey_set_btn" id="paykey_set_cancel_btn">\u4E0B\u6B21\u518D\u8BF4</a>',"</div>","</div>"].join(""),_inputTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">','<form id="paykey_set_form">','<div class="paykey_input_area">',"<span>\u8BF7\u8F93\u5165\u652F\u4ED8\u5BC6\u7801</span>",'<input type="password" class="j_paykey_input paykey_input" id="paykey_input"/>','<p id="paykey_input_msg" class="paykey_input_msg">{#ERROR#}</p>',"</div>",'<div class="paykey_btn_area clearfix">','<a class="j_paykey_submit_btn paykey_submit_btn paykey_set_btn" id="paykey_submit_btn">\u63D0\u4EA4</a>','<a href="/tbmall/pass/set" target="_blank" class="j_paykey_cancel_btn  paykey_set_btn" id="paykey_cancel_btn">\u5FD8\u8BB0\u5BC6\u7801</a>',"</div>","</form>","</div>"].join(""),_dialog:null,conf:{},initial:function(a){this.conf=$.extend(this.conf,a),this.RSA=this.use("tbmall/widget/paykey_rsa")},showDialog:function(a,e,t){var i=e;2==arguments.length&&(t=e,i=null),2===this.conf.showType?this.inputPasskeyDialog(a,i,t):1===this.conf.showType?this.setPasskeyDialog(a,i,t):"function"==typeof a&&(t?a.call(t):a())},inputPasskeyDialog:function(a,e,t){var i=this;2==arguments.length&&(t=e);var s=this._inputTpl;if(this.conf.errType&&(s=s.replace("{#ERROR#}",this.ERROR[this.conf.errType])),this.conf.errTime){var n=this.MAX_ERR_TIME-this.conf.errTime;s=s.replace("{#NUM#}",n)}this._dialog=new $.dialog({html:s,title:"\u652F\u4ED8\u5BC6\u7801",draggable:!1,width:420});var l=function(){var e=$("#paykey_input").val();if(!e)return $("#paykey_input_msg").text("\u8BF7\u8F93\u5165\u652F\u4ED8\u5BC6\u7801"),void 0;var s=i.RSA.vcode(e);"function"==typeof a&&(t?a.call(t,{password:s}):a({password:s})),i._dialog.close()};$("#paykey_submit_btn").click(function(a){a.preventDefault(),l()}),$("#paykey_set_form").submit(function(a){a.preventDefault(),l()}),this._dialog.onclose(function(){"function"==typeof e&&(t?e.call(t):e())})},setPasskeyDialog:function(a,e,t){var i=this;2==arguments.length&&(t=e),this._dialog=new $.dialog({html:this._setTpl,title:"\u63D0\u793A",draggable:!1,width:420}),$("#paykey_set_accept_btn").click(function(){i._dialog.close()}),$("#paykey_set_cancel_btn").click(function(){i._dialog.close()}),this._dialog.element.find(".dialogJclose").on("click",function(){"function"==typeof e&&(t?e.call(t,{ignore_set_paypass:1}):e({ignore_set_paypass:1}))})}}});_.Module.define({path:"tbmall/widget/paykey_mobile",requires:[],sub:{_conf:{token:"",type:"bind"},initial:function(e){this._conf=$.extend(this._conf,e)},show:function(e,i,s,t){"check"===this._conf.type?this.showMobileCheck(e,i,s,t):this.showMobileBind(e,i,s,t)},showMobileCheck:function(e,i,s,t){var o=this,n="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();PageData.user.setpass;var c=t||"\u4E3A\u4E86\u4FDD\u969C\u60A8\u7684\u8D22\u4EA7\u5B89\u5168\uFF0C\u8BF7\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A\u540E\u8FDB\u884C\u652F\u4ED8\u3002";$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_forceverify_wrapper.js?cdnversion="+Math.floor(n/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(n/6e4)],function(){var t=passport.pop.initForceverify({token:o._conf.token,curType:"mobile",title:"\u6D88\u8D39\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A",msg:c,onRender:function(){var e=$(this.getById("mask")),i=$(this.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),i.css("zIndex",5e4+parseInt(i.css("zIndex")))},onHide:function(){s=s||o,"function"==typeof i&&i.call(s,{})},onSendvcodeSuccess:function(){},onSubmitSuccess:function(){s=s||o,"function"==typeof e&&e.call(s,{mobile_check:1})}});t.show()},!0,"utf-8")},showMobileBind:function(e,i,s,t){var o=this;if(o.bindMobileDialog)return o.bindMobileDialog.show(),void 0;var n="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_armorwidget_wrapper.js?cdnversion="+Math.floor(n/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(n/6e4)],function(){var n=t||"\u7ED1\u5B9A\u624B\u673A\u662F\u76EE\u524D\u6700\u7B80\u5355\u6709\u6548\u964D\u4F4E\u8D26\u53F7\u88AB\u76D7\u98CE\u9669\u7684\u65B9\u6CD5~\u8BF7\u7ED1\u5B9A\u540E\u8FDB\u884C\u652F\u4ED8";o._conf.firstFlag&&(n="\u4E3A\u4FDD\u969C\u8D22\u4EA7\u5B89\u5168\uFF0C\u5EFA\u8BAE\u60A8\u7ED1\u5B9A\u624B\u673A\u540E\u8FDB\u884C\u6D88\u8D39\uFF0C\u82E5\u60F3\u6B8B\u5FCD\u7684\u62D2\u7EDD\u8BF7\u5173\u95ED\u6D6E\u5C42\u540E\u7EE7\u7EED\u6D88\u8D39\u3002"),o.bindMobileDialog=passport.pop.ArmorWidget("bindmobile",{token:o._conf.token,title:"\u5B89\u5168\u53CB\u60C5\u63D0\u793A",msg:n,auth_title:"\u6D88\u8D39\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A",auth_msg:"\u60A8\u6B63\u5728\u8FDB\u884C\u652F\u4ED8\u5BC6\u7801\u8BBE\u7F6E\uFF0C\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u5148\u9A8C\u8BC1\u5BC6\u4FDD\u4FE1\u606F\u3002",onRender:function(){var e=$(this.getById("mask")),i=$(this.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),i.css("zIndex",5e4+parseInt(i.css("zIndex")))},onHide:function(){o.bindid||(s=s||o,"function"==typeof i&&i.call(s))},onSendvcodeSuccess:function(){},onSubmitSuccess:function(i){o.bindid=i.bindid,s=s||o;var t={bindid:o.bindid};o.showSetMobileCheck(t,e,s)}}),o.bindMobileDialog.show()},!0,"utf-8"),$.ajax({url:"/tbmall/pass/setAuthPhone",type:"post",data:{type:1,tbs:PageData.tbs}})},_setTpl:['<a class="dialogJclose j_set_mobile_check_dialogJclose" title="\u5173\u95ED\u672C\u7A97\u53E3">&nbsp;</a>','<div class="set_mobile_check_wrap" id="set_mobile_check_wrap">','<div class="set_mobile_check_msg">','<span class="set_mobile_check_icon"></span>','<span class="set_mobile_check_title">\u64CD\u4F5C\u6210\u529F</span>',"</div>","<p>\u4E3A\u4FDD\u969C\u8D26\u53F7T\u8C46\u5B89\u5168\uFF0C\u5EFA\u8BAE\u60A8\u9009\u62E9\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD</p>",'<div class="set_mobile_check_operator">','<a href="#" class="set_mobile_check_select">','<input type="radio" class="j_set_mobile_check_ok set_mobile_check_radio" name="set_mobile_check_radio" checked/>\u5355\u7B14T\u8C46\u6D88\u8D39\u8D85\u8FC7100000\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD',"</a>",'<a href="#" class="set_mobile_check_select">','<input type="radio" class="j_set_mobile_check_cancel set_mobile_check_radio" name="set_mobile_check_radio"/>\u4E0D\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD',"</a>",'<a href="#" class="j_set_mobile_check_submit set_mobile_check_submit ui_btn ui_btn_m"><span><em>\u786E\u5B9A</em></span></a>',"</div>","</div>"].join(""),showSetMobileCheck:function(e,i,s){var t=this,o=new $.dialog({html:this._setTpl,showTitle:!1,height:260,width:420}),n=$(o.element);t.openCheck=1;var c=function(){$.ajax({url:"/tbmall/pass/setAuthPhone",type:"post",dataType:"json",data:{type:t.openCheck,tbs:PageData.tbs},success:function(e){0===e.no?setTimeout(function(){o.close()},1e3):$.dialog.alert("\u6D88\u8D39\u624B\u673A\u9A8C\u8BC1\u529F\u80FD\u8BBE\u7F6E\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")},error:function(){$.dialog.alert("\u6D88\u8D39\u624B\u673A\u9A8C\u8BC1\u529F\u80FD\u8BBE\u7F6E\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}})};n.find(".j_set_mobile_check_submit").click(function(){c()}),n.find(".j_set_mobile_check_ok").click(function(){t.openCheck=1}),n.find(".j_set_mobile_check_cancel").click(function(){t.openCheck=0}),n.find(".j_set_mobile_check_dialogJclose").click(function(){t.openCheck=1,c()}),o.onclose(function(){"function"==typeof i&&i.call(s,e)})}}});